<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ูุธุงู ุงูุชูููู ุงููุฏุฑุณู</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    :root {
      --bg: #f6f8fb;
      --card: #ffffff;
      --soft: #f0f4f8;
      --text: #233042;
      --muted: #6b7a90;
      --brand: #7cc4ad;
      --brand-2: #9cc6e0;
      --accent: #b7c3d0;
      --danger: #f28b82;
      --ring: rgba(124, 196, 173, 0.35);
    }

    body {
      box-sizing: border-box;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
    }

    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');

    body {
      font-family: "Tajawal", "Segoe UI", Tahoma, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100%;
      padding: 16px;
      direction: rtl;
      width: 100%;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .app-header {
      text-align: center;
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      border-radius: 16px;
      box-shadow: 0 2px 18px rgba(0, 0, 0, 0.06);
    }

    .app-header h1 {
      font-size: 1.5rem;
      color: #0d2a1f;
      margin-bottom: 0.5rem;
    }

    .app-header .muted {
      margin: 0;
      color: #204a3e;
      font-size: 0.9rem;
    }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    .card {
      background: var(--card);
      padding: 16px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(35, 48, 66, 0.05);
      margin-bottom: 16px;
      width: 100%;
      border: 1px solid #e8edf3;
    }

    .card-soft {
      background: var(--soft);
      border: 1px dashed #d9e2ec;
      border-radius: 14px;
      padding: 12px;
    }

    .section-title {
      font-size: 18px;
      color: var(--text);
      margin: 0 0 10px;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--brand);
    }

    .menu {
      list-style: none;
      display: grid;
      gap: 8px;
      margin: 0;
      padding: 0;
    }

    .menu-btn {
      width: 100%;
      padding: 12px 14px;
      font-size: 1rem;
      background: #fff;
      color: var(--text);
      border: 1px solid #dde5ee;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      text-align: right;
    }

    .menu-btn:hover {
      border-color: var(--brand);
      transform: translateY(-1px);
    }

    .menu-btn:active {
      transform: translateY(0);
    }

    .login-card {
      background: var(--soft);
      padding: 12px;
      border-radius: 12px;
      margin-top: 12px;
      border: 1px dashed #d9e2ec;
    }

    .login-card h3 {
      color: var(--brand);
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    .hidden {
      display: none !important;
    }

    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
    }

    .wrap {
      flex-wrap: wrap;
    }

    .end {
      justify-content: flex-end;
    }

    .row label {
      font-size: 14px;
      color: var(--muted);
      min-width: 120px;
    }

    input, select {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid #dfe7f1;
      border-radius: 10px;
      font-size: 1rem;
      background: #fff;
      color: var(--text);
      outline: none;
      min-width: 200px;
    }

    input:focus, select:focus {
      box-shadow: 0 0 0 3px var(--ring);
      border-color: var(--brand);
    }

    button {
      padding: 10px 12px;
      font-size: 1rem;
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      color: #0f2b21;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      letter-spacing: 0.2px;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(124, 196, 173, 0.3);
    }

    button:disabled {
      background: #cbd5e0;
      cursor: not-allowed;
      transform: none;
      opacity: 0.6;
    }

    button.ghost {
      background: #fff;
      color: var(--text);
      border: 1px dashed #d9e2ec;
    }

    button.ghost:hover {
      background: var(--soft);
      border-color: var(--brand);
    }

    button.danger {
      background: linear-gradient(90deg, var(--danger), #f7b0aa);
      color: #4b0e0c;
    }

    .hint {
      margin-top: 0.75rem;
      font-size: 12px;
      color: #2a6b56;
      font-style: italic;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      padding: 24px;
      max-width: 600px;
      width: 100%;
      max-height: 80%;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--brand);
    }

    .modal-header h3 {
      color: var(--brand);
      font-size: 1.3rem;
      margin: 0;
    }

    .modal-close {
      background: #f0f4f8;
      color: var(--text);
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .modal-close:hover {
      background: var(--danger);
      color: white;
    }

    .modal-body {
      margin-bottom: 20px;
    }

    .modal-footer {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    @media (max-width: 768px) {
      body {
        padding: 8px;
      }
      
      .app-header h1 {
        font-size: 1.25rem;
      }
      
      .card {
        padding: 12px;
      }
      
      .row {
        flex-direction: column;
        align-items: stretch;
      }
      
      .row label {
        min-width: auto;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <main class="container">
   <section id="loginMenu" class="card">
    <div class="app-header">
     <h1>ููุญุฉ ูุชุงุจุนุฉ ุงูุชูููู ุงูุฐุงุชูุฉ</h1>
     <p class="muted">ูุชุงุจุนุฉ ูุฃุฏุงุก ุงูุทุงูุจุฉ ูู ูุงุฏุฉ ุชูููุฉ ุฑูููุฉ ูุนุงู 1447 ูู</p>
    </div>
    <h2 class="section-title">ุงุฎุชุงุฑู ุงููุงุฌูุฉ</h2>
    <ul class="menu">
     <li><button class="menu-btn" id="showTeacher">๐ซ ุฏุฎูู ุงููุนููุฉ</button></li>
     <li><button class="menu-btn" id="showStudent">๐ง ููุญุฉ ุงูุทุงูุจุฉ</button></li>
     <li><button class="menu-btn" id="showParent">๐จโ๐ฉโ๐ง ููุญุฉ ูููู ุงูุฃูุฑ</button></li>
    </ul>
    <div id="teacherLogin" class="login-card hidden">
     <h3>ุฏุฎูู ุงููุนููุฉ</h3>
     <div class="row"><label for="teacherCode">ุงูุฑูู ุงูุณุฑู</label> <input id="teacherCode" type="password" inputmode="numeric" placeholder="****">
     </div>
     <div class="row"><button id="teacherEnter">ุฏุฎูู</button> <button class="ghost" id="closeTeacher">ุฅุบูุงู</button>
     </div>
     <p class="hint">ุชูููุญ: ุงูุฑูู ุงูุงูุชุฑุงุถู ูู 1234</p>
    </div>
    <div id="studentLogin" class="login-card hidden">
     <h3>ุฏุฎูู ุงูุทุงูุจุฉ</h3>
     <div class="row"><label for="studentNameInput">ุงูุงุณู</label> <input id="studentNameInput" type="text" placeholder="ูุซุงู: ุณุงุฑุฉ ูุญูุฏ">
     </div>
     <div class="row"><button id="studentEnter">ุนุฑุถ ุชูุฑูุฑู</button> <button class="ghost" id="closeStudent">ุฅุบูุงู</button>
     </div>
    </div>
    <div id="parentLogin" class="login-card hidden">
     <h3>ุฏุฎูู ูููู ุงูุฃูุฑ</h3>
     <div class="row"><label for="parentNameInput">ุงุณู ุงูุทุงู๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝุฉ</label> <input id="parentNameInput" type="text" placeholder="ูุซุงู: ุณุงุฑุฉ ูุญูุฏ">
     </div>
     <div class="row"><button id="parentEnter">ุนุฑุถ ุชูุฑูุฑ ูููู ุงูุฃูุฑ</button> <button class="ghost" id="closeParent">ุฅุบูุงู</button>
     </div>
    </div>
    <div class="card-soft" style="margin-top: 1.5rem; background: linear-gradient(135deg, #fef5e7, #fef9e7); border: 2px solid #f9e79f; border-radius: 16px; box-shadow: 0 4px 15px rgba(249, 231, 159, 0.2);">
     <h3 style="color: #d68910; font-size: 1.1rem; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.5rem;">๐</span> <span>ุงูุฃุณุฑ ุงูุฃูุซุฑ ุชูุงุนูุงู</span></h3>
     <div id="topFamiliesContainer" style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; align-items: center; min-height: 80px;">
      <p style="color: #7a8fa8; font-style: italic; font-size: 0.9rem;">ูุง ุชูุฌุฏ ุชูุงุนูุงุช ุจุนุฏ</p>
     </div>
    </div>
    <div class="card-soft" style="margin-top: 1.5rem; background: linear-gradient(135deg, #e8f5e9, #f1f8e9); border: 2px solid #81c784; border-radius: 16px; box-shadow: 0 4px 15px rgba(129, 199, 132, 0.2);">
     <h3 style="color: #2e7d32; font-size: 1.1rem; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.5rem;">โญ</span> <span>ุงูุทุงูุจุงุช ุงูุฃูุซุฑ ุชููุฒุงู</span></h3>
     <div id="topStudentsContainer" style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; align-items: stretch; min-height: 120px;">
      <p style="color: #7a8fa8; font-style: italic; font-size: 0.9rem;">ูุง ุชูุฌุฏ ุจูุงูุงุช ุจุนุฏ</p>
     </div>
    </div>
   </section>
   <section id="teacherPanel" class="card hidden">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px;">
     <h2 class="section-title">ูุงุฌูุฉ ุงููุนููุฉ</h2><button id="backToMenu1">๐ ุนูุฏุฉ ูููุงุฆูุฉ</button>
    </div>
    <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 1rem;"><button id="addStudentBtn">โ ุฅุถุงูุฉ ุทุงูุจุฉ</button> <button class="ghost" id="demoBtn">๐ ุจูุงูุงุช ุชุฌุฑูุจูุฉ</button> <button class="ghost" id="importCSV">๐ ุงุณุชูุฑุงุฏ CSV</button> <button class="ghost" id="importExcel">๐ฅ ุงุณุชูุฑุงุฏ ุงูุณู</button> <button class="ghost" id="importPlansExcel">๏ฟฝ๏ฟฝ๏ฟฝ ุงุณุชูุฑุงุฏ ุฎุทุท ุงูุณู</button> <button class="ghost" id="exportExcel">๐พ ุชุตุฏูุฑ Excel</button> <button class="ghost" id="clearBtn">๐๏ธ ูุณุญ ุงููู</button> <button id="saveDataBtn">๐พ ุญูุธ ๏ฟฝ๏ฟฝูุจูุงูุงุช</button>
    </div><input type="file" id="csvFileInput" accept=".csv" style="display: none;"> <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;"> <input type="file" id="plansExcelFileInput" accept=".xlsx,.xls" style="display: none;">
<div id="communicationOptionsContainer" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 20px; justify-content: center;">
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ุชููุฆุฉ', this)">ุชููุฆุฉ ๐</button>
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ุชูุจูู ุณูููู', this)">ุชูุจูู ุณูููู ๐</button>
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ุชูุจูู ุฃูุงุฏููู', this)">ุชูุจูู ุฃูุงุฏููู ๐</button>
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ุดูุฑ ูุชูุฏูุฑ', this)">ุดูุฑ ูุชูุฏูุฑ ๐</button>
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ูุชุงุจุนุฉ', this)">ูุชุงุจุนุฉ ๐</button>
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ุงุณุชูุณุงุฑ', this)">ุงุณุชูุณุงุฑ โ</button>
    <button type="button" class="comm-option-btn" onclick="generateAndSendDirect('ุฏุนูุฉ ุงุฌุชูุงุน', this)">ุฏุนูุฉ ุงุฌุชูุงุน ๐</button>
</div>

<style>
    .comm-option-btn {
        background: linear-gradient(90deg, #99ddc1, #7cc4ad); /* ููู ูุชุฏุฑุฌ */
        color: #333;
        border: none;
        padding: 10px 18px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 700;
        transition: all 0.2s ease;
        flex-grow: 1; 
        min-width: 120px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .comm-option-btn:hover {
        opacity: 0.9;
    }
</style>
    <div class="card-soft" style="margin-bottom: 1rem;">
     <h4 style="margin-bottom: 1rem; color: var(--brand); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุฅุญุตุงุฆูุงุช ูุฎุทุท</span></h4>
     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 1rem;">
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">ุฅุฌูุงูู ุงูุทุงูุจุงุช</p><strong id="countStudents" style="font-size: 1.25rem; color: var(--brand);">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">ูุนุฏู ุงููุตู</p><strong id="classAvg" style="font-size: 1.25rem; color: var(--brand);">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">ู๏ฟฝ๏ฟฝุจุฉ ุงูุญุถูุฑ</p><strong id="attendanceRate" style="font-size: 1.25rem; color: #2e7d32;">0%</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">ุฎุทุท ูุชุฃุฎุฑุฉ ๐ด</p><strong id="overduePlans" style="font-size: 1.25rem; color: #d32f2f;">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">ูุณุชุญูุฉ ูุฑูุจูุง (&lt;3ุฃูุงู) ๐ก</p><strong id="dueSoonPlans" style="font-size: 1.25rem; color: #f57c00;">0</strong>
      </div>
      <div style="padding: 10px 12px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
       <p style="font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem;">ูุณุชุญูุฉ ุงูููู ๐ต</p><strong id="dueTodayPlans" style="font-size: 1.25rem; color: #1976d2;">0</strong>
      </div>
     </div>
     <div style="text-align: center;"><button class="ghost" id="clearFilter" style="font-size: 0.9rem; padding: 8px 14px;">โบ ุฅูุบุงุก ุงูููุชุฑ</button>
     </div>
    </div>
    <div style="overflow: auto; border-radius: 12px; border: 1px solid #e8edf3;">
     <table id="gradesTable" style="width: 100%; border-collapse: separate; border-spacing: 0; font-size: 13px;">
      <thead>
       <tr style="background: #f5f9fc;">
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 120px;">ุงูุงุณู</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงููุตู</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงูุงุฎุชุจุงุฑุงุช<br><small>(20)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงูุนููู<br><small>(30)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงููุงุฌุจุงุช<br><small>(30)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงูููุงูุดุงุช<br><small>(20)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 150px;">ุงูุชุนุงูู<br><small>(ูุฌููุนุฉ)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 180px;">ููุงุท<br>
         ุงูุชููุฒ</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 180px;">ููุงุท<br>
         ุงูููุฉ</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 180px;">ููุงุท<br>
         ุงูุถุนู</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงููุฌููุน<br><small>(100)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 200px;">ุฎุทุฉ ุฑูุน<br>
         ุงููุณุชูู</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 150px;">ุญุงูุฉ<br>
         ุงูุทุงูุจุฉ</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand); min-width: 150px;">ุชู๏ฟฝ๏ฟฝุตู<br>
         ููู ุงูุฃูุฑ</th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุงูุญุถูุฑ<br><small>(ุฃูุงู)</small></th>
        <th style="padding: 10px 6px; text-align: center; border-bottom: 2px solid var(--brand);">ุญุฐู</th>
       </tr>
      </thead>
      <tbody id="gradesTableBody">
       <tr>
        <td colspan="16" style="text-align: center; padding: 3rem 1rem; color: var(--muted);">
         <div style="font-size: 3rem;">
          ๐
         </div><p>ูุง ุชูุฌุฏ ุทุงูุจุงุช ุจุนุฏ</p></td>
       </tr>
      </tbody>
     </table>
    </div>
    <div style="margin-top: 16px; text-align: center; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;"><button id="saveAfterTableBtn">๐พ ุญูุธ ุงูุชุนุฏููุงุช</button> <button class="ghost" id="printSummary">๐จ๏ธ ุทุจุงุนุฉ ูุฎุชุตุฑุฉ</button>
    </div>
   </section>
   <section id="studentPanel" class="card hidden">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px;">
     <h2 class="section-title">ููุญุฉ ุงูุทุงูุจุฉ</h2><button id="backToMenu2" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">๐ ุนูุฏุฉ ูููุงุฆูุฉ</button>
    </div>
    <div id="studentReport">
     <div style="text-align: center; margin-bottom: 2rem;">
      <h3 style="font-size: 1.5rem; color: var(--brand);">ูุฑุญุจูุง <span id="sName">ุงูุทุงูุจุฉ</span></h3>
      <p style="color: var(--muted);">ุงููุตู: <span id="sClass">โ</span></p>
     </div>
     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
      <div style="background: linear-gradient(90deg, var(--brand), var(--brand-2)); color: #0d2a1f; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(124, 196, 173, 0.2);">
       <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; opacity: 0.9;">ุงููุฌููุน ุงูููู</h4>
       <div style="font-size: 2rem; font-weight: bold;">
        <span id="sTotal">0</span>/100
       </div>
      </div>
      <div style="background: linear-gradient(90deg, var(--brand), var(--brand-2)); color: #0d2a1f; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(124, 196, 173, 0.2);">
       <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; opacity: 0.9;">ูุณุจุฉ ุงูุฅูุฌุงุฒ</h4>
       <div style="height: 20px; border-radius: 999px; background: #e8edf3; overflow: hidden; margin-top: 1rem;"><span id="sProgress" style="display: block; height: 100%; background: linear-gradient(90deg, #48bb78, #38a169); transition: width 0.3s ease; width: 0%;"></span>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem;">
      <h4 style="margin-bottom: 1rem; color: var(--brand);">ุฃุฏุงุฆู ุงูุชูุตููู</h4>
      <div id="sDetails">
       <p style="color: var(--muted); text-align: center;">ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุงุญุฉ</p>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #f3e5f5, #fce4ec); border: 2px solid #ce93d8;">
      <h4 style="color: #8e24aa; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุชูููู ุงููุนููุฉ</span></h4>
      <div id="sEvaluation" style="display: grid; gap: 1rem;">
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #66bb6a;">
        <p style="font-weight: 700; color: #2e7d32; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">โจ</span> <span>ููุงุท ุงูุชููุฒ</span></p>
        <p id="sExcellence" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">โ</p>
       </div>
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #42a5f5;">
        <p style="font-weight: 700; color: #1565c0; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">๐ช</span> <span>ููุงุท ุงูููุฉ</span></p>
        <p id="sStrengths" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">โ</p>
       </div>
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #ff7043;">
        <p style="font-weight: 700; color: #d84315; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">๐</span> <span>๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝูุงุท ุงูุถุนู</span></p>
        <p id="sWeaknesses" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">โ</p>
       </div>
       <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid #9c27b0;">
        <p style="font-weight: 700; color: #6a1b9a; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.2rem;">๐ฏ</span> <span>ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ</span></p>
        <p id="sImprovementPlan" style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">โ</p>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e3f2fd, #e8eaf6); border: 2px solid #64b5f6;">
      <h4 style="color: #1565c0; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุงูุฑุณู ุงูุจูุงูู ูุฃุฏุงุฆู</span></h4>
      <div style="position: relative; background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
       <canvas id="studentChart" style="max-height: 300px;"></canvas>
       <div id="needsSupportWarning" style="display: none; margin-top: 1rem; padding: 12px; background: #fff3e0; border: 2px solid #ff9800; border-radius: 8px; text-align: center;">
        <p style="color: #e65100; font-weight: 700; font-size: 0.95rem; margin: 0;">โ๏ธ ููุฌุฏ ูุฌุงู ูุญุชุงุฌ ุฅูู ุฏุนู</p>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: #fef5e7;">
      <h4 style="color: #d68910; margin-bottom: 0.5rem;">๐ก ูุตูุญุฉ ููุชุทููุฑ</h4>
      <p id="sTip" style="font-size: 0.95rem; color: var(--text);">ุงุณุชูุฑู ูู ุจุฐู ุงูุฌูุฏ ูุณุชุญูููู ูุชุงุฆุฌ ุฑุงุฆุนุฉ! ๐</p>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #dcf8e8, #e8f5e9); border: 2px solid #25D366;">
      <h4 style="color: #128C7E; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุจุตูุชู ุทุงูุจุฉ ุดุงุฑูู ูุนููุชู</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2e7d32; font-size: 0.95rem;">โจ ุตูุฉ ุฃุชุญูู ุจูุง</label>
       <p style="font-size: 0.85rem; color: #5a8165; margin-bottom: 0.5rem; font-style: italic;">ูุซุงู: ุฎุฌููุฉุ ุฌุฑูุฆุฉุ ูุชุณุฑุนุฉุ ุงููุนุงููุฉ...</p><select id="studentTrait" style="width: 100%; padding: 10px; border: 1px solid #81c784; border-radius: 10px; background: white; color: #2e7d32;"> <option value="">ุงุฎุชุฑ ุตูุฉ...</option> <option value="ุฎุฌููุฉ">ุฎุฌููุฉ</option> <option value="ุฌุฑูุฆุฉ">ุฌุฑูุฆุฉ</option> <option value="ูุชุณุฑุนุฉ">ูุชุณุฑุนุฉ</option> <option value="ุงููุนุงููุฉ">ุงููุนุงููุฉ</option> <option value="ูุงุฏุฆุฉ">ูุงุฏุฆุฉ</option> <option value="ุงุฌุชูุงุนูุฉ">ุงุฌุชูุงุนูุฉ</option> <option value="ููุธูุฉ">ููุธูุฉ</option> <option value="ูุจุฏุนุฉ">ูุจุฏุนุฉ</option> </select>
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2e7d32; font-size: 0.95rem;">๐ฏ ููุงุฑุฉ ุฃุชููุฒ ุจูุง</label>
       <p style="font-size: 0.85rem; color: #5a8165; margin-bottom: 0.5rem; font-style: italic;">ูุซุงู: ๏ฟฝ๏ฟฝูุฑุณูุ ุงูุชุตูููุ ุญู ุงููุดููุงุช...</p><input type="text" id="studentSkill" placeholder="ุฃุฏุฎู ุงูููุงุฑุฉ ๏ฟฝ๏ฟฝูุง..." style="width: 100%; padding: 10px; border: 1px solid #81c784; border-radius: 10px; background: white; color: #2e7d32;">
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid #ffb74d;">
      <h4 style="color: #f57c00; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนูู ุงูููุถูุฉ</span></h4>
      <div style="background: white; padding: 1rem; border-radius: 10px; margin-bottom: 1.25rem; border-right: 4px solid #ff9800;">
       <p style="font-size: 0.9rem; line-height: 1.7; color: #424242;">ูู ูุงุฏุฉ ุงูุชูููุฉ ุงูุฑูููุฉ ๏ฟฝ๏ฟฝุญุฑุต ุนูู ุชููู๏ฟฝ๏ฟฝ ููุงุฑุงุชู ุงูุชูููุฑ ุงููุงูุฏ ูุงูุฅุจุฏุงุนู ูุญู ุงููุดููุงุช ูู ุฎูุงู ุชู๏ฟฝ๏ฟฝูููุง ูู ุฃูุด๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ ุชุนููููุฉ ุชุนุงูููุฉุ ูุฑุฏูุฉุ ุฑูููุฉ.</p>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">๐ ูู ููุงู ุทุฑููุฉ ูุนููุฉ (ุงุณุชุฑุงุชูุฌูุฉ ุชุนููููุฉ ูุญุฏุฏุฉ) ุชููููู ูู ุฎูุงููุง ุงูุฏุฑุณุ ุฅู ูุฌุฏุช ุดุงุฑูููุง</label>
       <p style="font-size: 0.85rem; color: #8a6d3b; margin-bottom: 0.5rem; font-style: italic;">ูุซุงู: ุงูุชุนูู ุจุงููุดุงุฑูุนุ ุงูุชุนูู ุงูุชุนุงูููุ ุงูุชุนูู ุงูุฐุงุชู...</p><input type="text" id="learningStrategy" placeholder="ุฃุฏุฎู ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูููุถูุฉ..." style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;">
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">๏ฟฝ๏ฟฝ๏ฟฝ ุชู ุงุณุชุนุฑุงุถ ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ ูุงูุฅุซุฑุงุฆูุฉ ุงูุชู ููุฐุชูุง ุงููุนููุฉ ูู ูุธูุฑุช ุงููุชุงุฆุฌุ ูู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชุฑุบุจูู ูู ุฅุถุงูุชูุง ุฅุฐุง ูุงูุช ูู ุฌูุงูุจ ุถุนู ูุงูุด๏ฟฝ๏ฟฝูุง ูุนููุชู ูุนู ูุณุจูุงูุ</label> <select id="hasAdditionalMethod" style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;"> <option value="">ุงุฎุช๏ฟฝ๏ฟฝุฑู ุฅุฌุงุจุฉ...</option> <option value="ูุง">ูุงุ ูุง ููุฌุฏ (ุฃูุชูู ุจุทุฑููุฉ ุงููุนููุฉ)</option> <option value="ูุนู">ูุนู ููุฌุฏ</option> </select>
      </div>
      <div id="additionalMethodContainer" style="margin-bottom: 1rem; display: none;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">โ๏ธ ุงูุชุจู ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง</label> <textarea id="additionalMethod" placeholder="ุดุงุฑูููุง ุฃููุงุฑู..." style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100; resize: vertical;"></textarea>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e1f5fe, #e8eaf6); border: 2px solid #64b5f6;">
      <h4 style="color: #1976d2; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุงุณุชุจูุงู ุณุฑูุน</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">โ ุฃูุง ุฃููู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑ ููู/ูุฉ ุฃูุฑู ุจุชุญุตููู ุงูุฏุฑุงุณู ูู ูุงุฏุฉ ุงูุชูููุฉ ุงูุฑูููุฉ</label> <select id="informParent" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">ุงุฎ๏ฟฝ๏ฟฝุงุฑู ุฅุฌุงุจุฉ...</option> <option value="ุฏุงุฆูุงู">ุฏุงุฆูุงู โ</option> <option value="ุบุงูุจุงู">ุบุงูุจุงู ๐</option> <option value="ุฃุญูุงูุงู">ุฃุญูุงูุงู ๐ค</option> <option value="ูุงุฏุฑุงู">ูุงุฏุฑุงู ๐</option> <option value="ุฃุจุฏุงู">ุฃุจุฏุงู โ</option> </select>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">โญ ูุง ูุฏู ุฑุถุงู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐูุ</label> <select id="satisfactionLevel" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">ุงุฎุชุงุฑู ุฅุฌุงุจุฉ...</option> <option value="ุฑุงุถูุฉ ุฌุฏุงู">ุฑุงุถูุฉ ุฌุฏุงู โญโญโญโญโญ</option> <option value="ุฑุงุถูุฉ">ุฑุงุถูุฉ โญโญโญโญ</option> <option value="ูุญุงูุฏุฉ">ูุญุงูุฏุฉ โญโญโญ</option> <option value="ุบูุฑ ุฑุงุถูุฉ">ุบูุฑ ุฑุงุถูุฉ โญโญ</option> <option value="ุบูุฑ ุฑุงุถูุฉ ุชูุงูุงู">ุบูุฑ ุฑุงุถูุฉ ุชูุงูุงู โญ</option> </select>
      </div></div>
   <button id="submitStudentFeedback" style="width:100%;padding:14px;background:linear-gradient(90deg, #8E24AA, #7B1FA2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-size:16px;font-weight:700;box-shadow:0 4px 15px rgba(142,36,170,0.4);transition:all 0.3s ease; margin-bottom: 25px;"> ๐ ุฅุฑุณุงู ุงุณุชุจูุงู ุงูุทุงูุจุฉ (ูุงุชุณุงุจ)</button>
    <div style="margin-top: 2rem; text-align: center; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;"><button onclick="contactTeacherWhatsAppStudent()"  style="background: linear-gradient(90deg, #25D366, #128C7E); color: white; padding: 12px 20px; border-radius: 10px; font-weight: 700; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem; justify-content: center; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);"> <span style="font-size: 1.3rem;">๐ฒ</span> <span>ุชูุงุตู ูุน ุงููุนููุฉ ุนุจุฑ ูุงุชุณุงุจ</span> </button> 
    
   </section>
   <section id="parentPanel" class="card hidden">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px;">
     <h2 class="section-title" style="background: linear-gradient(90deg, #7cc4ad, #9cc6e0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.5rem; padding: 0.5rem 0;">๐จโ๐ฉโ๐ง ููุญุฉ ูููู ุงูุฃูุฑ</h2><button id="backToMenu3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">๐ ุนูุฏุฉ ูููุงุฆูุฉ</button>
    </div>
    <div id="parentReport">
     <div style="text-align: center; margin-bottom: 2rem; background: linear-gradient(135deg, #667eea15, #764ba215); padding: 1.5rem; border-radius: 16px; border: 2px solid #e0e7ff;">
      <h3 style="font-size: 1.75rem; background: linear-gradient(90deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 700; margin-bottom: 1rem;">๐ ุชูุฑูุฑ ููู ุงูุฃูุฑ</h3>
      <div style="display: inline-flex; gap: 1.5rem; background: white; padding: 1rem 2rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);">
       <div style="text-align: center;">
        <p style="color: #667eea; font-size: 0.85rem; margin-bottom: 0.25rem; font-weight: 600;">ุงูุทุงูุจุฉ</p>
        <p style="color: #2d3748; font-size: 1.1rem; font-weight: 700;"><span id="pName">โ</span></p>
       </div>
       <div style="width: 2px; background: linear-gradient(180deg, #667eea, #764ba2); opacity: 0.3;"></div>
       <div style="text-align: center;">
        <p style="color: #764ba2; font-size: 0.85rem; margin-bottom: 0.25rem; font-weight: 600;">ุงููุตู</p>
        <p style="color: #2d3748; font-size: 1.1rem; font-weight: 700;"><span id="pClass">โ</span></p>
       </div>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #fef5e7, #fef9e7); border: 2px solid #ffd89b; border-radius: 14px;">
      <h4 style="margin-bottom: 1rem; color: #e67e22; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.5rem;">๐</span> ููุฎุต ุงูุฃุฏุงุก</h4>
      <div id="pSummary">
       <p style="color: var(--muted); text-align: center;">ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุงุญุฉ</p>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e3f2fd, #e8eaf6); border: 2px solid #90caf9; border-radius: 16px; box-shadow: 0 4px 15px rgba(33, 150, 243, 0.1);">
      <h4 style="margin-bottom: 1rem; color: #1976d2; font-size: 1.25rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem; background: white; padding: 0.75rem 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(25, 118, 210, 0.15);"><span style="font-size: 1.5rem;">๐</span> <span>ุจุตูุชู ููู/ูุฉ ุฃูุฑ ุงูุทุงูุจุฉ ุดุงุฑู/ูู ูุนููุชูุง</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #3d5a7a; font-size: 0.95rem;">ุตูุฉ ุชุชุญูู ุจูุง ุงูุทุงูุจุฉ</label>
       <p style="font-size: 0.85rem; color: #7a8fa8; margin-bottom: 0.5rem; font-style: italic;">ูุซุงู: ุฎุฌููุฉุ ุฌุฑูุฆุฉุ ูุชุณุฑุนุฉุ ุงููุนุงููุฉ...</p> <select id="parentTrait" style ="width: 100%; padding: 10px; border: 1px solid #d4dfe9; border-radius: 10px; background: white; color: #3d5a7a;"> <option value="">ุงุฎุชุฑ ุตูุฉ...</option> <option value="ุฎุฌููุฉ">ุฎุฌููุฉ</option> <option value="ุฌุฑูุฆุฉ">ุฌุฑูุฆุฉ</option> <option value="ูุชุณุฑุนุฉ">ูุชุณุฑุนุฉ</option> <option value="ุงููุนุงููุฉ">ุงููุนุงููุฉ</option> <option value="ูุงุฏุฆุฉ">ูุงุฏุฆุฉ</option> <option value="ุงุฌุชูุงุนูุฉ">ุงุฌุชูุงุนูุฉ</option> <option value="ููุธูุฉ">ููุธูุฉ</option> <option value="ูุจุฏุนุฉ">ูุจุฏุนุฉ</option> </select>
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #3d5a7a; font-size: 0.95rem;">ููุงุฑุฉ ุชููุฑุฏ ูุชุชููุฒ ุจูุง</label>
       <p style="font-size: 0.85rem; color: #7a8fa8; margin-bottom: 0.5rem; font-style: italic;">ูุซุงู: ุงูุฑุณูุ ุงูุชุตูููุ ุญู ุงููุดููุงุช...</p><input type="text"  id="parentSkill" placeholder="ุฃุฏุฎู ุงูููุงุฑุฉ ููุง..." style="width: 100%; padding: 10px; border: 1px solid #d4dfe9; border-radius: 10px; background: white; color: #3d5a7a;">
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid #ffb74d;">
      <h4 style="color: #f57c00; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐ก</span> <span>ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนูู ุงูููุถูุฉ</span></h4>
      <div style="background: white; padding: 1rem; border-radius: 10px; margin-bottom: 1.25rem; border-right: 4px solid #ff9800;">
       <p style="font-size: 0.9rem; line-height: 1.7; color: #424242;">ูู ูุงุฏุฉ ุงูุชูููุฉ ุงูุฑูููุฉ ูุญุฑุต ุนูู ุชูููุฉ ููุงุฑุงุช ุงูุชูููุฑ ุงููุงูุฏ ูุงูุฅุจุฏุงุนู ูุญู ุงููุดููุงุช ูู ุฎูุงู ุชูุธูููุง ูู ุฃ๏ฟฝ๏ฟฝุดุทุฉ ุชุนููููุฉ ุชุนุงูููุฉุ ูุฑุฏูุฉุ ุฑูููุฉ.</p>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">๐ ูู ููุงู ุทุฑููุฉ ูุนููุฉ (ุงุณุชุฑุงุชูุฌูุฉ ุชุนููููุฉ ูุญุฏุฏุฉ) ูููู ูู ุฎูุงููุง ุงุจูุชูู ุงูุฏุฑุณุ ุฅู ูุฌุฏุช ุดุงุฑูููุง</label>
       <p style="font-size: 0.85rem; color: #8a6d3b; margin-bottom: 0.5rem; font-style: italic;">ูุซุงู: ุงูุชุนูู ุจุงููุดุงุฑูุนุ ุงูุชุนูู ุงูุชุนุงูููุ ุงูุชุนูู ุงูุฐุงุชู...</p><input type="text" id="parentLearningStrategy" placeholder="ุฃุฏุฎู ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูููุถูุฉ..." style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;">
      </div>
      <div style="margin-bottom: 1rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">๐ ุชู ุงุณุชุนุฑุงุถ ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ ูุงูุฅุซุฑุงุฆูุฉ ุงูุชู ููุฐุชูุง ุงููุน๏ฟฝ๏ฟฝูุฉ ูุงุจูุชูู ูุธูุฑุช ุงููุชุงุฆุฌุ ูู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชุฑุบุจูู ูู ุฅุถุงูุชูุง ุฅุฐุง ูุงูุช ูุงุจูุชูู ุฌูุงูุจ ุถุนู ูุงูุดุชูุง ูุนููุชูุง ูุนูู ูุณุจูุงูุ</label> <select id="parentHasAdditionalMethod" style="width: 100%; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100;"> <option value="">ุงุฎุชุงุฑูุง ุฅุฌุงุจุฉ...</option> <option value="ูุง">ูุงุ ูุง ููุฌุฏ (๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝูุชูู ุจุทุฑููุฉ ุงููุนููุฉ)</option> <option value="ูุนู">ูุนู ููุฌุฏ</option> </select>
      </div>
      <div id="parentAdditionalMethodContainer" style="margin-bottom: 1rem; display: none;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #e65100; font-size: 0.95rem;">โ๏ธ ุงูุชุจูุง ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง</label> <textarea id="parentAdditionalMethod" placeholder="ุดุงุฑูููุง ุฃููุงุฑูู..." style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ffb74d; border-radius: 10px; background: white; color: #e65100; resize: vertical;"></textarea>
      </div>
     </div>
     <div class="card-soft" style="margin-top: 1rem; background: linear-gradient(135deg, #e1f5fe, #e8eaf6); border: 2px solid #64b5f6;">
      <h4 style="color: #1976d2; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span style="font-size: 1.3rem;">๐</span> <span>ุงุณุชุจูุงู ุณุฑูุน</span></h4>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">โ ูู ุชููู ุงุจูุชูู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑูู ุจุชุญุตูููุง ุงูุฏุฑุงุณู ูู ูุงุฏุฉ ุงูุชูููุฉ ุงูุฑูููุฉุ</label> <select id="parentInformParent" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">ุงุฎุชุงุฑูุง ุฅุฌุงุจุฉ...</option> <option value="ุฏุงุฆูุงู">ุฏุงุฆูุงู โ</option> <option value="ุบุงูุจุงู">ุบุงูุจุงู ๐</option> <option value="ุฃุญูุงูุงู">ุฃุญูุงูุงู ๐ค</option> <option value="ูุงุฏุฑุงู">ูุงุฏุฑุงู ๐</option> <option value="ุฃุจุฏุงู">ุฃุจุฏุงู โ</option> </select>
      </div>
      <div style="margin-bottom: 1.25rem;"><label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #0d47a1; font-size: 0.95rem;">โญ ูุง ูุฏู ุฑุถุงูู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐูุ</label> <select id="parentSatisfactionLevel" style="width: 100%; padding: 10px; border: 1px solid #64b5f6; border-radius: 10px; background: white; color: #1976d2;"> <option value="">ุงุฎุชุงุฑูุง ุฅุฌุงุจุฉ...</option> <option value="๏ฟฝ๏ฟฝุงุถูู ุฌุฏุงู">ุฑุงุถ๏ฟฝ๏ฟฝู ุฌุฏุงู โญโญโญโญโญ</option> <option value="ุฑุงุถูู">ุฑุงุถูู โญโญโญโญ</option> <option value="ูุญุงูุฏูู">ูุญุงูุฏูู โญโญโญ</option> <option value="ุบูุฑ ุฑุงุถูู">ุบูุฑ ุฑุงุถูู โญโญ</option> <option value="ุบูุฑ ุฑุงุถูู ุชูุงูุงู">ุบูุฑ ุฑุงุถูู ุชูุงูุงู โญ</option> </select>
      </div>
      </div> 

      <button id="submitParentFeedback" style="width:100%;padding:14px;background:linear-gradient(90deg, #009688, #00796b);color:#fff;border:none;border-radius:12px;cursor:pointer;font-size:16px;font-weight:700;box-shadow:0 4px 15px rgba(0,150,136,0.4);transition:all 0.3s ease"> ๐ ุฅุฑุณุงู ุงุณุชุจูุงู ููู/ ูุฉ  ุงูุฃูุฑ </button>
   <button class="whatsapp-btn" id="contactTeacher" style="width:100%;padding:14px;background:linear-gradient(90deg, #25D366, #128C7E);color:#fff;border:none;border-radius:12px;cursor:pointer;font-size:16px;font-weight:700;box-shadow:0 4px 15px rgba(37,211,102,0.4);transition:all 0.3s ease;margin-top:20px"> ๐ฌ ุชูุงุตู ูุน ุงููุนููุฉ ๐ฒ (ูุงุชุณุงุจ) </button>
   
   </section>
  </main><!-- Modal for all dialogs -->
  <div id="modalOverlay" class="modal-overlay">
   <div class="modal-content">
    <div class="modal-header">
     <h3 id="modalTitle">ุนููุงู</h3><button class="modal-close" onclick="closeModal()">๏ฟฝ๏ฟฝ</button>
    </div>
    <div class="modal-body" id="modalBody"><!-- Dynamic content -->
    </div>
    <div class="modal-footer" id="modalFooter"><button class="ghost" onclick="closeModal()">ุฅุบูุงู</button>
    </div>
   </div>
  </div>
  <script>
    // ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
    const TEACHER_PIN = "1234";
    window.contactTeacherWhatsAppParent = function() {
      const phoneNumber = "966555320501";
      const studentName = document.getElementById('pName').textContent;
      const message = `ุงูุณูุงู ุนูููู ูุนููุชู ุงููุงุถูุฉ ๐ธ\n\nูุญู ุฃูููุงุก ุฃูุฑ ุงูุทุงูุจุฉ: ${studentName}\nูุฑุบุจ ูู ุงูุชูุงุตู ูุนู ุจุฎุตูุต ูุงุฏุฉ ุงูุชูููุฉ ุงูุฑูููุฉ.\n\nุดูุฑุงู ูู ๐`;
      const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank', 'noopener,noreferrer');
    };

    // ุฑุจุท ุงูุฃุฒุฑุงุฑ
    document.getElementById('showTeacher').addEventListener('click', function() {
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
      document.getElementById('teacherLogin').classList.remove('hidden');
    });

    document.getElementById('showStudent').addEventListener('click', function() {
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
      document.getElementById('studentLogin').classList.remove('hidden');
    });

    document.getElementById('showParent').addEventListener('click', function() {
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
      document.getElementById('parentLogin').classList.remove('hidden');
    });

    // ุฃุฒุฑุงุฑ ุงูุฅุบูุงู
    document.getElementById('closeTeacher').addEventListener('click', function() {
      document.getElementById('teacherLogin').classList.add('hidden');
    });

    document.getElementById('closeStudent').addEventListener('click', function() {
      document.getElementById('studentLogin').classList.add('hidden');
    });

    document.getElementById('closeParent').addEventListener('click', function() {
      document.getElementById('parentLogin').classList.add('hidden');
    });

    // ุฃุฒุฑุงุฑ ุงูุฏุฎูู
    document.getElementById('teacherEnter').addEventListener('click', function() {
      const code = document.getElementById('teacherCode').value.trim();
      if (code !== TEACHER_PIN) {
        showModal('ุฎุทุฃ', '<p style="text-align: center; color: var(--danger);">ุงูุฑูู ุงูุณุฑู ุบูุฑ ุตุญูุญ. ุญุงููู ูุฑุฉ ุฃุฎุฑู.</p>');
        return;
      }
      document.getElementById('loginMenu').classList.add('hidden');
      document.getElementById('teacherPanel').classList.remove('hidden');
    });

    document.getElementById('studentEnter').addEventListener('click', function() {
      const name = document.getElementById('studentNameInput').value.trim();
      if (!name) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุฅุฏุฎุงู ุงูุงุณู</p>');
        return;
      }
      
      const student = studentsData.find(s => s.name === name);
      if (!student) {
        showModal('ุฎุทุฃ', '<p style="text-align: center;">๏ฟฝ๏ฟฝู ูุชู ุงูุนุซูุฑ ุนูู ุงูุทุงูุจุฉ. ูุฑุฌู ุงูุชุฃูุฏ ูู ุงูุงุณู.</p>');
        return;
      }
      
      displayStudentReport(student);
      
      document.getElementById('loginMenu').classList.add('hidden');
      document.getElementById('studentPanel').classList.remove('hidden');
    });

    document.getElementById('parentEnter').addEventListener('click', function() {
      const name = document.getElementById('parentNameInput').value.trim();
      if (!name) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงูุทุงูุจุฉ</p>');
        return;
      }
      
      const student = studentsData.find(s => s.name === name);
      if (!student) {
        showModal('ุฎุทุฃ', '<p style="text-align: center;">ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุทุงู๏ฟฝ๏ฟฝุฉ. ูุฑุฌู ุงูุชุฃูุฏ ูู ุงูุงุณู.</p>');
        return;
      }
      
      displayParentReport(student);
      
      document.getElementById('loginMenu').classList.add('hidden');
      document.getElementById('parentPanel').classList.remove('hidden');
    });

    // ุฃุฒุฑุงุฑ ุงูุนูุฏุฉ
    document.getElementById('backToMenu1').addEventListener('click', function() {
      document.getElementById('teacherPanel').classList.add('hidden');
      document.getElementById('loginMenu').classList.remove('hidden');
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
    });

    document.getElementById('backToMenu2').addEventListener('click', function() {
      document.getElementById('studentPanel').classList.add('hidden');
      document.getElementById('loginMenu').classList.remove('hidden');
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
    });

    document.getElementById('backToMenu3').addEventListener('click', function() {
      document.getElementById('parentPanel').classList.add('hidden');
      document.getElementById('loginMenu').classList.remove('hidden');
      document.querySelectorAll('.login-card').forEach(c => c.classList.add('hidden'));
    });

    // ูุนุงูุฌ ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ููุทุฑููุฉ ุงูุฅุถุงููุฉ - ุงูุทุงูุจุฉ
    document.getElementById('hasAdditionalMethod').addEventListener('change', function() {
      const container = document.getElementById('additionalMethodContainer');
      if (this.value === 'ูุนู') {
        container.style.display = 'block';
      } else {
        container.style.display = 'none';
      }
    });

    // ูุนุงูุฌ ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ููุทุฑููุฉ ุงูุฅุถุงููุฉ - ููู ุงูุฃูุฑ
    document.getElementById('parentHasAdditionalMethod').addEventListener('change', function() {
      const container = document.getElementById('parentAdditionalMethodContainer');
      if (this.value === 'ูุนู') {
        container.style.display = 'block';
      } else {
        container.style.display = 'none';
      }
    });

    // ูุธุงู Modal
    function showModal(title, bodyHTML, footerHTML = '') {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalBody').innerHTML = bodyHTML;
      if (footerHTML) {
        document.getElementById('modalFooter').innerHTML = footerHTML;
      } else {
        document.getElementById('modalFooter').innerHTML = '<button class="ghost" onclick="closeModal()">ุฅุบูุงู</button>';
      }
      document.getElementById('modalOverlay').classList.add('active');
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('active');
    }

    // ูุธุงู ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช
    const STORAGE_KEY = "gradingData.v1";
    let studentsData = loadData();

    function loadData() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return [];
      try {
        return JSON.parse(raw);
      } catch {
        return [];
      }
    }

    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(studentsData));
      renderTable();
    }

    function renderTable() {
      const tbody = document.getElementById('gradesTableBody');
      tbody.innerHTML = '';

      if (studentsData.length === 0) {
        tbody.innerHTML = '<tr><td colspan="16" style="text-align: center; padding: 3rem 1rem; color: var(--muted);"><div style="font-size: 3rem;">๐</div><p>ูุง ุชูุฌุฏ ุทุงูุจุงุช ๏ฟฝ๏ฟฝุนุฏ</p></td></tr>';
        updateStatistics();
        return;
      }

      studentsData.forEach((student, index) => {
        const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
        const tr = document.createElement('tr');
        tr.style.background = '#fff';
        tr.innerHTML = `
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">${student.name}</td>
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">${student.class}</td>
          <td contenteditable="true" data-index="${index}" data-field="exams" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.exams || 0}</td>
          <td contenteditable="true" data-index="${index}" data-field="practical" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.practical || 0}</td>
          <td contenteditable="true" data-index="${index}" data-field="homework" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.homework || 0}</td>
          <td contenteditable="true" data-index="${index}" data-field="discussion" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.discussion || 0}</td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <select data-index="${index}" data-field="teamwork" style="padding: 4px 8px; border: 1px solid #dfe7f1; border-radius: 6px; background: white; font-size: 0.85rem; width: 100%;">
                <option value="">ุงุฎุชุฑ...</option>
                <option value="ููุชุงุฒ" ${student.teamwork === 'ููุชุงุฒ' ? 'selected' : ''}>ููุชุงุฒ โญ</option>
                <option value="ุฌูุฏ ุฌุฏุงู" ${student.teamwork === 'ุฌูุฏ ุฌุฏุงู' ? 'selected' : ''}>ุฌูุฏ ุฌุฏุงู ๐</option>
                <option value="ุฌูุฏ" ${student.teamwork === 'ุฌูุฏ' ? 'selected' : ''}>ุฌูุฏ โ</option>
                <option value="ููุจูู" ${student.teamwork === 'ููุจูู' ? 'selected' : ''}>ููุจูู ๐</option>
                <option value="ุถุนูู" ${student.teamwork === 'ุถุนูู' ? 'selected' : ''}>ุถุนูู โ๏ธ</option>
              </select>
              <button onclick="addTeamworkNote(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e3f2fd; color: #1976d2; border: 1px solid #90caf9; border-radius: 4px; cursor: pointer; white-space: nowrap;">๐ ููุงุญุธุฉ</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="excellence" placeholder="ุงูุชุจ ููุงุท ุงูุชููุฒ..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.excellence || ''}</textarea>
              <button onclick="suggestExcellence(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #fff3e0; color: #e65100; border: 1px solid #ffb74d; border-radius: 4px; cursor: pointer;">๐ก ุงูุชุฑุงุญ</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="strengths" placeholder="ุงูุชุจ ููุงุท ุงูููุฉ..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.strengths || ''}</textarea>
              <button onclick="suggestStrengths(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e8f5e9; color: #2e7d32; border: 1px solid #81c784; border-radius: 4px; cursor: pointer;">๐ช ุงูุชุฑุงุญ</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="weaknesses" placeholder="ุงูุชุจ ููุงุท ุงูุถุนู..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.weaknesses || ''}</textarea>
              <button onclick="suggestWeaknesses(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #ffebee; color: #c62828; border: 1px solid #ef5350; border-radius: 4px; cursor: pointer;">๐ ุงูุชุฑุงุญ</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <strong style="font-size: 1.1rem; color: ${total >= 90 ? '#2e7d32' : total >= 75 ? '#1976d2' : total >= 60 ? '#f57c00' : '#d32f2f'};">${total}</strong>
              <div style="width: 100%; height: 6px; background: #e0e0e0; border-radius: 3px; overflow: hidden;">
                <div style="height: 100%; background: ${total >= 90 ? '#4caf50' : total >= 75 ? '#2196f3' : total >= 60 ? '#ff9800' : '#f44336'}; width: ${total}%; transition: width 0.3s;"></div>
              </div>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <textarea data-index="${index}" data-field="improvementPlan" placeholder="ุฎุทุฉ ุงูุชุญุณูู..." style="padding: 6px; border: 1px solid #dfe7f1; border-radius: 6px; font-size: 0.85rem; width: 100%; min-height: 50px; resize: vertical;">${student.improvementPlan || ''}</textarea>
              <div style="display: flex; gap: 4px; width: 100%;">
                <button onclick="generatePlan(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #f3e5f5; color: #7b1fa2; border: 1px solid #ba68c8; border-radius: 4px; cursor: pointer; flex: 1;">๐ค ุชูููุฏ</button>
                <button onclick="viewPlanHistory(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e1f5fe; color: #0277bd; border: 1px solid #4fc3f7; border-radius: 4px; cursor: pointer; flex: 1;">๐ ุณุฌู</button>
              </div>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <select data-index="${index}" data-field="studentStatus" style="padding: 4px 8px; border: 1px solid #dfe7f1; border-radius: 6px; background: white; font-size: 0.85rem; width: 100%;">
                <option value="">ุงุฎุชุฑ...</option>
                <option value="ูุชูููุฉ" ${student.studentStatus === 'ูุชูููุฉ' ? 'selected' : ''}>ูุชูููุฉ ๐</option>
                <option value="ุฌูุฏุฉ" ${student.studentStatus === 'ุฌูุฏุฉ' ? 'selected' : ''}>ุฌูุฏุฉ โจ</option>
                <option value="ูุชูุณุทุฉ" ${student.studentStatus === 'ูุชูุณุทุฉ' ? 'selected' : ''}>ูุชูุณุทุฉ ๐</option>
                <option value="ุชุญุชุงุฌ ุฏุนู" ${student.studentStatus === 'ุชุญุชุงุฌ ุฏุนู' ? 'selected' : ''}>ุชุญุชุงุฌ ุฏุนู ๐</option>
              </select>
              <button onclick="analyzeStatus(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #fce4ec; color: #c2185b; border: 1px solid #f48fb1; border-radius: 4px; cursor: pointer; white-space: nowrap;">๐ ุชุญููู</button>
            </div>
          </td>
          
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <div style="display: flex; flex-direction: column; gap: 4px; align-items: center;">
              <select data-index="${index}" data-field="parentContact" style="padding: 4px 8px; border: 1px solid #dfe7f1; border-radius: 6px; background: white; font-size: 0.85rem; width: 100%;">
                <option value="ูุง" ${student.parentContact === 'ูุง' ? 'selected' : ''}>๏ฟฝ๏ฟฝุง โ</option>
                <option value="๏ฟฝ๏ฟฝุนู" ${student.parentContact === 'ูุนู' ? 'selected' : ''}>ูุนู โ</option>
              </select>
              <div style="display: flex; gap: 4px; width: 100%;">
                <button onclick="logContact(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #e8f5e9; color: #2e7d32; border: 1px solid #81c784; border-radius: 4px; cursor: pointer; flex: 1;">๐ ุชุณุฌูู</button>
                <button onclick="viewContactHistory(${index})" style="padding: 3px 6px; font-size: 0.75rem; background: #fff3e0; color: #e65100; border: 1px solid #ffb74d; border-radius: 4px; cursor: pointer; flex: 1;">๐ ุณุฌู</button>
              </div>
            </div>
          </td>
          
          <td contenteditable="true" data-index="${index}" data-field="attendance" style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center; cursor: text;">${student.attendance || 0}</td>
          <td style="padding: 8px 6px; border-bottom: 1px solid #eef3f9; text-align: center;">
            <button class="danger" onclick="deleteStudent(${index})" style="padding: 4px 8px; font-size: 0.85rem;">๐๏ธ</button>
          </td>
        `;
        tbody.appendChild(tr);
      });

      // ุชูุนูู ุงูุชุนุฏูู ุงููุจุงุดุฑ ููุฃุฑูุงู
      document.querySelectorAll('td[contenteditable="true"]').forEach(td => {
        td.addEventListener('blur', function() {
          const index = parseInt(this.dataset.index);
          const field = this.dataset.field;
          
          if (['exams', 'practical', 'homework', 'discussion', 'attendance'].includes(field)) {
            const value = parseInt(this.textContent) || 0;
            const maxValues = { exams: 20, practical: 30, homework: 30, discussion: 20, attendance: 100 };
            const finalValue = Math.max(0, Math.min(maxValues[field] || 100, value));
            this.textContent = finalValue;
            studentsData[index][field] = finalValue;
          } else {
            studentsData[index][field] = this.textContent.trim();
          }
          saveData();
        });
      });

      // ุชูุนูู ุงูุชุนุฏูู ููู textarea
      document.querySelectorAll('textarea[data-index]').forEach(textarea => {
        textarea.addEventListener('blur', function() {
          const index = parseInt(this.dataset.index);
          const field = this.dataset.field;
          studentsData[index][field] = this.value.trim();
          saveData();
        });
      });

      // ุชูุนูู ุงูููุงุฆู ุงูููุณุฏูุฉ
      document.querySelectorAll('select[data-index]').forEach(select => {
        select.addEventListener('change', function() {
          const index = parseInt(this.dataset.index);
          const field = this.dataset.field;
          studentsData[index][field] = this.value;
          saveData();
        });
      });

      updateStatistics();
    }
    
    function updateStatistics() {
      const totalStudents = studentsData.length;
      
      if (totalStudents === 0) {
        document.getElementById('countStudents').textContent = '0';
        document.getElementById('classAvg').textContent = '0';
        document.getElementById('attendanceRate').textContent = '0%';
        document.getElementById('overduePlans').textContent = '0';
        document.getElementById('dueSoonPlans').textContent = '0';
        document.getElementById('dueTodayPlans').textContent = '0';
        return;
      }
      
      const avgTotal = studentsData.reduce((sum, s) => sum + ((s.exams || 0) + (s.practical || 0) + (s.homework || 0) + (s.discussion || 0)), 0) / totalStudents;
      const totalAttendanceDays = studentsData.reduce((sum, s) => sum + (s.attendance || 0), 0);
      const avgAttendance = totalAttendanceDays / totalStudents;
      const attendanceRate = ((avgAttendance / 100) * 100).toFixed(0);
      
      document.getElementById('countStudents').textContent = totalStudents;
      document.getElementById('classAvg').textContent = avgTotal.toFixed(1);
      document.getElementById('attendanceRate').textContent = attendanceRate + '%';
      
      // ุญุณุงุจ ุงูุฎุทุท (ุงูุชุฑุงุถูุงู 0 ุญุชู ูุชู ุงุณุชูุฑุงุฏ ููู ุงูุฎุทุท)
      document.getElementById('overduePlans').textContent = '0';
      document.getElementById('dueSoonPlans').textContent = '0';
      document.getElementById('dueTodayPlans').textContent = '0';
    }

    // ูุธุงุฆู ุงูุฃุนูุฏุฉ ุงููุชูุฏูุฉ
    window.addTeamworkNote = function(index) {
      const student = studentsData[index];
      showModal('ููุงุญุธุฉ ุงูุชุนุงูู ูุน ุงููุฌ๏ฟฝ๏ฟฝูุนุฉ', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">ุงูุทุงูุจุฉ:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">ุงูููุงุญุธุฉ:</label>
          <textarea id="teamworkNoteText" placeholder="ุงูุชุจ ููุงุญุธุฉ ุนู ุชุนุงูู ุงูุทุงูุจุฉ ูุน ุงููุฌููุนุฉ..." style="width: 100%; min-height: 120px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;">${student.teamworkNote || ''}</textarea>
        </div>
      `, `
        <button onclick="saveTeamworkNote(${index})">๐พ ุญูุธ</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };
    
    window.saveTeamworkNote = function(index) {
      const noteText = document.getElementById('teamworkNoteText').value.trim();
      studentsData[index].teamworkNote = noteText;
      saveData();
      closeModal();
      showModal('ุชู ุงูุญูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุญูุธ ููุงุญุธุฉ ุงูุชุนุงูู ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    };

    window.suggestExcellence = function(index) {
      const student = studentsData[index];
      const suggestions = [
        'ุชููุฒ ูู ุญู ุงููุดููุงุช ุจุทุฑู ุฅุจุฏุงุนูุฉ',
        'ุชูุชูู ููุงุฑุฉ ุชูุฏูู ุงูุฃููุงุฑ ุจูุถูุญ',
        'ุชุธูุฑ ููุงุฏุฉ ูุงุถุญุฉ ูู ุงููุดุงุฑูุน ุงูุฌูุงุนูุฉ',
        'ุชุจุฏู ุงูุชูุงูุงู ูุงุถุญุงู ุจุงูุชู๏ฟฝ๏ฟฝุตูู ุงูุฏูููุฉ',
        'ุชุชูุชุน ุจุณุฑุนุฉ ุงุณุชูุนุงุจ ุงูููุงููู ุงูุฌุฏูุฏุฉ'
      ];
      
      const currentPoints = (student.excellence || '').split('โข').filter(p => p.trim()).map(p => p.trim());
      
      showModal('ุงูุชุฑุงุญุงุช ูููุงุท ุงูุชููุฒ', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">ุงูุทุงูุจุฉ:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">ุงุฎุชุฑ ููุงุท ุง๏ฟฝ๏ฟฝุชููุฒ (ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุทุฉ):</label>
          <div id="excellenceSuggestions" style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${suggestions.map((sug, i) => `
              <label style="display: flex; align-items: start; gap: 0.5rem; padding: 0.75rem; background: #fff3e0; border: 2px solid #ffe0b2; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                <input type="checkbox" id="excellence_${i}" value="${sug}" style="margin-top: 0.25rem; width: 18px; height: 18px; cursor: pointer;">
                <span style="flex: 1; line-height: 1.5;">โจ ${sug}</span>
              </label>
            `).join('')}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">ุฃู ุงูุชุจ ููุทุฉ ุชููุฒ ุฌุฏูุฏุฉ:</label>
          <textarea id="customExcellence" placeholder="ุงูุช๏ฟฝ๏ฟฝ ููุทุฉ ุชููุฒ ูุฎุตุตุฉ..." style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;"></textarea>
        </div>
        
        ${currentPoints.length > 0 ? `
          <div style="background: #e8f5e9; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #81c784;">
            <p style="font-weight: 600; color: #2e7d32; margin-bottom: 0.5rem; font-size: 0.9rem;">๐ ุงูููุงุท ุงููุถุงูุฉ ุญุงููุงู:</p>
            <div style="font-size: 0.9rem; line-height: 1.8; color: var(--text);">
              ${currentPoints.map(p => `โข ${p}`).join('<br>')}
            </div>
          </div>
        ` : ''}
      `, `
        <button onclick="saveExcellenceSuggestions(${index})">๐พ ุญูุธ ุงูููุงุท</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };
    
    window.saveExcellenceSuggestions = function(index) {
      const selectedPoints = [];
      
      document.querySelectorAll('#excellenceSuggestions input[type="checkbox"]:checked').forEach(checkbox => {
        selectedPoints.push(checkbox.value);
      });
      
      const customPoint = document.getElementById('customExcellence').value.trim();
      if (customPoint) {
        selectedPoints.push(customPoint);
      }
      
      if (selectedPoints.length === 0) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุงุฎุชูุงุฑ ููุทุฉ ุชููุฒ ูุงุญุฏุฉ ุนูู ุงูุฃูู ุฃู ูุช๏ฟฝ๏ฟฝุจุฉ ููุทุฉ ูุฎุตุตุฉ</p>');
        return;
      }
      
      const currentPoints = (studentsData[index].excellence || '').split('โข').filter(p => p.trim()).map(p => p.trim());
      const allPoints = [...new Set([...currentPoints, ...selectedPoints])];
      
      studentsData[index].excellence = allPoints.map(p => `โข ${p}`).join('\n');
      saveData();
      closeModal();
      showModal('ุชู ุงูุญูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุฅุถุงูุฉ ููุงุท ุงูุชููุฒ ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    };

    window.suggestStrengths = function(index) {
      const student = studentsData[index];
      const suggestions = [
        'ุงูุงูุชุฒุงู ุจุงูููุงุนูุฏ ูุงูุงูุถุจุงุท',
        'ุงููุดุงุฑูุฉ ุงููุนุงูุฉ ูู ุงูููุงุดุงุช',
        'ุฅุชูุงู ุงูููุงุฑุงุช ุงูุนูููุฉ',
        'ุงูุชูุงุนู ุงูุฅูุฌุงุจู ูุน ุงูุฒูููุงุช',
        'ุงููุฏุฑุฉ ุนูู ุงูุนูู ุจุดูู ูุณ๏ฟฝ๏ฟฝูู'
      ];
      
      const currentPoints = (student.strengths || '').split('๏ฟฝ๏ฟฝ๏ฟฝ').filter(p => p.trim()).map(p => p.trim());
      
      showModal('ุงูุชุฑุงุญุงุช ูููุงุท ุงูููุฉ', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">ุงูุทุง๏ฟฝ๏ฟฝุจุฉ:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">ุงุฎุชุฑ ููุงุท ุงูููุฉ (ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุทุฉ):</label>
          <div id="strengthsSuggestions" style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${suggestions.map((sug, i) => `
              <label style="display: flex; align-items: start; gap: 0.5rem; padding: 0.75rem; background: #e8f5e9; border: 2px solid #c8e6c9; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                <input type="checkbox" id="strength_${i}" value="${sug}" style="margin-top: 0.25rem; width: 18px; height: 18px; cursor: pointer;">
                <span style="flex: 1; line-height: 1.5;">๐ช ${sug}</span>
              </label>
            `).join('')}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">ุฃู ุงูุชุจ ููุทุฉ ููุฉ ุฌุฏูุฏุฉ:</label>
          <textarea id="customStrength" placeholder="ุงูุชุจ ููุทุฉ ููุฉ ูุฎุตุตุฉ..." style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;"></textarea>
        </div>
        
        ${currentPoints.length > 0 ? `
          <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #90caf9;">
            <p style="font-weight: 600; color: #1976d2; margin-bottom: 0.5rem; font-size: 0.9rem;">๐ ุงูููุงุท ุงููุถุงูุฉ ุญุงููุงู:</p>
            <div style="font-size: 0.9rem; line-height: 1.8; color: var(--text);">
              ${currentPoints.map(p => `โข ${p}`).join('<br>')}
            </div>
          </div>
        ` : ''}
      `, `
        <button onclick="saveStrengthsSuggestions(${index})">๐พ ุญูุธ ุงูููุงุท</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };
    
    window.saveStrengthsSuggestions = function(index) {
      const selectedPoints = [];
      
      document.querySelectorAll('#strengthsSuggestions input[type="checkbox"]:checked').forEach(checkbox => {
        selectedPoints.push(checkbox.value);
      });
      
      const customPoint = document.getElementById('customStrength').value.trim();
      if (customPoint) {
        selectedPoints.push(customPoint);
      }
      
      if (selectedPoints.length === 0) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุงุฎุชูุงุฑ ููุทุฉ ููุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ุฃู ูุชุงุจุฉ ููุทุฉ ูุฎุตุตุฉ</p>');
        return;
      }
      
      const currentPoints = (studentsData[index].strengths || '').split('โข').filter(p => p.trim()).map(p => p.trim());
      const allPoints = [...new Set([...currentPoints, ...selectedPoints])];
      
      studentsData[index].strengths = allPoints.map(p => `โข ${p}`).join('\n');
      saveData();
      closeModal();
      showModal('ุชู ุงู๏ฟฝ๏ฟฝูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุฅุถุงูุฉ ููุงุท ุงูููุฉ ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    };

    window.suggestWeaknesses = function(index) {
      const student = studentsData[index];
      const suggestions = [
        'ุชุญุชุงุฌ ูุชุญุณูู ุงููุดุงุฑูุฉ ูู ุงูุตู',
        'ุชุญุชุงุฌ ูุชูููุฉ ููุงุฑุงุช ุฅุฏุงุฑุฉ ุงูููุช',
        'ุชุญุชุงุฌ ูุชุทููุฑ ููุงุฑุฉ ุงูุชูููุฑ ุงูููุฏู',
        'ุชุญุชุงุฌ ูุชุญุณูู ุฃุณููุจ ุชูุธูู ุงูุฃููุงุฑ',
        'ุชุญุชุงุฌ ููุฒูุฏ ูู ุงูุซูุฉ ุนูุฏ ุงูุชูุฏูู'
      ];
      
      const currentPoints = (student.weaknesses || '').split('โข').filter(p => p.trim()).map(p => p.trim());
      
      showModal('ุงูุชุฑุงุญุงุช ูููุงุท ุงูุถุนู', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">ุงูุทุงูุจุฉ:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">ุงุฎุชุฑ ููุงุท ุงูุถุนู (ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุทุฉ):</label>
          <div id="weaknessesSuggestions" style="display: flex; flex-direction: column; gap: 0.5rem;">
            ${suggestions.map((sug, i) => `
              <label style="display: flex; align-items: start; gap: 0.5rem; padding: 0.75rem; background: #ffebee; border: 2px solid #ffcdd2; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                <input type="checkbox" id="weakness_${i}" value="${sug}" style="margin-top: 0.25rem; width: 18px; height: 18px; cursor: pointer;">
                <span style="flex: 1; line-height: 1.5;">๐ ${sug}</span>
              </label>
            `).join('')}
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">ุฃู ุงูุชุจ ููุทุฉ ุถุนู ุฌุฏูุฏุฉ:</label>
          <textarea id="customWeakness" placeholder="ุงูุชุจ ููุทุฉ ุถุนู ูุฎุตุตุฉ..." style="width: 100%; min-height: 80px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical;"></textarea>
        </div>
        
        ${currentPoints.length > 0 ? `
          <div style="background: #fff3e0; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #ffb74d;">
            <p style="font-weight: 600; color: #e65100; margin-bottom: 0.5rem; font-size: 0.9rem;">๐ ุงูููุงุท ุงููุถุงูุฉ ุญุงููุงู:</p>
            <div style="font-size: 0.9rem; line-height: 1.8; color: var(--text);">
              ${currentPoints.map(p => `โข ${p}`).join('<br>')}
            </div>
          </div>
        ` : ''}
      `, `
        <button onclick="saveWeaknessesSuggestions(${index})">๐พ ุญูุธ ุงู๏ฟฝ๏ฟฝูุงุท</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };
    
    window.saveWeaknessesSuggestions = function(index) {
      const selectedPoints = [];
      
      document.querySelectorAll('#weaknessesSuggestions input[type="checkbox"]:checked').forEach(checkbox => {
        selectedPoints.push(checkbox.value);
      });
      
      const customPoint = document.getElementById('customWeakness').value.trim();
      if (customPoint) {
        selectedPoints.push(customPoint);
      }
      
      if (selectedPoints.length === 0) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุงุฎุชูุงุฑ ููุทุฉ ุถุนู ูุงุญุฏุฉ ุนูู ุงูุฃูู ุฃู ูุชุงุจุฉ ููุทุฉ ูุฎุตุตุฉ</p>');
        return;
      }
      
      const currentPoints = (studentsData[index].weaknesses || '').split('โข').filter(p => p.trim()).map(p => p.trim());
      const allPoints = [...new Set([...currentPoints, ...selectedPoints])];
      
      studentsData[index].weaknesses = allPoints.map(p => `โข ${p}`).join('\n');
      saveData();
      closeModal();
      showModal('ุชู ุงูุญูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุฅุถุงูุฉ ููุงุท ุงูุถุนู ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    };

    window.generatePlan = function(index) {
      const student = studentsData[index];
      const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
      const attendance = student.attendance || 0;
      const attendanceRate = (attendance / 100) * 100;
      
      // ุชุญููู ููุงุท ุงูููุฉ ูุงูุถุนู
      const hasStrengths = student.strengths && student.strengths.trim();
      const hasWeaknesses = student.weaknesses && student.weaknesses.trim();
      const hasExcellence = student.excellence && student.excellence.trim();
      
      // ุชุญููู ุงูุฃุฏุงุก ูู ูู ูุฌุงู
      const examsPercent = ((student.exams || 0) / 20) * 100;
      const practicalPercent = ((student.practical || 0) / 30) * 100;
      const homeworkPercent = ((student.homework || 0) / 30) * 100;
      const discussionPercent = ((student.discussion || 0) / 20) * 100;
      
      // ุชุญุฏูุฏ ุงููุฌุงูุงุช ุงูุชู ุชุญุชุงุฌ ุชุญุณูู
      const weakAreas = [];
      if (examsPercent < 75) weakAreas.push('ุงูุงุฎุชุจุงุฑุงุช');
      if (practicalPercent < 75) weakAreas.push('ุงูุชูููู ุงูุนููู');
      if (homeworkPercent < 75) weakAreas.push('ุงููุงุฌุจุงุช');
      if (discussionPercent < 75) weakAreas.push('ุงููุดุงุฑูุฉ ูุงูุชูุงุนู ุงูุตูู');
      
      // ุจูุงุก ุงูุฎุทุฉ ุจูุงุกู ๏ฟฝ๏ฟฝูู ุงูุชุญููู
      let plan = '';
      
      // ุนููุงู ุงูุฎุทุฉ ุญุณุจ ุงููุณุชูู
      if (total >= 90) {
        plan += '๐ ุฎุทุฉ ุฅุซุฑุงุฆูุฉ ููุญูุงุธ ุนูู ุงูุชููุฒ:\n\n';
      } else if (total >= 75) {
        plan += '๐ ุฎุทุฉ ุชุทููุฑูุฉ ูููุตูู ููุชููุฒ:\n\n';
      } else if (total >= 60) {
        plan += '๐ช ุฎุทุฉ ุนูุงุฌูุฉ ูุชุญุณูู ุงูุฃุฏุงุก:\n\n';
      } else {
        plan += '๐ ุฎุทุฉ ุนูุงุฌูุฉ ููุซูุฉ:\n\n';
      }
      
      // ุงููุณู ุงูุฃูู: ููุงุท ุงูููุฉ (ุฅู ูุฌุฏุช)
      if (hasExcellence || hasStrengths) {
        plan += 'โจ ุงูุงุณุชูุงุฏุฉ ูู ููุงุท ุงูุชููุฒ ูุงูููุฉ:\n';
        if (hasExcellence) {
          plan += `โข ุงูุงุณุชูุฑุงุฑ ูู ุชุทููุฑ: ${student.excellence.split('โข').filter(p => p.trim()).map(p => p.trim()).join(' ู')}\n`;
        }
        if (hasStrengths) {
          plan += `โข ุงูุจูุงุก ุนูู: ${student.strengths.split('โข').filter(p => p.trim()).map(p => p.trim()).join(' ู')}\n`;
        }
        plan += '\n';
      }
      
      // ุงููุณู ุงูุซุงูู: ูุนุงูุฌุฉ ููุงุท ุงูุถุนู
      if (hasWeaknesses || weakAreas.length > 0) {
        plan += '๐ ูุนุงูุฌุฉ ููุงุท ุงูุถุนู:\n';
        
        if (hasWeaknesses) {
          const weakPoints = student.weaknesses.split('โข').filter(p => p.trim()).map(p => p.trim());
          weakPoints.forEach(point => {
            if (point.includes('ุงููุดุงุฑูุฉ')) {
              plan += 'โข ุชุดุฌูุน ุงููุดุงุฑูุฉ ูู ุฎูุงู ุฃุณุฆูุฉ ูุญูุฒุฉ ูุจูุฆุฉ ุฏุงุนูุฉ\n';
            } else if (point.includes('ุฅุฏุงุฑุฉ ุงูููุช')) {
              plan += 'โข ุชุฏุฑูุจ ุนูู ููุงุฑุงุช ุฅุฏุงุฑุฉ ุงูููุช ูุชูุธูู ุงูููุงู\n';
            } else if (point.includes('ุงูุชูููุฑ ุงูููุฏู')) {
              plan += 'โข ุฃูุดุทุฉ ุชุทุจูููุฉ ูุชูููุฉ ููุงุฑุงุช ุงูุชูููุฑ ุงูููุฏู\n';
            } else if (point.includes('ุชูุธูู ุงูุฃููุงุฑ')) {
              plan += 'โข ุงุณุชุฎุฏุงู ุฎุฑุงุฆุท ุฐูููุฉ ูุฃุฏูุงุช ุชูุธูู ุงูุฃููุงุฑ\n';
            } else if (point.includes('ุงูุซูุฉ')) {
              plan += 'โข ุจูุงุก ุงูุซูุฉ ูู ุฎูุงู ๏ฟฝ๏ฟฝูุชูุฏูู ุฃูุงู ูุฌููุน๏ฟฝ๏ฟฝุช ุตุบูุฑุฉ ุชุฏุฑูุฌูุงู\n';
            } else {
              plan += `โข ุงูุชุฑููุฒ ุนูู ุชุญุณูู: ${point}\n`;
            }
          });
        }
        
        if (weakAreas.length > 0) {
          plan += `โข ูุนุงูุฌุฉ ููุซูุฉ ูู: ${weakAreas.join(' ู ')}\n`;
        }
        plan += '\n';
      }
      
      // ุงููุณู ุงูุซุงูุซ: ุฎุทุฉ ุชุญุณูู ุงูุฏุฑุฌุงุช ุญุณุจ ุงููุฌุงูุงุช ุงูุถุนููุฉ
      if (weakAreas.length > 0) {
        plan += '๐ฏ ุฎุทุฉ ุชุญุณูู ุงูุฃุฏุงุก ุงูุฃูุงุฏููู:\n';
        
        if (examsPercent < 75) {
          plan += `โข ุงูุงุฎุชุจุงุฑุงุช (${student.exams}/20): ูุฑุงุฌุนุฉ ุฏูุฑูุฉ + ููุงุฐุฌ ุงุฎุชุจุงุฑุงุช ุชุฏุฑูุจูุฉ\n`;
        }
        if (practicalPercent < 75) {
          plan += `โข ุงูุชูููู ุงูุนููู (${student.practical}/30): ุฌูุณุงุช ุชุทุจูู ุนููู ุฅุถุงููุฉ + ูุชุงุจุนุฉ ูุฑุฏูุฉ\n`;
        }
        if (homeworkPercent < 75) {
          plan += `โข ุงููุงุฌุจุงุช (${student.homework}/30): ูุชุงุจุนุฉ ููููุฉ + ุชูุฏูู ููุงุฐุฌ ุฅุฑุดุงุฏูุฉ\n`;
        }
        if (discussionPercent < 75) {
          plan += `โข ุงููุดุงุฑูุฉ (${student.discussion}/20): ุชุดุฌูุน ุงููุดุงุฑูุฉ + ุฃุณุฆูุฉ ููุฌูุฉ\n`;
        }
        plan += '\n';
      }
      
      // ุงููุณู ุงูุฑุงุจุน: ูุนุงูุฌุฉ ุงูุบูุงุจ ุฅู ูุฌุฏ
      if (attendanceRate < 90) {
        plan += 'โ๏ธ ูุนุงูุฌุฉ ุงูุบูุงุจ:\n';
        plan += `โข ูุณุจุฉ ุงูุญุถูุฑ ุงูุญุงููุฉ: ${attendanceRate.toFixed(0)}% (${attendance}/100 ููู)\n`;
        plan += 'โข ุงูุชูุงุตู ูุน ููู ุงูุฃูุฑ ูุถูุงู ุงูุงูุชุธุงู\n';
        plan += 'โข ุชูููุฑ ููุฎุตุงุช ููุฏุฑูุณ ุงููุงุฆุชุฉ\n';
        plan += 'โข ุฌุฏููุฉ ุฌูุณุงุช ุชุนููุถูุฉ ุนูุฏ ุงูุญุงุฌุฉ\n\n';
      }
      
      // ุงููุณู ุงูุฎุงูุณ: ุงูุชูุตูุงุช ุญุณุจ ุญุงูุฉ ุงูุทุงูุจุฉ
      plan += '๐ ๏ฟฝ๏ฟฝูุชูุตูุงุช ูุงููุชุงุจุนุฉ:\n';
      
      if (student.studentStatus === 'ูุชูููุฉ') {
        plan += 'โข ูุดุงุฑูุน ๏ฟฝ๏ฟฝุซุฑุงุฆูุฉ ุชุญุฏู ูุชุทููุฑ ุงูููุงุฑุงุช\n';
        plan += 'โข ุชูููููุง ุจููุงุฏุฉ ูุฌููุนุงุช ุนูู\n';
        plan += 'โข ุชูุฌูููุง ููุณุงุจูุงุช ููุจุงุฏุฑุงุช ุชูููุฉ\n';
      } else if (student.studentStatus === 'ุชุญุชุงุฌ ุฏุนู') {
        plan += 'โข ูุชุงุจุนุฉ ููููุฉ ููุซูุฉ\n';
        plan += 'โข ุฌูุณุงุช ุฏุนู ูุฑุฏูุฉ (3 ูุฑุงุช ุฃุณุจูุนูุงู)\n';
        plan += 'โข ุชูุงุตู ุฃุณุจูุนู ูุน ููู ุงูุฃูุฑ\n';
        plan += 'โข ุชุจุณูุท ุงูููุงู ูุชูุณูููุง ูุฎุทูุงุช ุตุบูุฑุฉ\n';
      } else if (student.studentStatus === 'ูุชูุณุทุฉ') {
        plan += 'โข ูุชุงุจุนุฉ ุฃุณุจูุนูุฉ ููุชุธูุฉ\n';
        plan += 'โข ุฌูุณุงุช ุฏุนู ุนูุฏ ุงูุญุงุฌุฉ\n';
        plan += 'โข ุชุดุฌูุน ููุชุงุจุนุฉ ุงูุชูุฏู\n';
      } else if (student.studentStatus === 'ุฌูุฏุฉ') {
        plan += 'โข ูุชุงุจุนุฉ ุฏูุฑูุฉ\n';
        plan += 'โข ุชุญููุฒ ูููุตูู ูู๏ฟฝ๏ฟฝููุฒ\n';
        plan += 'โข ุฃูุดุทุฉ ุฅุซุฑุงุฆูุฉ ุชุฏุฑูุฌูุฉ\n';
      }
      
      // ุงูุชุนุงูู ูุน ุงููุฌููุนุฉ
      if (student.teamwork) {
        plan += `โข ุงูุงุณุชูุงุฏุฉ ูู ูุณุชูู ุงูุชุนุงูู (${student.teamwork}) ูู ุงูุฃูุดุทุฉ ุงูุฌูุงุนูุฉ\n`;
      }
      
      plan += '\nโฐ ูุฏุฉ ุงูุฎุทุฉ: ';
      if (total >= 75) {
        plan += 'ุดูุฑ ูุงุญุฏ ูุน ุชูููู ูุตูู';
      } else {
        plan += 'ุดูุฑูู ูุน ุชูููู ุฃุณุจูุนู';
      }
      
      showModal('ุฎุทุฉ ุฑูุน ุงููุณุชูู ุงูููุชุฑุญุฉ ๐ฏ', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">ุงูุทุงูุจุฉ:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="background: linear-gradient(135deg, #e3f2fd, #e8eaf6); padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border: 2px solid #90caf9;">
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
            <div style="background: white; padding: 0.5rem; border-radius: 6px; text-align: center;">
              <p style="font-size: 0.8rem; color: var(--muted); margin-bottom: 0.25rem;">ุงููุฌููุน</p>
              <p style="font-size: 1.25rem; font-weight: 700; color: ${total >= 90 ? '#2e7d32' : total >= 75 ? '#1976d2' : total >= 60 ? '#f57c00' : '#d32f2f'};">${total}/100</p>
            </div>
            <div style="background: white; padding: 0.5rem; border-radius: 6px; text-align: center;">
              <p style="font-size: 0.8rem; color: var(--muted); margin-bottom: 0.25rem;">ุงูุญุถูุฑ</p>
              <p style="font-size: 1.25rem; font-weight: 700; color: ${attendanceRate >= 90 ? '#2e7d32' : attendanceRate >= 75 ? '#f57c00' : '#d32f2f'};">${attendanceRate.toFixed(0)}%</p>
            </div>
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">ุงูุฎุทุฉ ุงูููุชุฑุญุฉ:</label>
          <textarea id="generatedPlan" style="width: 100%; min-height: 400px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 0.95rem; line-height: 1.8; resize: vertical; font-family: 'Tajawal', sans-serif;">${plan}</textarea>
          <p style="font-size: 0.85rem; color: var(--muted); margin-top: 0.5rem; font-style: italic;">๐ก ููููู ุชุนุฏูู ุงูุฎุทุฉ ูุจู ุงูุญูุธ</p>
        </div>
      `, `
        <button onclick="savePlanFromModal(${index})">๐พ ุญูุธ ุงูุฎุทุฉ</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };
    
    window.savePlanFromModal = function(index) {
      const planText = document.getElementById('generatedPlan').value.trim();
      if (!planText) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ูุชุงุจุฉ ุฎุทุฉ ูุจู ุงูุญูุธ</p>');
        return;
      }
      
      studentsData[index].improvementPlan = planText;
      
      // ุญูุธ ูู ุณุฌู ุงูุฎุทุท
      if (!studentsData[index].planHistory) {
        studentsData[index].planHistory = [];
      }
      studentsData[index].planHistory.push({
        date: new Date().toISOString(),
        plan: planText,
        totalScore: (studentsData[index].exams || 0) + (studentsData[index].practical || 0) + (studentsData[index].homework || 0) + (studentsData[index].discussion || 0)
      });
      
      saveData();
      closeModal();
      showModal('ุชู ุงูุญูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุญูุธ ุงูุฎุทุฉ ุจูุฌุงุญ ูุฅุถุงูุชูุง ููุณุฌู</p>');
      setTimeout(closeModal, 1500);
    };

    window.viewPlanHistory = function(index) {
      showModal('ุณุฌู ุงู๏ฟฝ๏ฟฝุทุท', `<p>ุนุฑุถ ุณุฌู ุฎุทุท ุงูุทุงูุจุฉ: ${studentsData[index].name}</p>`);
    };

    window.analyzeStatus = function(index) {
      showModal('ุชุญููู ุงูุญุงูุฉ', `<p>ุชุญููู ุญุงูุฉ ุงูุทุงูุจุฉ: ${studentsData[index].name}</p>`);
    };

    window.logContact = function(index) {
      const student = studentsData[index];
      showModal('ุชุณุฌูู ุชูุงุตู ูุน ููู ุงูุฃูุฑ', `
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--brand);">ุงูุทุงูุจุฉ:</label>
          <div style="padding: 0.75rem; background: #f5f9fc; border-radius: 8px; font-weight: 700; font-size: 1.05rem; color: var(--text);">
            ${student.name}
          </div>
        </div>
        
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text);">ุทุฑููุฉ ุงูุชูุงุตู:</label>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #e3f2fd; border: 2px solid #90caf9; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="ูุงุชู" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">๐</span>
              <span style="flex: 1; font-weight: 600; color: #1565c0;">ูุงุชู</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #dcf8e8; border: 2px solid #25D366; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="ูุงุชุณ ุขุจ" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">๐ฌ</span>
              <span style="flex: 1; font-weight: 600; color: #128C7E;">ูุงุชุณ ุขุจ</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #fff3e0; border: 2px solid #ffb74d; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="ุจุฑูุฏ ุฅููุชุฑููู" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">โ๏ธ</span>
              <span style="flex: 1; font-weight: 600; color: #e65100;">ุจุฑูุฏ ุฅููุชุฑููู</span>
            </label>
            
            <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: #f3e5f5; border: 2px solid #ba68c8; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
              <input type="radio" name="contactMethod" value="ุงุฌุชูุงุน ูุจุงุดุฑ" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 1.3rem;">๐ฅ</span>
              <span style="flex: 1; font-weight: 600; color: #7b1fa2;">ุงุฌุชูุงุน ูุจุงุดุฑ</span>
            </label>
          </div>
        </div>
        
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text);">ููุฎุต ุงููุญุงุฏุซุฉ:</label>
          <textarea id="contactSummary" placeholder="ุงูุชุจ ููุฎุต ุงููุญุงุฏุซุฉ..." style="width: 100%; min-height: 120px; padding: 12px; border: 1px solid #dfe7f1; border-radius: 10px; font-size: 1rem; resize: vertical; line-height: 1.6;"></textarea>
        </div>
      `, `
        <button onclick="saveContactLog(${index})">๐พ ุญูุธ</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };

    window.saveContactLog = function(index) {
      const selectedMethod = document.querySelector('input[name="contactMethod"]:checked');
      const summary = document.getElementById('contactSummary').value.trim();
      
      if (!selectedMethod) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุชูุงุตู</p>');
        return;
      }
      
      if (!summary) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ูุชุงุจุฉ ููุฎุต ุงููุญุงุฏุซุฉ</p>');
        return;
      }
      
      if (!studentsData[index].contactHistory) {
        studentsData[index].contactHistory = [];
      }
      
      studentsData[index].contactHistory.push({
        date: new Date().toISOString(),
        method: selectedMethod.value,
        summary: summary
      });
      
      studentsData[index].parentContact = 'ูุนู';
      
      saveData();
      closeModal();
      showModal('ุชู ุงูุชุณุฌูู ุจูุฌุงุญ! โ', `
        <div style="text-align: center; padding: 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">โ</div>
          <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600;">ุชู ุชุณุฌูู ุงูุชูุงุตู ุจูุฌุงุญ</p>
          <p style="color: var(--muted); margin-top: 0.5rem;">ุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุชูุงุตู ุฅูู "ูุนู"</p>
        </div>
      `);
      setTimeout(closeModal, 2000);
    };

    window.viewContactHistory = function(index) {
      const student = studentsData[index];
      const history = student.contactHistory || [];
      
      if (history.length === 0) {
        showModal('ุณุฌู ุงูุชูุงุตู', `
          <div style="text-align: center; padding: 2rem;">
            <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">๐</div>
            <p style="color: var(--muted);">ูุง ุชูุฌุฏ ุณุฌูุงุช ุชูุงุตู ุจุนุฏ</p>
            <p style="color: var(--muted); font-size: 0.9rem; margin-top: 0.5rem;">ุงูุทุงูุจุฉ: ${student.name}</p>
          </div>
        `);
        return;
      }
      
      const methodIcons = {
        'ูุงุชู': '๐',
        'ูุงุชุณ ุขุจ': '๐ฌ',
        'ุจุฑูุฏ ุฅููุชุฑููู': 'โ๏ธ',
        'ุงุฌุชูุงุน ูุจุงุดุฑ': '๐ฅ'
      };
      
      const historyHTML = history.map((contact, i) => {
        const date = new Date(contact.date);
        const dateStr = date.toLocaleDateString('ar-SA', { year: 'numeric', month: 'long', day: 'numeric' });
        const timeStr = date.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' });
        const icon = methodIcons[contact.method] || '๐';
        
        return `
          <div style="background: white; padding: 1rem; border-radius: 10px; border-right: 4px solid ${i === 0 ? '#66bb6a' : '#90caf9'}; margin-bottom: 0.75rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <span style="font-size: 1.3rem;">${icon}</span>
                <span style="font-weight: 600; color: #1565c0;">${contact.method}</span>
              </div>
              <span style="font-size: 0.85rem; color: var(--muted);">${dateStr}</span>
            </div>
            <div style="font-size: 0.85rem; color: var(--muted); margin-bottom: 0.5rem;">${timeStr}</div>
            <p style="color: var(--text); line-height: 1.6; font-size: 0.95rem;">${contact.summary}</p>
          </div>
        `;
      }).join('');
      
      showModal(`ุณุฌู ุงูุชูุงุตู - ${student.name}`, `
        <div style="margin-bottom: 1rem;">
          <div style="background: linear-gradient(135deg, #e8f5e9, #f1f8e9); padding: 1rem; border-radius: 10px; text-align: center; border: 2px solid #81c784;">
            <p style="font-size: 0.9rem; color: var(--muted); margin-bottom: 0.25rem;">ุฅุฌูุงูู ุงูุชูุงุตูุงุช</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #2e7d32;">${history.length}</p>
          </div>
        </div>
        
        <div style="max-height: 400px; overflow-y: auto; padding-right: 0.5rem;">
          ${historyHTML}
        </div>
      `);
    };

    window.deleteStudent = function(index) {
      const student = studentsData[index];
      showModal('ุชุฃููุฏ ุงูุญุฐู', `
        <p style="text-align: center;">ูู ุชุฑูุฏูู ุญุฐู ุงูุทุงูุจุฉ:</p>
        <p style="text-align: center; font-weight: 700; font-size: 1.1rem; margin-top: 0.5rem;">${student.name}</p>
      `, `
        <button class="danger" onclick="confirmDelete(${index})">๐๏ธ ุญุฐู</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    };

    window.confirmDelete = function(index) {
      studentsData.splice(index, 1);
      saveData();
      closeModal();
      showModal('ุชู ุงูุญุฐู', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุญุฐู ุงูุทุงูุจุฉ ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    };

    // ุฅุถุงูุฉ ุทุงูุจุฉ
    document.getElementById('addStudentBtn').addEventListener('click', function() {
      showModal('ุฅุถุงูุฉ ุทุงูุจุฉ ุฌุฏูุฏุฉ', `
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">ุงุณู ุงูุทุงูุจุฉ:</label>
          <input id="newStudentName" type="text" placeholder="ูุซุงู: ุณุงุฑุฉ ูุญูุฏ" style="width: 100%; padding: 10px; border: 1px solid #dfe7f1; border-radius: 8px;">
        </div>
        <div style="margin-bottom: 1rem;">
          <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">ุงููุตู:</label>
          <input id="newStudentClass" type="text" placeholder="ูุซุงู: ุซุงูุซ 1" style="width: 100%; padding: 10px; border: 1px solid #dfe7f1; border-radius: 8px;">
        </div>
      `, `
        <button onclick="saveNewStudent()">โ ุฅุถุงูุฉ</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    });

    window.saveNewStudent = function() {
      const name = document.getElementById('newStudentName').value.trim();
      const studentClass = document.getElementById('newStudentClass').value.trim();
      
      if (!name || !studentClass) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุฅุฏุฎุงู ุฌููุน ุงูุจูุงูุงุช</p>');
        return;
      }

      studentsData.push({
        name: name,
        class: studentClass,
        exams: 0,
        practical: 0,
        homework: 0,
        discussion: 0,
        teamwork: '',
        excellence: '',
        strengths: '',
        weaknesses: '',
        improvementPlan: '',
        studentStatus: '',
        parentContact: 'ูุง',
        attendance: 0
      });
      saveData();
      closeModal();
      showModal('ุชู ุงูุฅุถุงูุฉ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ๏ฟฝ๏ฟฝุถุงูุฉ ุงูุทุงูุจุฉ ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    };

    // ุจูุงูุงุช ุชุฌุฑูุจูุฉ
    document.getElementById('demoBtn').addEventListener('click', function() {
      showModal('ุชุญููู ุจู๏ฟฝ๏ฟฝูุงุช ุชุฌุฑูุจูุฉ', `
        <p style="text-align: center; margin-bottom: 1rem;">ูู ุชุฑูุฏูู ุชุญููู ุจูุงูุงุช ุชุฌุฑูุจูุฉุ</p>
        <p style="text-align: center; color: var(--danger); font-size: 0.9rem;">โ๏ธ ุณูุชู ุงุณุชุจุฏุงู ุงูุจูุงูุงุช ุงูุญุงููุฉ</p>
      `, `
        <button onclick="loadDemoData()">โ ุชุญููู</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    });

    window.loadDemoData = function() {
      studentsData = [
        { name: 'ุณุงุฑุฉ ูุญูุฏ ุนูู', class: 'ุซุงูุซ 1', exams: 18, practical: 28, homework: 29, discussion: 19, attendance: 95, excellence: 'ุชููุฒ ูู ุญู ุงููุดููุงุช', strengths: 'ุงูุงูุชุฒุงู ูุงูุงูุถุจุงุท', weaknesses: 'ุชุญุชุงุฌ ูุชุญุณูู ุงููุดุงุฑูุฉ', improvementPlan: 'ุชุฎุตูุต ููุช ุฅุถุงูู ูููุฑุงุฌุนุฉ', studentStatus: 'ูุชูููุฉ', parentContact: 'ูุนู', teamwork: 'ููุชุงุฒ' },
        { name: 'ุฑูู ุฎุงูุฏ ูุงุตุฑ', class: 'ุซุงูุซ 1', exams: 14, practical: 22, homework: 24, discussion: 15, attendance: 88, excellence: '', strengths: 'ุงููุดุงุฑูุฉ ุงููุนุงูุฉ', weaknesses: 'ุชุญุชุงุฌ ูุชูููุฉ ุงูููุงุฑุงุช ุงูุนูููุฉ', improvementPlan: 'ุฌูุณุงุช ุฏุนู ููุซูุฉ', studentStatus: 'ุฌูุฏุฉ', parentContact: 'ูุง', teamwork: 'ุฌูุฏ' },
        { name: 'ุฌูุฏ ุนูุฑ ุตุงูุญ', class: 'ุซุงูุซ 2', exams: 17, practical: 26, homework: 27, discussion: 16, attendance: 92, excellence: 'ุชูุชูู ููุงุฑุฉ ุงูุชูุฏูู ุจูุถูุญ', strengths: 'ุฅุชูุงู ุงูููุงุฑุงุช ุงูุนูููุฉ', weaknesses: '', improvementPlan: 'ุงูุญูุงุธ ุนูู ุงูุชููุฒ', studentStatus: 'ูุชูููุฉ', parentContact: 'ูุนู', teamwork: 'ุฌูุฏ ุฌุฏุงู' },
        { name: 'ููู ุนุงุฏู ููุฏ', class: 'ุซุงูุซ 2', exams: 20, practical: 30, homework: 30, discussion: 20, attendance: 98, excellence: 'ููุงุฏุฉ ูุงุถุญุฉ ูู ุงููุดุง๏ฟฝ๏ฟฝูุน', strengths: 'ุณุฑุนุฉ ุงุณุชูุนุงุจ ุงูููุงููู', weaknesses: '', improvementPlan: 'ูุดุงุฑูุน ุชุญุฏู ุฅุถุงููุฉ', studentStatus: 'ูุชูููุฉ', parentContact: 'ูุนู', teamwork: 'ููุชุงุฒ' }
      ];
      saveData();
      closeModal();
      showModal('ุชู ุงูุชุญููู', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุชุญููู ุจูุงูุงุช ุชุฌุฑูุจูุฉ</p>');
      setTimeout(closeModal, 1500);
    };

    // ูุณุญ ุงููู
    document.getElementById('clearBtn').addEventListener('click', function() {
      showModal('ุชุฃููุฏ ุงููุณุญ', `
        <p style="text-align: center; margin-bottom: 1rem;">ูู ุฃูุชู ูุชุฃูุฏุฉ ูู ูุณุญ ุฌููุน ุงูุจูุงูุงุชุ</p>
        <p style="text-align: center; color: var(--danger); font-size: 0.9rem;">โ๏ธ ู๏ฟฝ๏ฟฝ ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก</p>
      `, `
        <button class="danger" onclick="confirmClearAll()">๐๏ธ ูุณุญ ุงููู</button>
        <button class="ghost" onclick="closeModal()">ุฅูุบุงุก</button>
      `);
    });

    window.confirmClearAll = function() {
      studentsData = [];
      saveData();
      closeModal();
      showModal('ุชู ุงููุณุญ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ูุณุญ ุฌููุน ุงูุจูุงูุงุช</p>');
      setTimeout(closeModal, 1500);
    };

    // ุญูุธ ุงูุจูุงูุงุช
    document.getElementById('saveDataBtn').addEventListener('click', function() {
      saveData();
      showModal('ุชู ุงูุญูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุญูุธ ุฌููุน ุงูุจูุงูุงุช ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    });

    document.getElementById('saveAfterTableBtn').addEventListener('click', function() {
      saveData();
      showModal('ุชู ุงูุญูุธ', '<p style="text-align: center; color: #2e7d32;">โ ุชู ุญูุธ ุฌููุน ุงูุชุนุฏููุงุช ุจูุฌุงุญ</p>');
      setTimeout(closeModal, 1500);
    });

    // ุงุณุชูุฑุงุฏ Excel (ุจูุงูุงุช ุงูุทุงูุจุงุช) - ูุน ุชุตุญูุญ ุงููุฑุงุกุฉ
    document.getElementById('importExcel').addEventListener('click', function() {
      document.getElementById('excelFileInput').click();
    });

    document.getElementById('excelFileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array', cellText: false, cellDates: true });
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          
          // ูุฑุงุกุฉ ุงูุจูุงูุงุช ูุน ุชุญููู ุฌููุน ุงูููู ุฅูู ูุตูุต
          const jsonData = XLSX.utils.sheet_to_json(worksheet, { 
            defval: '',
            raw: false // ุงุณุชุฎุฏู ุงูููู ุงูููุณูุฉ ุจุฏูุงู ูู ุงูุฎุงู
          });
          
          console.log('๐ ุนุฏุฏ ุงูุตููู:', jsonData.length);
          
          if (jsonData.length === 0) {
            showModal('ุฎุทุฃ', '<p style="text-align: center; color: var(--danger);">โ ุงูููู ูุงุฑุบ ุฃู ูุง ูุญุชูู ุนูู ุจูุงูุงุช</p>');
            return;
          }
          
          console.log('๐ ุงูุฃุน๏ฟฝ๏ฟฝุฏุฉ ุงููุชููุฑุฉ:', Object.keys(jsonData[0]));
          console.log('๐ ุฃูู ุตู:', jsonData[0]);
          
          const imported = [];
          const errors = [];
          
          // ุฏุงูุฉ ูุณุงุนุฏุฉ ููุจุญุซ ุนู ูููุฉ ุงูุนููุฏ ูุน ูุนุงูุฌุฉ ุฃูุถู
          const getColumnValue = (row, ...possibleNames) => {
            for (const name of possibleNames) {
              const value = row[name];
              if (value !== undefined && value !== null && value !== '') {
                const strValue = String(value).trim();
                if (strValue && strValue !== 'undefined' && strValue !== 'null') {
                  return strValue;
                }
              }
            }
            return '';
          };
          
          jsonData.forEach((row, index) => {
            const rowNumber = index + 2;
            
            // ุงูุจุญุซ ุนู ุงูุงุณู ุจุฌููุน ุงูุฃุดูุงู ุงูููููุฉ
            const studentName = getColumnValue(row, 
              'ุงูุงุณู', 'ุงุณู', 'ุงูุฃุณู', 'name', 'Name', 'NAME',
              'ุงุณู ุงูุทุงูุจุฉ', 'ุงูุทุงูุจุฉ', 'Student', 'Student Name'
            );
            
            // ุงูุจุญุซ ุนู ุงููุตู ุจุฌููุน ุงูุฃุดูุงู ุงูููููุฉ
            const studentClass = getColumnValue(row, 
              'ุงููุตู', 'ูุตู', 'class', 'Class', 'CLASS',
              'ุงูุตู', 'ุตู', 'Grade', 'grade'
            );
            
            console.log(`ุงูุตู ${rowNumber}: ุงูุงุณู="${studentName}", ุงููุตู="${studentClass}"`);
            
            if (!studentName || !studentClass) {
              const missingFields = [];
              if (!studentName) missingFields.push('ุงูุงุณู');
              if (!studentClass) missingFields.push('ุงููุตู');
              errors.push(`ุงูุตู ${rowNumber}: ${missingFields.join(' ู ')} ููููุฏ/ููููุฏุฉ`);
              return;
            }
            
            const student = {
              name: studentName,
              class: studentClass,
              exams: parseInt(getColumnValue(row, 'ุงูุงุฎุชุจุงุฑุงุช', 'exams', 'Exams', 'ุงุฎุชุจุงุฑุงุช', 'ุงูุงุฎุชุจุงุฑ', 'test', 'Test')) || 0,
              practical: parseInt(getColumnValue(row, 'ุงูุนููู', 'practical', 'Practical', 'ุนููู', 'ุงูุชูููู ุงูุนููู', 'ุงูุนูููุฉ')) || 0,
              homework: parseInt(getColumnValue(row, 'ุงู๏ฟฝ๏ฟฝุง๏ฟฝ๏ฟฝุจุงุช', 'homework', 'Homework', 'ูุงุฌุจุงุช', 'ุงููุงุฌุจ', 'assignments')) || 0,
              discussion: parseInt(getColumnValue(row, 'ุงููู๏ฟฝ๏ฟฝูุดุงุช', 'discussion', 'Discussion', 'ููุงูุดุงุช', 'ุงูุชูุงุนู ุงูุตูู', 'ุงูุชูุงุนู', 'ุงูููุงูุดุฉ')) || 0,
              teamwork: getColumnValue(row, 'ุงูุชุนุงูู', 'teamwork', 'Teamwork', 'ุชุนุงูู', 'ุงูุนูู ุงูุฌูุงุนู', 'Collaboration'),
              excellence: getColumnValue(row, 'ููุงุท ุงูุชููุฒ', 'excellence', 'Excellence', 'ุชููุฒ', 'ุงูุชููุฒ', 'Excellence Points'),
              strengths: getColumnValue(row, 'ููุงุท ุงูููุฉ', 'strengths', 'Strengths', 'ููุฉ', 'ุงูููุฉ', 'Strong Points'),
              weaknesses: getColumnValue(row, 'ููุงุท ุงูุถุนู', 'weaknesses', 'Weaknesses', 'ุถุนู', 'ุงูุถุนู', 'Weak Points'),
              improvementPlan: getColumnValue(row, 'ุฎุทุฉ ุฑูุน ุงููุณุชูู', 'improvementPlan', 'plan', 'Plan', 'ุฎุทุฉ', 'ุงูุฎุทุฉ ๏ฟฝ๏ฟฝูุนูุงุฌูุฉ', 'ุงูุฎุทุฉ', 'Improvement Plan'),
              studentStatus: getColumnValue(row, 'ุญุงูุฉ ุงูุทุงูุจุฉ', 'studentStatus', 'status', 'Status', 'ุญุงูุฉ', 'ุงูุญุงูุฉ', 'Student Status'),
              parentContact: getColumnValue(row, 'ุชูุงุตู ููู ุงูุฃูุฑ', 'parentContact', 'contact', 'Contact', 'ุชูุงุตู', 'ุงูุชูุงุตู', 'Parent Contact') || 'ูุง',
              attendance: parseInt(getColumnValue(row, 'ุงูุญุถูุฑ', 'attendance', 'Attendance', 'ุญุถูุฑ', 'ุงูุญุถูุฑ', 'Present Days')) || 0
            };
            
            imported.push(student);
          });
          
          console.log('โ ุนุฏุฏ ุงูุทุงูุจุงุช ุงููุณุชูุฑุฏุฉ:', imported.length);
          console.log('โ๏ธ ุนุฏุฏ ุงูุฃุฎุทุงุก:', errors.length);
          
          if (imported.length === 0) {
            let errorMessage = '<div style="text-align: center;">';
            errorMessage += '<p style="color: var(--danger); font-size: 1.2rem; margin-bottom: 1.5rem;"><strong>๏ฟฝ๏ฟฝ๏ฟฝ ูู ูุชู ุงูุนุซูุฑ ุนูู ุจูุงูุงุช ุตุงูุญุฉ</strong></p>';
            
            errorMessage += '<div style="background: #fff3e0; padding: 1.25rem; border-radius: 10px; margin-bottom: 1.25rem; text-align: right;">';
            errorMessage += '<p style="font-weight: 700; margin-bottom: 0.75rem; color: #e65100;">๐ ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ:</p>';
            errorMessage += '<ul style="list-style: none; padding: 0; line-height: 2;">';
            errorMessage += '<li>โ ุนููุฏ "ุงูุงุณู" ุฃู "name"</li>';
            errorMessage += '<li>โ ุนููุฏ "ุงููุตู" ุฃู "class"</li>';
            errorMessage += '</ul>';
            errorMessage += '</div>';
            
            if (jsonData.length > 0) {
              errorMessage += '<div style="background: #e3f2fd; padding: 1.25rem; border-radius: 10px; margin-bottom: 1.25rem; text-align: right;">';
              errorMessage += '<p style="font-weight: 700; margin-bottom: 0.75rem; color: #1976d2;">๐ ุงูุฃุนูุฏุฉ ูู ูููู:</p>';
              errorMessage += '<div style="background: white; padding: 0.75rem; border-radius: 6px; font-size: 0.9rem; direction: ltr; text-align: left; font-family: monospace; max-height: 150px; overflow-y: auto;">';
              errorMessage += Object.keys(jsonData[0]).map(k => `"${k}"`).join(', ');
              errorMessage += '</div>';
              errorMessage += '</div>';
            }
            
            if (errors.length > 0) {
              errorMessage += '<div style="background: #ffebee; padding: 1.25rem; border-radius: 10px; text-align: right;">';
              errorMessage += '<p style="font-weight: 700; margin-bottom: 0.75rem; color: #c62828;">โ๏ธ ุงูุฃุฎุทุงุก:</p>';
              errorMessage += '<div style="max-height: 150px; overflow-y: auto; font-size: 0.9rem; line-height: 1.8;">';
              errorMessage += errors.map(e => `โข ${e}`).join('<br>');
              errorMessage += '</div></div>';
            }
            
            errorMessage += '</div>';
            
            showModal('ูุดู ุงุณุชูุฑุงุฏ ุงูููู', errorMessage);
            return;
          }
          
          studentsData = imported;
          saveData();
          
          let successMessage = `
            <div style="text-align: center; padding: 1.5rem;">
              <div style="font-size: 4rem; margin-bottom: 1.5rem;">๐</div>
              <p style="font-size: 1.4rem; color: #2e7d32; font-weight: 700; margin-bottom: 0.75rem;">ุชู ุงูุงุณุชูุฑุงุฏ ุจูุฌุงุญ!</p>
              <div style="background: #e8f5e9; padding: 1rem; border-radius: 10px; margin-top: 1rem;">
                <p style="font-size: 1.2rem; color: #2e7d32; font-weight: 600;">โ ุงุณุชูุฑุงุฏ ${imported.length} ุทุงูุจุฉ</p>
              </div>
          `;
          
          if (errors.length > 0) {
            successMessage += `
              <div style="background: #fff3e0; padding: 1rem; border-radius: 10px; margin-top: 1rem;">
                <p style="font-size: 0.95rem; color: #e65100;">โ๏ธ ุชู ุชุฌุงูู ${errors.length} ุตู (ุจูุงูุงุช ูุงูุตุฉ)</p>
              </div>
            `;
          }
          
          successMessage += '</div>';
          
          showModal('ูุฌุญ ุงูุงุณุชูุฑุงุฏ! ๐', successMessage);
          setTimeout(closeModal, 3500);
          
        } catch (error) {
          console.error('โ ุฎ๏ฟฝ๏ฟฝุฃ:', error);
          showModal('ุฎุทุฃ ูู ุงู๏ฟฝ๏ฟฝุฑุงุกุฉ', `
            <div style="text-align: center; padding: 1rem;">
              <p style="color: var(--danger); font-size: 1.1rem; margin-bottom: 1rem;">โ ๏ฟฝ๏ฟฝุฏุซ ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู</p>
              <div style="background: #ffebee; padding: 1rem; border-radius: 10px; text-align: right;">
                <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 0.5rem;"><strong>ุชูุงุตูู ุงูุฎุทุฃ:</strong></p>
                <p style="font-size: 0.85rem; font-family: monospace; background: white; padding: 0.5rem; border-radius: 4px;">${error.message}</p>
                <p style="font-size: 0.85rem; margin-top: 0.75rem; color: #666;">ุชุฃูุฏู ูู ุฃู ุงูููู ุจุตูุบุฉ Excel ุตุญูุญุฉ (.xlsx)</p>
              </div>
            </div>
          `);
        }
      };
      reader.readAsArrayBuffer(file);
      e.target.value = '';
    });

    // ุงุณุชูุฑุงุฏ ุฎุทุท Excel
    document.getElementById('importPlansExcel').addEventListener('click', function() {
      document.getElementById('plansExcelFileInput').click();
    });

    document.getElementById('plansExcelFileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          const jsonData = XLSX.utils.sheet_to_json(worksheet);
          
          if (jsonData.length === 0) {
            showModal('ุฎุทุฃ', '<p style="text-align: center; color: var(--danger);">ููู Excel ูุงุฑุบ ุฃู ุจุตูุบุฉ ุบูุฑ ุตุญูุญุฉ</p>');
            return;
          }
          
          let updatedCount = 0;
          jsonData.forEach(row => {
            const studentName = row['ุง๏ฟฝ๏ฟฝุงุณู'] || row['name'] || '';
            const improvementPlan = row['ุฎุทุฉ ุฑูุน ุงููุณุชูู'] || row['ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ'] || row['improvementPlan'] || row['plan'] || '';
            
            if (studentName && improvementPlan) {
              const studentIndex = studentsData.findIndex(s => s.name === studentName);
              if (studentIndex !== -1) {
                studentsData[studentIndex].improvementPlan = improvementPlan;
                updatedCount++;
              }
            }
          });
          
          if (updatedCount === 0) {
            showModal('ุชูุจูู', '<p style="text-align: center;">ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃุณูุงุก ูุทุงุจูุฉ.<br>ุชุฃูุฏู ูู ุฃู ุฃุณูุงุก ุงูุทุงูุจุงุช ูู ููู ุงูุฎุทุท ูุทุงุจูุฉ ููุฃุณูุงุก ูู ุงููุธุงู</p>');
            return;
          }
          
          saveData();
          showModal('ุชู ุชุญ๏ฟฝ๏ฟฝูุซ ุงูุฎุทุท ุจูุฌุงุญ! ๐', `
            <div style="text-align: center; padding: 1rem;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">โ</div>
              <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600;">ุชู ุชุญุฏูุซ ๏ฟฝ๏ฟฝูุฎุทุท ุงูุนูุงุฌูุฉ ูู ${updatedCount} ุทุงูุจุฉ!</p>
            </div>
          `);
          setTimeout(closeModal, 2000);
          
        } catch (error) {
          showModal('ุฎุทุฃ', '<p style="text-align: center; color: var(--danger);">ุญุฏุซ ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู. ุชุฃูุฏู ูู ุตูุบุฉ ุงูููู</p>');
        }
      };
      reader.readAsArrayBuffer(file);
      e.target.value = '';
    });

    document.getElementById('importCSV').addEventListener('click', function() {
      showModal('ุงุณุชูุฑุงุฏ CSV', '<p style="text-align: center;">๏ฟฝ๏ฟฝุธููุฉ ุงุณุชูุฑุงุฏ CSV ููุฏ ุงูุชุทููุฑ</p>');
    });

    document.getElementById('exportExcel').addEventListener('click', function() {
      showModal('ุชุตุฏูุฑ Excel', '<p style="text-align: center;">ูุธููุฉ ุชุตุฏูุฑ Excel ููุฏ ุงูุชุทููุฑ</p>');
    });

    document.getElementById('clearFilter').addEventListener('click', function() {
      renderTable();
      showModal('ุชู ุฅูุบุงุก ุงูููุชุฑ', '<p style="text-align: center;">ุชู ุนุฑุถ ุฌููุน ุงูุทุงูุจุงุช</p>');
      setTimeout(closeModal, 1500);
    });

    document.getElementById('printSummary').addEventListener('click', function() {
      showModal('ุทุจุงุนุฉ ูุฎ๏ฟฝ๏ฟฝุตุฑุฉ', '<p style="text-align: center;">ูุธููุฉ ุงูุทุจุงุนุฉ ููุฏ ุงูุชุทููุฑ</p>');
    });

    // ุฏุงูุฉ ุงูุชูุงุตู ูุน ุงููุนููุฉ ุนุจุฑ ูุงุชุณุง๏ฟฝ๏ฟฝ
    window.contactTeacherWhatsApp = function() {
      const phoneNumber = "966555320501";
      const studentName = document.getElementById('sName').textContent;
      const message = `ุงูุณูุงู ุนูููู ูุนููุชู ุงููุงุถูุฉ ๐ธ\n\nุฃูุง ุงูุทุงูุจุฉ: ${studentName}\nุฃุฑุบุจ ูู ุงูุชูุงุตู ูุนู ุจุฎุตูุต ูุงุฏุฉ ุงูุชูููุฉ ุงูุฑูููุฉ.\n\nุดูุฑุงู ูู ๐`;
      const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank', 'noopener,noreferrer');
    };

    // ุฏุงูุฉ ุฅุฑุณุงู ุงูุงุณุชุจูุงู - ุงูุทุงูุจุฉ
    /*
    document.getElementById('submitSurvey').addEventListener('click', function() {
      const trait = document.getElementById('studentTrait').value;
      const skill = document.getElementById('studentSkill').value.trim();
      const strategy = document.getElementById('learningStrategy').value.trim();
      const hasAdditional = document.getElementById('hasAdditionalMethod').value;
      const additionalMethod = document.getElementById('additionalMethod').value.trim();
      const informParent = document.getElementById('informParent').value;
      const satisfaction = document.getElementById('satisfactionLevel').value;
      
      if (!trait || !skill || !hasAdditional || !informParent || !satisfaction) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุฅููุงู ุฌููุน ุงูุญููู ุงููุทููุจุฉ</p>');
        return;
      }
      
      if (hasAdditional === 'ูุนู' && !additionalMethod) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ูุชุงุจุฉ ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ</p>');
        return;
      }
      
      showModal('ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ! ๐', `
        <div style="text-align: center; padding: 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">โ</div>
          <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600; margin-bottom: 1rem;">ุดูุฑุงู ููุดุงุฑูุชู!</p>
          <p style="color: var(--muted); line-height: 1.6;">ุชู ุฅุฑุณุงู ุงูุงุณุชุจูุงู ุจูุฌุงุญ.</p>
        </div>
      `);
      
      // ุฅุนุงุฏุฉ ุชุนููู ุงููููุฐุฌ
      document.getElementById('studentTrait').value = '';
      document.getElementById('studentSkill').value = '';
      document.getElementById('learningStrategy').value = '';
      document.getElementById('hasAdditionalMethod').value = '';
      document.getElementById('additionalMethod').value = '';
      document.getElementById('informParent').value = '';
      document.getElementById('satisfactionLevel').value = '';
      document.getElementById('additionalMethodContainer').style.display = 'none';
    });
*/
   /* // ุฏุงูุฉ ุฅุฑุณุงู ุงูุงุณุชุจูุงู - ููู ุงูุฃูุฑ
    document.getElementById('submitParentSurvey').addEventListener('click', function() {
      const strategy = document.getElementById('parentLearningStrategy').value.trim();
      const hasAdditional = document.getElementById('parentHasAdditionalMethod').value;
      const additionalMethod = document.getElementById('parentAdditionalMethod').value.trim();
      const informParent = document.getElementById('parentInformParent').value;
      const satisfaction = document.getElementById('parentSatisfactionLevel').value;
      
      if (!hasAdditional || !informParent || !satisfaction) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ุฅููุงู ุฌููุน ุงูุญููู ุงููุทููุจุฉ</p>');
        return;
      }
      
      if (hasAdditional === 'ูุนู' && !additionalMethod) {
        showModal('ุชูุจูู', '<p style="text-align: center;">ูุฑุฌู ูุชุงุจุฉ ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ</p>');
        return;
      }
      
      showModal('ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ! ๐', `
        <div style="text-align: center; padding: 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">โ</div>
          <p style="font-size: 1.1rem; color: #2e7d32; font-weight: 600; margin-bottom: 1rem;">ุดูุฑุงู ููุดุงุฑูุชูู!</p>
          <p style="color: var(--muted); line-height: 1.6;">ุชู ุฅุฑุณุงู ุงูุงุณุชุจูุงู ุจูุฌุงุญ.</p>
        </div>
      `);
      
      // ุฅุนุงุฏุฉ ุชุนููู ุงููููุฐุฌ
      document.getElementById('parentLearningStrategy').value = '';
      document.getElementById('parentHasAdditionalMethod').value = '';
      document.getElementById('parentAdditionalMethod').value = '';
      document.getElementById('parentInformParent').value = '';
      document.getElementById('parentSatisfactionLevel').value = '';
      document.getElementById('parentAdditionalMethodContainer').style.display = 'none';
    });*/

    // ุฏุงูุฉ ุนุฑุถ ุชูุฑูุฑ ุงูุทุงูุจุฉ
    function displayStudentReport(student) {
      const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
      const percentage = total;
      
      document.getElementById('sName').textContent = student.name;
      document.getElementById('sClass').textContent = student.class;
      document.getElementById('sTotal').textContent = total;
      document.getElementById('sProgress').style.width = percentage + '%';
      
      // ุนุฑุถ ุชูููู ุงููุนููุฉ
      document.getElementById('sExcellence').textContent = student.excellence || 'ูู ูุชู ุงูุชูููู ุจุนุฏ';
      document.getElementById('sStrengths').textContent = student.strengths || 'ูู ูุชู ุงูุชูููู ุจุนุฏ';
      document.getElementById('sWeaknesses').textContent = student.weaknesses || 'ูู ูุชู ุงูุชูููู ุจุนุฏ';
      document.getElementById('sImprovementPlan').textContent = student.improvementPlan || 'ูู ูุชู ูุถุน ุฎุทุฉ ุจุนุฏ';
      
      // ุนุฑุถ ุงูุชูุงุตูู
      const detailsHTML = `
        <div style="display: grid; gap: 0.75rem;">
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #7cc4ad;">
            <span>ุงูุงุฎุชุจุงุฑุงุช</span>
            <strong>${student.exams || 0} / 20</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #9cc6e0;">
            <span>ุงูุนููู</span>
            <strong>${student.practical || 0} / 30</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #b7c3d0;">
            <span>ุงููุงุฌุจุงุช</span>
            <strong>${student.homework || 0} / 30</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #7cc4ad;">
            <span>ุงูููุงูุดุงุช</span>
            <strong>${student.discussion || 0} / 20</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #64b5f6;">
            <span>ุงูุชุนุงูู ูุน ุงููุฌููุนุฉ</span>
            <strong>${student.teamwork || 'ูู ูุชู ุงูุชูููู'}</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #ba68c8;">
            <span>ุญุงูุฉ ุงูุทุงูุจุฉ</span>
            <strong>${student.studentStatus || 'ูู ูุชู ุงูุชุญุฏูุฏ'}</strong>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; border-right: 4px solid #ffd89b;">
            <span>ุนุฏุฏ ุฃูุงู ุงูุญุถูุฑ</span>
            <strong>${student.attendance || 0} ููู</strong>
          </div>
        </div>
      `;
      document.getElementById('sDetails').innerHTML = detailsHTML;
      
      // ุฑุณู ุงููุฎุทุท ุงูุจูุงูู
      const ctx = document.getElementById('studentChart').getContext('2d');
      
      const examsPercent = ((student.exams || 0) / 20) * 100;
      const practicalPercent = ((student.practical || 0) / 30) * 100;
      const homeworkPercent = ((student.homework || 0) / 30) * 100;
      const discussionPercent = ((student.discussion || 0) / 20) * 100;
      
      const needsSupport = examsPercent < 75 || practicalPercent < 75 || homeworkPercent < 75 || discussionPercent < 75;
      document.getElementById('needsSupportWarning').style.display = needsSupport ? 'block' : 'none';
      
      if (window.studentChartInstance) {
        window.studentChartInstance.destroy();
      }
      
      window.studentChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['ุงูุงุฎุชุจุงุฑุงุช', 'ุงูุชูููู ุงูุนููู', 'ุงููุงุฌุจุงุช', 'ุงูุช๏ฟฝ๏ฟฝุงุนู ุงูุตูู'],
          datasets: [{
            label: 'ุงููุณุจุฉ ุงููุฆููุฉ (%)',
            data: [examsPercent, practicalPercent, homeworkPercent, discussionPercent],
            backgroundColor: [
              examsPercent >= 75 ? '#66bb6a' : '#ef5350',
              practicalPercent >= 75 ? '#42a5f5' : '#ef5350',
              homeworkPercent >= 75 ? '#ab47bc' : '#ef5350',
              discussionPercent >= 75 ? '#ffa726' : '#ef5350'
            ],
            borderColor: [
              examsPercent >= 75 ? '#4caf50' : '#f44336',
              practicalPercent >= 75 ? '#2196f3' : '#f44336',
              homeworkPercent >= 75 ? '#9c27b0' : '#f44336',
              discussionPercent >= 75 ? '#ff9800' : '#f44336'
            ],
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                font: { family: 'Tajawal', size: 13 },
                padding: 15,
                usePointStyle: true
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                font: { family: 'Tajawal', size: 12 },
                callback: function(value) { return value + '%'; }
              }
            },
            x: {
              ticks: { font: { family: 'Tajawal', size: 12 } }
            }
          }
        }
      });
      
      let tip = 'ุงุณุชูุฑู ูู ุจุฐู ุงูุฌูุฏ ูุณุชุญูููู ู๏ฟฝ๏ฟฝุงุฆุฌ ุฑุงุฆุนุฉ! ๐';
      if (total >= 90) {
        tip = 'ุฃุฏุงุก ููุชุงุฒ! ุงุณุชูุฑู ูู ุงูุชููุฒ ูุงูุญูุงุธ ุนูู ูุฐุง ุงููุณุชูู ุงูุฑุงุฆุน! ๐';
      } else if (total >= 75) {
        tip = 'ุฃุฏุงุก ุฌูุฏ ุฌุฏุงู! ุฑูุฒู ุนูู ุงูุฌูุงูุจ ุงูุชู ุชุญุชุงุฌ ุชุญุณูู ูุชุตูู ููุชููุฒ ๏ฟฝ๏ฟฝ๏ฟฝ';
      } else if (total >= 60) {
        tip = 'ุฃุฏุงุก ุฌูุฏ! ููููู ุชุญุณูู ูุณุชูุงู ุจูุฒูุฏ ูู ุงููุฑุงุฌุนุฉ ูุงูููุงุฑุณุฉ ๐';
      } else {
        tip = 'ูุง ุชุณุชุณููู! ุงุทูุจู ูุณุงุนุฏุฉ ุงููุนููุฉ ูุฎุตุตู ููุชุงู ุฃูุจุฑ ููุฏุฑุงุณุฉ ๐ก';
      }
      document.getElementById('sTip').textContent = tip;
    }

    // ุฏุงูุฉ ุนุฑุถ ุชูุฑูุฑ ููู ุงูุฃูุฑ
    function displayParentReport(student) {
      const total = (student.exams || 0) + (student.practical || 0) + (student.homework || 0) + (student.discussion || 0);
      
      document.getElementById('pName').textContent = student.name;
      document.getElementById('pClass').textContent = student.class;
      
      let tip = 'ูุดุฌุนูู ุนูู ูุชุงุจุนุฉ ุงุจูุชูู ูุฏุนููุง ูู ูุณูุฑุชูุง ุงูุชุนููููุฉ! ๐';
      if (total >= 90) {
        tip = 'ุงุจูุชูู ูุชูููุฉ! ุงุณุชูุฑูุง ูู ุชุดุฌูุนูุง ูุงูุงุญุชูุงุก ุจุฅูุฌุงุฒุงุชูุง ๐';
      } else if (total >= 75) {
        tip = 'ุฃุฏุงุก ููุชุงุฒ! ููุตุญ ุจุงูุชูุงุตู ุงููุณุชูุฑ ูุน ุงููุนููุฉ ููุชุงุจุนุฉ ุงูุชุทูุฑ ๐ช';
      } else if (total >= 60) {
        tip = 'ุงุจูุชูู ุจุญุงุฌุฉ ููุฒูุฏ ูู ุงูุฏุนู ูุงููุชุงุจุนุฉ ุงูููุฒููุฉ. ููุตุญ ุจุชุฎุตูุต ููุช ูููู ูููุฑุงุฌุนุฉ ๐';
      } else {
        tip = 'ููุตุญ ุจุงูุชูุงุตู ุงูููุฑู ูุน ุงููุนููุฉ ููุถุน ุฎุทุฉ ุฏุนู ููุซูุฉ ูุน ูุชุงุจุนุฉ ููููุฉ ๐';
      }
      
      const summaryHTML = `
        <div style="display: grid; gap: 1rem;">
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <div>
              <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 0.25rem;">๏ฟฝ๏ฟฝููุฌููุน ุงูููู</p>
              <p style="font-size: 1.75rem; font-weight: 700; color: var(--brand);">${total} / 100</p>
            </div>
            <div style="font-size: 2.5rem;">๐</div>
          </div>
          
          <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 1rem;">ุชูุฒูุน ุงูุฏุฑุฌุงุช</p>
            <div style="display: grid; gap: 0.5rem;">
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>ุงูุงุฎุชุจุงุฑุงุช (20)</span>
                <strong style="color: var(--brand);">${student.exams || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>ุงูุนููู (30)</span>
                <strong style="color: var(--brand);">${student.practical || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>ุงููุงุฌุจุงุช (30)</span>
                <strong style="color: var(--brand);">${student.homework || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border-radius: 6px;">
                <span>ุงูููุงูุดุงุช (20)</span>
                <strong style="color: var(--brand);">${student.discussion || 0}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #e3f2fd; border-radius: 6px;">
                <span>ุงูุชุนุงูู ูุน ุงููุฌููุนุฉ</span>
                <strong style="color: #1976d2;">${student.teamwork || 'ู๏ฟฝ๏ฟฝ ูุชู ุงูุชูููู'}</strong>
              </div>
              <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f3e5f5; border-radius: 6px;">
                <span>ุญุงูุฉ ุงูุทุงูุจุฉ</span>
                <strong style="color: #7b1fa2;">${student.studentStatus || 'ูู ูุชู ุงูุชุญุฏูุฏ'}</strong>
              </div>
            </div>
          </div>
          
          <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 0.25rem;">ุนุฏุฏ ุฃูุงู ุงูุญุถูุฑ</p>
                <p style="font-size: 1.5rem; font-weight: 700; color: #2e7d32;">${student.attendance || 0} ููู</p>
              </div>
              <div style="font-size: 2rem;">โ</div>
            </div>
          </div>
          
          <div style="background: ${student.parentContact === 'ูุนู' ? '#e8f5e9' : '#fff3e0'}; padding: 1rem; border-radius: 10px; border: 2px solid ${student.parentContact === 'ูุนู' ? '#81c784' : '#ffb74d'};">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 0.25rem;">ุญุงูุฉ ุงูุชูุงุตู ูุน ุงููุนููุฉ</p>
                <p style="font-size: 1.25rem; font-weight: 700; color: ${student.parentContact === 'ูุนู' ? '#2e7d32' : '#f57c00'};">${student.parentContact === 'ูุนู' ? 'ุชู ุงูุชูุงุตู โ' : 'ูู ูุชู ุงูุชูุงุตู ุจุนุฏ'}</p>
              </div>
              <div style="font-size: 2rem;">${student.parentContact === 'ูุนู' ? '๐' : '๐'}</div>
            </div>
          </div>
          
          <div style="background: linear-gradient(135deg, #f3e5f5, #fce4ec); padding: 1rem; border-radius: 10px; border: 2px solid #ce93d8;">
            <h5 style="color: #8e24aa; margin-bottom: 0.75rem; font-size: 1rem;">๐ ุชูููู ุงููุนููุฉ</h5>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem; border-right: 4px solid #66bb6a;">
              <p style="font-weight: 600; color: #2e7d32; font-size: 0.85rem; margin-bottom: 0.25rem;">โจ ููุงุท ุงูุชููุฒ</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.excellence || 'ูู ูุชู ุงูุชูููู ุจุนุฏ'}</p>
            </div>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem; border-right: 4px solid #42a5f5;">
              <p style="font-weight: 600; color: #1565c0; font-size: 0.85rem; margin-bottom: 0.25rem;">๐ช ููุงุท ุงูููุฉ</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.strengths || 'ูู ูุชู ุงูุชูููู ุจุนุฏ'}</p>
            </div>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; margin-bottom: 0.5rem; border-right: 4px solid #ff7043;">
              <p style="font-weight: 600; color: #d84315; font-size: 0.85rem; margin-bottom: 0.25rem;">๐ ููุงุท ุงูุถุนู</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.weaknesses || 'ูู ูุชู ุงูุชูููู ุจุนุฏ'}</p>
            </div>
            
            <div style="background: white; padding: 0.75rem; border-radius: 8px; border-right: 4px solid #9c27b0;">
              <p style="font-weight: 600; color: #6a1b9a; font-size: 0.85rem; margin-bottom: 0.25rem;">๐ฏ ุงู๏ฟฝ๏ฟฝุทุฉ ุงูุนูุงุฌูุฉ</p>
              <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${student.improvementPlan || 'ูู ูุชู ูุถุน ุฎุทุฉ ุจุนุฏ'}</p>
            </div>
          </div>
          
          <div style="background: #fef5e7; padding: 1rem; border-radius: 10px; border: 2px solid #ffd89b;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <div style="font-size: 1.5rem;">๐ก</div>
              <div>
                <p style="font-weight: 600; color: #d68910; font-size: 0.9rem; margin-bottom: 0.25rem;">ู๏ฟฝ๏ฟฝูุญุฉ ูููู ุงูุฃูุฑ</p>
                <p style="color: var(--text); font-size: 0.9rem; line-height: 1.5;">${tip}</p>
              </div>
            </div>
          </div>
        </div>
      `;
      document.getElementById('pSummary').innerHTML = summaryHTML;
    }

    // ุชุญููู ุงูุฌุฏูู ุนูุฏ ุงูุฏุฎูู
    renderTable();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9abb21708455cdf8',t:'MTc2NTM1MjgwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();
   /*
     // =================================================================
// 1. ุฏุงูุฉ ุฅุฑุณุงู ุงุณุชุจูุงู ุงูุทุงูุจุฉ ุนุจุฑ ูุงุชุณุงุจ
// =================================================================
window.sendStudentSurveyViaWhatsApp = function() {
    const teacherPhoneNumber = "966555320501"; // โ๏ธ ูุฑุฌู ุชุบููุฑ ูุฐุง ุงูุฑูู ุจุฑูู ุงููุนููุฉ ุงูุตุญูุญ โ๏ธ

    // 1. ุฌูุน ูุนูููุงุช ุงูุทุงูุจุฉ
    const studentName = document.getElementById('sName').textContent.trim();
    const studentID = document.getElementById('sID') ? document.getElementById('sID').textContent.trim() : 'ุบูุฑ ูุชููุฑ';

    // 2. ุชุญุฏูุฏ ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู (ูุฌุจ ูุทุงุจูุชูุง ูุฃุณูุงุก ุงููุฏุฎูุงุช ูุฏูู: q1, q2, q3...)
    const studentQuestions = [
        { name: 'q1', text: '1. ูุฏู ุชูุงุนู ุงูุทุงูุจุฉ ูุน ุงููุงุฏุฉ' },
        { name: 'q2', text: '2. ููู ุงูููุถูุนุงุช ุงูุตุนุจุฉ' },
        { name: 'q3', text: '3. ูุฏู ุงูุงุณุชูุงุฏุฉ ูู ุงูุฃูุดุทุฉ ุงูุฅุซุฑุงุฆูุฉ' },
        { name: 'q4', text: '4. ุชูููู ุจูุฆุฉ ุงูุชุนูู ุงูุฑูููุฉ' }
    ];

    let surveyAnswers = [];
    let allAnswered = true;

   /* // ุฌูุน ุงูุฅุฌุงุจุงุช
    studentQuestions.forEach(q => {
        const selectedRadio = document.querySelector(`input[name="${q.name}"]:checked`);
        
        if (selectedRadio) {
            const answerValue = selectedRadio.value || 'ุฎูุงุฑ ูุญุฏุฏ'; 
            surveyAnswers.push(`${q.text}:\n   - ุงูุฅุฌุงุจุฉ: ${answerValue}`);
        } else {
            allAnswered = false;
        }
    });
    // ...
    // ุฌูุน ุงูุฅุฌุงุจุงุช
    studentQuestions.forEach(q => {
        // ูุณุชุฎุฏู document.querySelector ููุจุญุซ ุนู ุงูุฎูุงุฑ ุงููุญุฏุฏ ุจุงูุงุณู ุงูุตุญูุญ
        const selectedRadio = document.querySelector(`input[name="${q.name}"]:checked`);
        
        // ุงูุชุญูู ูู ูุฌูุฏ ุฅุฌุงุจุฉ ูุญุฏุฏุฉ
        if (selectedRadio) {
            // ูุฑุงุกุฉ ุงููููุฉ ูุจุงุดุฑุฉ ูู ุงูุญูู ุงููุญุฏุฏ
            const answerValue = selectedRadio.value.trim() || 'ุชู ุงูุชุญุฏูุฏ'; 
            surveyAnswers.push(`${q.text}:\n   - ุงูุฅุฌุงุจุฉ: ${answerValue}`);
        } else {
            // ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ ุฎูุงุฑ ููุฐุง ุงูุณุคุงูุ ุชุนุชุจุฑ ุงูุฅุฌุงุจุงุช ุบูุฑ ููุชููุฉ
            allAnswered = false;
        }
    });


    if (!allAnswered) {
        alert("ุงูุฑุฌุงุก ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุฃุณุฆูุฉ ุงุณุชุจูุงู ุงูุทุงูุจุฉ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

    // 3. ุชูุณูู ุงูุฑุณุงูุฉ
    const messageHeader = `*๐ ุงุณุชุจูุงู ุงูุทุงูุจุฉ*\n`;
    const info = `ุงูุทุงูุจุฉ: ${studentName}\nุงูุฑูู ุงูุฃูุงุฏููู: ${studentID}\n\n`;
    const answersText = surveyAnswers.join('\n');
    
    const fullMessage = messageHeader + info + "--- ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ---\n" + answersText;

    // 4. ุจูุงุก ููุชุญ ุฑุงุจุท ูุงุชุณุงุจ
    const whatsappURL = `https://wa.me/${teacherPhoneNumber}?text=${encodeURIComponent(fullMessage)}`;
    window.open(whatsappURL, '_blank', 'noopener,noreferrer');
};

/*
// =================================================================
// 2. ุฏุงูุฉ ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ ุนุจุฑ ูุงุชุณุงุจ
// =================================================================
window.sendParentSurveyViaWhatsApp = function() {
    const teacherPhoneNumber = "966555320501"; // โ๏ธ ูุฑุฌู ุชุบููุฑ ูุฐุง ุงูุฑูู ุจุฑูู ุงููุนููุฉ ุงูุตุญูุญ โ๏ธ

    // 1. ุฌูุน ูุนูููุงุช ุงูุทุงูุจุฉ (ููุณูุงู)
    const studentName = document.getElementById('sName').textContent.trim();

    // 2. ุชุญุฏูุฏ ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู (ูุฌุจ ูุทุงุจูุชูุง ูุฃุณูุงุก ุงููุฏุฎูุงุช ูุฏูู: pq1, pq2, pq3...)
    const parentQuestions = [
        { name: 'pq1', text: '1. ูุฏู ุฑุถุง ููู ุงูุฃูุฑ ุนู ุงูุฃุฏุงุก' },
        { name: 'pq2', text: '2. ุณูููุฉ ุงููุตูู ุฅูู ุชูุงุฑูุฑ ุงูุฃุฏุงุก' },
        { name: 'pq3', text: '3. ูุนุงููุฉ ุชูุงุตู ุงููุนููุฉ' },
        { name: 'pq4', text: '4. ูุงุฆุฏุฉ ุงูููุตุฉ ููุชุงุจุนุฉ ุงูุทุงูุจุฉ' }
    ];
    
    let surveyAnswers = [];
    let allAnswered = true;
    
    // ุฌูุน ุงูุฅุฌุงุจุงุช
    parentQuestions.forEach(q => {
        const selectedRadio = document.querySelector(`input[name="${q.name}"]:checked`);
        
        if (selectedRadio) {
            const answerValue = selectedRadio.value || 'ุฎูุงุฑ ูุญุฏุฏ';
            surveyAnswers.push(`${q.text}:\n   - ุงูุฅุฌุงุจุฉ: ${answerValue}`);
        } else {
            allAnswered = false;
        }
    });

    if (!allAnswered) {
        alert("ุงูุฑุฌุงุก ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุฃุณุฆูุฉ ุงุณุชุจูุงู ููู ุงูุฃูุฑ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

// ...
    // ุฌูุน ุงูุฅุฌุงุจุงุช
  /*  studentQuestions.forEach(q => {
        // ูุณุชุฎุฏู document.querySelector ููุจุญุซ ุนู ุงูุฎูุงุฑ ุงููุญุฏุฏ ุจุงูุงุณู ุงูุตุญูุญ
        const selectedRadio = document.querySelector(`input[name="${q.name}"]:checked`);
        
        // ุงูุชุญูู ูู ูุฌูุฏ ุฅุฌุงุจุฉ ูุญุฏุฏุฉ
        if (selectedRadio) {
            // ูุฑุงุกุฉ ุงููููุฉ ูุจุงุดุฑุฉ ูู ุงูุญูู ุงููุญุฏุฏ
            const answerValue = selectedRadio.value.trim() || 'ุชู ุงูุชุญุฏูุฏ'; 
            surveyAnswers.push(`${q.text}:\n   - ุงูุฅุฌุงุจุฉ: ${answerValue}`);
        } else {
            // ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ ุฎูุงุฑ ููุฐุง ุงูุณุคุงูุ ุชุนุชุจุฑ ุงูุฅุฌุงุจุงุช ุบูุฑ ููุชููุฉ
            allAnswered = false;
        }
    });
    // 3. ุชูุณูู ุงูุฑุณุงูุฉ
    const messageHeader = `*๐ ุงุณุชุจูุงู ููู ุงูุฃูุฑ*\n`;
    const info = `ุจุฎุตูุต ุงูุทุงูุจุฉ: ${studentName}\n\n`;
    const answersText = surveyAnswers.join('\n');
    
    const fullMessage = messageHeader + info + "--- ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ---\n" + answersText;

    // 4. ุจูุงุก ููุชุญ ุฑุงุจุท ูุงุชุณุงุจ
    const whatsappURL = `https://wa.me/${teacherPhoneNumber}?text=${encodeURIComponent(fullMessage)}`;
    window.open(whatsappURL, '_blank', 'noopener,noreferrer');
};


// =================================================================
// 2. ุฏุงูุฉ ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ ุนุจุฑ ูุงุชุณุงุจ (ููุนุฏููู)
// =================================================================
window.sendParentSurveyViaWhatsApp = function() {
    // โ๏ธ ุชุฃูุฏ ูู ุฃู ูุฐุง ุงูุฑูู ูู ุฑูู ุงููุนููุฉ ุงูุตุญูุญ โ๏ธ
    const teacherPhoneNumber = "966555320501"; 

    // 1. ุฌูุน ูุนูููุงุช ุงูุทุงูุจุฉ (ููุณูุงู)
    const studentName = document.getElementById('sName').textContent.trim();

    // 2. ุชุญุฏูุฏ ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู
    const parentQuestions = [
        { name: 'pq1', text: '1. ูุฏู ุฑุถุง ููู ุงูุฃูุฑ ุนู ุงูุฃุฏุงุก' },
        { name: 'pq2', text: '2. ุณูููุฉ ุงููุตูู ุฅูู ุชูุงุฑูุฑ ุงูุฃุฏุงุก' },
        { name: 'pq3', text: '3. ูุนุงููุฉ ุชูุงุตู ุงููุนููุฉ' },
        { name: 'pq4', text: '4. ูุงุฆุฏุฉ ุงูููุตุฉ ููุชุงุจุนุฉ ุงูุทุงูุจุฉ' }
    ];
    
    let surveyAnswers = [];
    let allAnswered = true;
    
    // ุฌูุน ุงูุฅุฌุงุจุงุช
    parentQuestions.forEach(q => {
        // ุงูุจุญุซ ุนู ุงูุฎูุงุฑ ุงููุญุฏุฏ ุจุงูุงุณู ุงูุตุญูุญ
        const selectedRadio = document.querySelector(`input[name="${q.name}"]:checked`);
        
        if (selectedRadio) {
            // โญ๏ธ ุงูุชุนุฏูู ููุง: ูุฑุงุกุฉ ูููุฉ ุงููุฏุฎู. ุฅุฐุง ูุงูุช ูุงุฑุบุฉ (value="") ุณูุชู ุงุณุชุฎุฏุงู "ุชู ุงูุชุญุฏูุฏ (ูููุฉ ูุงุฑุบุฉ)".
            const answerValue = selectedRadio.value.trim() || 'ุชู ุงูุชุญุฏูุฏ (ูููุฉ ูุงุฑุบุฉ)';
            surveyAnswers.push(`${q.text}:\n   - ุงูุฅุฌุงุจุฉ: ${answerValue}`);
        } else {
            allAnswered = false;
        }
    });

    if (!allAnswered) {
        alert("ุงูุฑุฌุงุก ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุฃุณุฆูุฉ ุงุณุชุจูุงู ููู ุงูุฃูุฑ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }
    
    // โญ๏ธ ุงูุชุนุฏูู ููุง: ุงูุชุญูู ูู ุฃู ููุงู ุฅุฌุงุจุงุช ุชู ุฌูุนูุง ุจุงููุนู ูุจู ุงูุฅุฑุณุงู
    if (surveyAnswers.length === 0) {
        alert("ูุดู ูู ุฌูุน ุฅุฌุงุจุงุช ุงูุงุณุชุจูุงู. ูุฑุฌู ุงูุชุฃูุฏ ูู ูุฌูุฏ ุฎุงุตูุฉ 'value' ููู ุฅุฌุงุจุฉ.");
        return;
    }

    // 3. ุชูุณูู ุงูุฑุณุงูุฉ
    const messageHeader = `*๐ ุงุณุชุจูุงู ููู ุงูุฃูุฑ*\n`;
    const info = `ุจุฎุตูุต ุงูุทุงูุจุฉ: ${studentName}\n\n`;
    const answersText = surveyAnswers.join('\n');
    
    const fullMessage = messageHeader + info + "--- ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ---\n" + answersText;

    // 4. ุจูุงุก ููุชุญ ุฑุงุจุท ูุงุชุณุงุจ
    const whatsappURL = `https://wa.me/${teacherPhoneNumber}?text=${encodeURIComponent(fullMessage)}`;
    window.open(whatsappURL, '_blank', 'noopener,noreferrer');
};
// =================================================================
// 2. ุฏุงูุฉ ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ ุนุจุฑ ูุงุชุณุงุจ (ุชู ุงูุชุนุฏูู ููุฑุงุกุฉ ุงููุต ุงููุฑุฆู)
// =================================================================
window.sendParentSurveyViaWhatsApp = function() {
    const teacherPhoneNumber = "966555320501"; // ุฑูู ุงููุนููุฉ

    // 1. ุฌูุน ูุนูููุงุช ุงูุทุงูุจุฉ (ููุณูุงู)
    const studentName = document.getElementById('sName').textContent.trim();

    // 2. ุชุญุฏูุฏ ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู
    const parentQuestions = [
        { name: 'pq1', text: '1. ูุฏู ุฑุถุง ููู ุงูุฃูุฑ ุนู ุงูุฃุฏุงุก' },
        { name: 'pq2', text: '2. ุณูููุฉ ุงููุตูู ุฅูู ุชูุงุฑูุฑ ุงูุฃุฏุงุก' },
        { name: 'pq3', text: '3. ูุนุงููุฉ ุชูุงุตู ุงููุนููุฉ' },
        { name: 'pq4', text: '4. ูุงุฆุฏุฉ ุงูููุตุฉ ููุชุงุจุนุฉ ุงูุทุงูุจุฉ' }
    ];
    
    let surveyAnswers = [];
    let allAnswered = true;
    
    // ุฌูุน ุงูุฅุฌุงุจุงุช
    parentQuestions.forEach(q => {
        const selectedRadio = document.querySelector(`input[name="${q.name}"]:checked`);
        
        if (selectedRadio) {
            let answerValue = selectedRadio.value.trim();
            
            // โญ๏ธโญ๏ธ ุงูุญู ููุง: ุฅุฐุง ูุงูุช ูููุฉ (value) ูุงุฑุบุฉุ ูุนุชูุฏ ุนูู ุงููุต ุงููุฑุฆู โญ๏ธโญ๏ธ
            if (!answerValue) {
                // ูุญุงููุฉ ุงุณุชุฎุฑุงุฌ ุงููุต ูู ุงูุนูุตุฑ ุงูุฃุจ (ุนุงุฏุฉ <label> ุฃู <div> ูุญุชูู ุงูุฒุฑ ูุงููุต)
                answerValue = selectedRadio.parentElement.textContent.trim();
                
                // ุชูุธูู ุงููููุฉ ุงููุณุชุฎุฑุฌุฉ ูู ุฃู ูุณุงูุงุช ุฒุงุฆุฏุฉ ุฃู ููุงุตู ุฃุณุทุฑ
                answerValue = answerValue.replace(/[\r\n\t]+/g, ' ').replace(/\s{2,}/g, ' ').trim();
            }

            answerValue = answerValue || 'ุชู ุงูุชุญุฏูุฏ'; // ูููุฉ ุงุญุชูุงุทูุฉ ุฃุฎูุฑุฉ

            surveyAnswers.push(`${q.text}:\n   - ุงูุฅุฌุงุจุฉ: ${answerValue}`);
        } else {
            allAnswered = false;
        }
    });

  /*  if (!allAnswered) {
        alert("ุงูุฑุฌุงุก ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุฃุณุฆูุฉ ุงุณุชุจูุงู ููู ุงูุฃูุฑ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }
    
    // 3. ุชูุณูู ุงูุฑุณุงูุฉ
    const messageHeader = `*๐ ุงุณุชุจูุงู ููู ุงูุฃูุฑ*\n`;
    const info = `ุจุฎุตูุต ุงูุทุงูุจุฉ: ${studentName}\n\n`;
    const answersText = surveyAnswers.join('\n');
    
    const fullMessage = messageHeader + info + "--- ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ---\n" + answersText;

    // 4. ุจูุงุก ููุชุญ ุฑุงุจุท ูุงุชุณุงุจ
    const whatsappURL = `https://wa.me/${teacherPhoneNumber}?text=${encodeURIComponent(fullMessage)}`;
    window.open(whatsappURL, '_blank', 'noopener,noreferrer');
};*/
/* =======================================================
   1. ุชุนุฑูู ุงูุฏูุงู ุงููุณุงุนุฏุฉ ุงูุฃุณุงุณูุฉ
   ======================================================= 

// ุฏุงูุฉ ุงูุงุฎุชุตุงุฑ ูู document.querySelector
const $ = s => document.querySelector(s);

// ุฏุงูุฉ ูุชูุธูู ุงูุงุณู (ูููุฉ ูุญูุธ ุงูุจูุงูุงุช ูู localStorage)
function normalizeName(name) {
  return name.replace(/\s+/g, '_').replace(/[^\w-]/g, '').toLowerCase();
}

/* =======================================================
   2. ููุฏ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ูุงุชุณุงุจ)
   ======================================================= 

// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ (ููููู ุชุบููุฑู ุญุณุจ ุงูุญุงุฌุฉ)
const TEACHER_WHATSAPP = "966555320501";

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ (ุชุฏุนู ุงูููุจ ูุงูููุจุงูู)
function openWhatsApp(p, text) {
  const encoded = encodeURIComponent(text || "");
  const isMobile = /Android|iPhone|iPad|iPod|IEMobile|WPDesktop/i.test(navigator.userAgent);
  
  // ูุญุงููุฉ wa.me (ุงูุฃูุซุฑ ุชูุงูููุง)
  const waMe = `https://wa.me/${p}?text=${encoded}`;
  // ูุญุงููุฉ web.whatsapp.com
  const waWeb = `https://web.whatsapp.com/send?phone=${p}&text=${encoded}`;
  // ูุญุงููุฉ ุงูุจุฑูุชูููู (ููููุจุงูู ูุจุงุดุฑุฉ)
  const waProtocol = `whatsapp://send?phone=${p}&text=${encoded}`;
  
  const tryUrls = isMobile ? [waProtocol, waMe, waWeb] : [waMe, waWeb, waProtocol];
  
  for (const url of tryUrls) {
    const win = window.open(url, "_blank", "noopener,noreferrer");
    if (win) {
      break;
    }
  }
}

// ๐ ุฑุจุท ุงูุญุฏุซ ุจุฒุฑ "ุชูุงุตู ูุน ุงููุนููุฉ"
if ($("#contactTeacher")) {
    $("#contactTeacher").onclick = () => {
        // ุงูุชุฑุงุถ ุฃู ููุญุฉ ููู ุงูุฃูุฑ ุชุญุชูู ุนูู ุนูุตุฑู #pName ู #pClass
        const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจุฉ ุบูุฑ ูุนุฑููุฉ";
        const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู ุบูุฑ ูุนุฑูู";

        const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ููู ุฃูุฑ ุงูุทุงูุจุฉ ${studentName} ูู ูุตู ${studentClass}.
ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุฃุฏุงุก ุงุจูุชู ูู ุงููุงุฏุฉ.`;
        
        openWhatsApp(TEACHER_WHATSAPP, msg);
    };
}


/* =======================================================
   3. ููุฏ ุฅุฑุณุงู ูููุฐุฌ ููู ุงูุฃูุฑ
   ======================================================= 
if ($("#submitParentFeedback")) {
    $("#submitParentFeedback").onclick = () => {
        // ุงูุชุฑุงุถ ูุฌูุฏ ุงูุนูุงุตุฑ #pName, #pClass ูู ููุญุฉ ููู ุงูุฃูุฑ
        const name = $("#pName") ? $("#pName").textContent.trim() : "";
        const cls = $("#pClass") ? $("#pClass").textContent.trim() : "";
        
        // ุงุณุชุฎุฑุงุฌ ููู ุงูุงุณุชุจูุงู
        const trait = $("#parentTrait")?.value.trim() || "";
        const skill = $("#parentSkill")?.value.trim() || "";
        const strategy = $("#parentStrategy")?.value.trim() || "";
        const awareness = $("#parentAwareness")?.value || "";
        const satisfaction = $("#parentSatisfaction")?.value || "";
        const additionalStrategy = $("#parentAdditionalStrategy")?.value || "";
        const additionalStrategyDetail = $("#parentAdditionalStrategyDetail")?.value.trim() || "";
       
        // ุงูุชุญูู ูู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ
        if (!trait || !skill || !strategy || !awareness || !satisfaction || !additionalStrategy) {
            // ููุงุญุธุฉ: ุฏุงูุฉ showToast ูุฌุจ ุฃู ุชููู ูุนุฑูุฉ ูู ูููู.
            if (typeof showToast === 'function') {
                showToast("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูู ุงูุงุณุชุจูุงู");
            } else {
                alert("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูู ุงูุงุณุชุจูุงู");
            }
            return;
        }
        
        // ุงูุชุญูู ูู ุชูุงุตูู ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุฅุถุงููุฉ ุฅุฐุง ุชู ุงุฎุชูุงุฑ "ูุนู"
        if (additionalStrategy === "ูุนู" && !additionalStrategyDetail) {
            if (typeof showToast === 'function') {
                showToast("โ๏ธ ูุฑุฌู ูุชุงุจุฉ ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชูุชุฑุญูููุง");
            } else {
                alert("โ๏ธ ูุฑุฌู ูุชุงุจุฉ ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชูุชุฑุญูููุง");
            }
            return;
        }

        // ุญูุธ ุงูุจูุงูุงุช ูู localStorage
        const feedbackKey = `parent_feedback_${normalizeName(cls)}_${normalizeName(name)}`;
        const now = new Date().toISOString();
        const feedbackData = {
            name, cls, trait, skill, strategy, awareness, satisfaction,
            additionalStrategy, additionalStrategyDetail, timestamp: now
        };
        localStorage.setItem(feedbackKey, JSON.stringify(feedbackData));

       // ๐ข ุชุณุฌูู ูุฅุธูุงุฑ ุฑุณุงูุฉ ุงููุฌุงุญ
        // ููุงุญุธุฉ: ุงูุฏูุงู (loadData, saveData, recordFamilyInteraction, showThankYouMessage, backToMenu) ูุฌุจ ุฃู ุชููู ูุนุฑูุฉ ูู ูููู.*
        if (typeof loadData === 'function' && typeof saveData === 'function' && typeof recordFamilyInteraction === 'function') {
            const state = loadData();
            recordFamilyInteraction(name, cls, 'parent_feedback');
            saveData(state);
        }

        if (typeof showThankYouMessage === 'function' && typeof backToMenu === 'function') {
            showThankYouMessage('parent', name);
            // ุงุฎูุงุก ููุญุงุช ุงูุนุฑุถ ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
            $("#parentPanel")?.classList.add("hidden");
            $("#parentReport")?.classList.add("hidden");
            backToMenu();
        } else {
             alert("โ ุชู ุฅุฑุณุงู ุงูุงุณุชุจูุงู ูุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ! (ูุฑุฌู ุงูุชุฃูุฏ ูู ูุฌูุฏ ุฏูุงู ุงูุชุญูู ุจุงูุนุฑุถ)");
        }
    };
}*/
/* =======================================================
   1. ุงูุฏูุงู ุงููุณุงุนุฏุฉ ูุงูุชุนุฑููุงุช (ุชุฃูุฏ ูู ูุฌูุฏูุง)
   ======================================================= 
const $ = s => document.querySelector(s);
// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ
const TEACHER_WHATSAPP = "966504221144";

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ (ููุณ ุงูุฏุงูุฉ ุงูุณุงุจูุฉ)
function openWhatsApp(p, text) {
  const encoded = encodeURIComponent(text || "");
  const isMobile = /Android|iPhone|iPad|iPod|IEMobile|WPDesktop/i.test(navigator.userAgent);
  const waMe = `https://wa.me/${p}?text=${encoded}`;
  const waWeb = `https://web.whatsapp.com/send?phone=${p}&text=${encoded}`;
  const waProtocol = `whatsapp://send?phone=${p}&text=${encoded}`;
  
  const tryUrls = isMobile ? [waProtocol, waMe, waWeb] : [waMe, waWeb, waProtocol];
  
  for (const url of tryUrls) {
    const win = window.open(url, "_blank", "noopener,noreferrer");
    if (win) {
      break;
    }
  }
}

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช (ูุฌุจ ุฃู ุชููู ูุนุฑูุฉ ูู ูููู)
function showToast(message) {
    console.log(`[TOAST]: ${message}`); // ุจุฏูู ูุคูุช ุฅุฐุง ูู ุชูู ุงูุฏุงูุฉ ููุฌูุฏุฉ
    // alert(message); // ุจุฏูู ุขุฎุฑ
}


/* =======================================================
   2. ููุฏ ุฒุฑ "ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ" ุงูููุนุฏูู (ูุฅุฑุณุงู ูุงุชุณุงุจ)
   ======================================================= 

if ($("#submitParentFeedback")) {
    $("#submitParentFeedback").onclick = () => {
        // 1. ุฌูุน ุจูุงูุงุช ุงูุทุงูุจุฉ (ุงูุงุณู ูุงููุตู)
        const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        
        // 2. ุฌูุน ุฅุฌุงุจุงุช ุงูุงุณุชุจูุงู
        const surveyQuestions = [
            { id: "parentTrait", text: "1. ููุงุท ุงูููุฉ ุงูุฑุฆูุณูุฉ ูู ููุงุฑุงุช ุงุจูุชู ูู ูุฐู ุงููุงุฏุฉ" },
            { id: "parentSkill", text: "2. ุงูููุงุฑุฉ ุงูุชู ุชุญุชุงุฌ ุงุจูุชู ุฅูู ุงูุนูู ุนูููุง ุฃูุซุฑ" },
            { id: "parentStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชู ุณุงุนุฏุช ุงุจูุชู ูู ุชุทููุฑ ุฃุฏุงุฆูุง" },
            { id: "parentAwareness", text: "4. ูุฏู ูุนู ุงุจูุชู ุจุฃูุฏุงู ุงููุงุฏุฉ" },
            { id: "parentSatisfaction", text: "5. ูุฏู ุฑุถุงูู ุนู ุฃุฏุงุก ุงุจูุชู ุงูุญุงูู" },
            { id: "parentAdditionalStrategy", text: "6. ูู ุชูุชุฑุญูู ุทุฑููุฉ ุฅุถุงููุฉ ูููุณุงุนุฏุฉ" },
            { id: "parentAdditionalStrategyDetail", text: "7. ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ูุนูุ ูุฑุฌู ูุชุงุจุฉ ุงูุทุฑููุฉ" }
        ];

        let surveyAnswers = [];
        let allAnswered = true;
        
        // ุงููุฑูุฑ ุนูู ุฌููุน ุงูุฃุณุฆูุฉ ูุฌูุน ุงูุฅุฌุงุจุงุช ูุงูุชุญูู ูู ุงูุชุนุจุฆุฉ
        for (const q of surveyQuestions) {
            const element = $(`#${q.id}`);
            let answerValue = "";
            
            if (element) {
                if (element.type === 'textarea' || element.type === 'text' || element.tagName === 'SELECT') {
                    answerValue = element.value.trim();
                } else if (element.type === 'radio') {
                    // ููุฃุณุฆูุฉ ุงูุฑุงุฏูููุฉุ ูุญุชุงุฌ ููุนุซูุฑ ุนูู ุงูุฒุฑ ุงููุญุฏุฏ ุฏุงุฎู ุงูุฃุจ (ุงูุชุฑุงุถูุงู)
                    // ูู ุญุงูุฉ ูุฐุง ุงูุงุณุชุจูุงู ุงููุญุฏุฏุ ุนูุงุตุฑ ุงูุฅุฏุฎุงู ูู SELECT ุฃู TEXTAREA
                    answerValue = element.value.trim();
                }
                
                // ุญุงูุฉ ุฎุงุตุฉ: ุงูุณุคุงู ุงูุณุงุจุน (ุงูุชูุงุตูู) ูุทููุจ ููุท ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุนูู ุงูุณุคุงู ุงูุณุงุฏุณ "ูุนู"
                if (q.id === "parentAdditionalStrategyDetail" && $(`#parentAdditionalStrategy`)?.value !== "ูุนู") {
                    // ุชุฌุงูู ุงูุชุญูู ูู ูุฐุง ุงูุญูู ุฅุฐุง ูู ูุทูุจ
                    continue; 
                }

                if (!answerValue) {
                    allAnswered = false;
                    break; // ุฅููุงู ุงูุญููุฉ ุจูุฌุฑุฏ ุงูุนุซูุฑ ุนูู ุญูู ูุงุฑุบ ูุทููุจ
                }

                surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
            }
        }
        
        // ุงูุชุญูู ุงูููุงุฆู ูู ุงูุชุนุจุฆุฉ
        if (!allAnswered) {
            showToast("โ๏ธ ูุฑุฌู ุงูุชุฃูุฏ ูู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูู ุงูุงุณุชุจูุงู ูุจู ุงูุฅุฑุณุงู.");
            return;
        }

        // 3. ุชูุณูู ุฑุณุงูุฉ ูุงุชุณุงุจ
        const messageHeader = `*๐ ุงุณุชุจูุงู ููู ุฃูุฑ*`;
        const info = `ุจุฎุตูุต ุงูุทุงูุจุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
        const answersText = surveyAnswers.join('\n\n'); // ูุตู ุงูุฅุฌุงุจุงุช ุจูุงุตู ุณุทุฑูู
        
        const fullMessage = messageHeader + "\n\n" + info + "*--- ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ---*\n" + answersText;

        // 4. ุฅุฑุณุงู ุนุจุฑ ูุงุชุณุงุจ
        openWhatsApp(TEACHER_WHATSAPP, fullMessage);
        
        // 5. ุฑุณุงูุฉ ูุฌุงุญ ูุงุนุงุฏุฉ ุงูุชูุฌูู (ุงูุชุฑุงุถูุงู)
        // ููุงุญุธุฉ: ูุฏ ุชุญุชุงุฌ ูุชุทุจูู ุฏุงูุฉ showThankYouMessage ู backToMenu ูู ูููู.
        if (typeof showThankYouMessage === 'function' && typeof backToMenu === 'function') {
            // ูููู ุนุฑุถ ุฑุณุงูุฉ ุดูุฑ ููุง ุจุนุฏ ูุญุงููุฉ ุงูุฅุฑุณุงู
            showThankYouMessage('parent', studentName);
            $("#parentPanel")?.classList.add("hidden");
            backToMenu();
        } else {
             // ุฅุดุนุงุฑ ุจุณูุท ูููู ุงูุฃูุฑ ุจูุฌุงุญ ุงูุนูููุฉ
             showToast("โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ุงูุงุณุชุจูุงูุ ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.");
        }
    };
}
    /* =======================================================
   1. ุงูุฏูุงู ุงููุณุงุนุฏุฉ ูุงูุชุนุฑููุงุช (ุชุฃูุฏ ูู ูุฌูุฏูุง)
   ======================================================= 
const $ = s => document.querySelector(s);
// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ
const TEACHER_WHATSAPP = "966555320501";

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ (ููุณ ุงูุฏุงูุฉ ุงูุณุงุจูุฉ)
function openWhatsApp(p, text) {
  const encoded = encodeURIComponent(text || "");
  const isMobile = /Android|iPhone|iPad|iPod|IEMobile|WPDesktop/i.test(navigator.userAgent);
  const waMe = `https://wa.me/${p}?text=${encoded}`;
  const waWeb = `https://web.whatsapp.com/send?phone=${p}&text=${encoded}`;
  const waProtocol = `whatsapp://send?phone=${p}&text=${encoded}`;
  
  const tryUrls = isMobile ? [waProtocol, waMe, waWeb] : [waMe, waWeb, waProtocol];
  
  for (const url of tryUrls) {
    const win = window.open(url, "_blank", "noopener,noreferrer");
    if (win) {
      break;
    }
  }
}

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช (ูุฌุจ ุฃู ุชููู ูุนุฑูุฉ ูู ูููู)
function showToast(message) {
    console.log(`[TOAST]: ${message}`); // ุจุฏูู ูุคูุช ุฅุฐุง ูู ุชูู ุงูุฏุงูุฉ ููุฌูุฏุฉ
    // alert(message); // ุจุฏูู ุขุฎุฑ
}


/* =======================================================
   2. ููุฏ ุฒุฑ "ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ" ุงูููุนุฏูู (ูุฅุฑุณุงู ูุงุชุณุงุจ)
   ======================================================= */

/*if ($("#submitParentFeedback")) {
    $("#submitParentFeedback").onclick = () => {
        // 1. ุฌูุน ุจูุงูุงุช ุงูุทุงูุจุฉ (ุงูุงุณู ูุงููุตู)
        const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        
        // 2. ุฌูุน ุฅุฌุงุจุงุช ุงูุงุณุชุจูุงู
        const surveyQuestions = [
            { id: "parentTrait", text: "1. ููุงุท ุงูููุฉ ุงูุฑุฆูุณูุฉ ูู ููุงุฑุงุช ุงุจูุชู ูู ูุฐู ุงููุงุฏุฉ" },
            { id: "parentSkill", text: "2. ุงูููุงุฑุฉ ุงูุชู ุชุญุชุงุฌ ุงุจูุชู ุฅูู ุงูุนูู ุนูููุง ุฃูุซุฑ" },
            { id: "parentStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชู ุณุงุนุฏุช ุงุจูุชู ูู ุชุทููุฑ ุฃุฏุงุฆูุง" },
            { id: "parentAwareness", text: "4. ูุฏู ูุนู ุงุจูุชู ุจุฃูุฏุงู ุงููุงุฏุฉ" },
            { id: "parentSatisfaction", text: "5. ูุฏู ุฑุถุงูู ุนู ุฃุฏุงุก ุงุจูุชู ุงูุญุงูู" },
            { id: "parentAdditionalStrategy", text: "6. ูู ุชูุชุฑุญูู ุทุฑููุฉ ุฅุถุงููุฉ ูููุณุงุนุฏุฉ" },
            { id: "parentAdditionalStrategyDetail", text: "7. ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ูุนูุ ูุฑุฌู ูุชุงุจุฉ ุงูุทุฑููุฉ" }
        ];

        let surveyAnswers = [];
        let allAnswered = true;
        
        // ุงููุฑูุฑ ุนูู ุฌููุน ุงูุฃุณุฆูุฉ ูุฌูุน ุงูุฅุฌุงุจุงุช ูุงูุชุญูู ูู ุงูุชุนุจุฆุฉ
        for (const q of surveyQuestions) {
            const element = $(`#${q.id}`);
            let answerValue = "";
            
            if (element) {
                if (element.type === 'textarea' || element.type === 'text' || element.tagName === 'SELECT') {
                    answerValue = element.value.trim();
                } else if (element.type === 'radio') {
                    // ููุฃุณุฆูุฉ ุงูุฑุงุฏูููุฉุ ูุญุชุงุฌ ููุนุซูุฑ ุนูู ุงูุฒุฑ ุงููุญุฏุฏ ุฏุงุฎู ุงูุฃุจ (ุงูุชุฑุงุถูุงู)
                    // ูู ุญุงูุฉ ูุฐุง ุงูุงุณุชุจูุงู ุงููุญุฏุฏุ ุนูุงุตุฑ ุงูุฅุฏุฎุงู ูู SELECT ุฃู TEXTAREA
                    answerValue = element.value.trim();
                }
                
                // ุญุงูุฉ ุฎุงุตุฉ: ุงูุณุคุงู ุงูุณุงุจุน (ุงูุชูุงุตูู) ูุทููุจ ููุท ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุนูู ุงูุณุคุงู ุงูุณุงุฏุณ "ูุนู"
                if (q.id === "parentAdditionalStrategyDetail" && $(`#parentAdditionalStrategy`)?.value !== "ูุนู") {
                    // ุชุฌุงูู ุงูุชุญูู ูู ูุฐุง ุงูุญูู ุฅุฐุง ูู ูุทูุจ
                    continue; 
                }

                if (!answerValue) {
                    allAnswered = false;
                    break; // ุฅููุงู ุงูุญููุฉ ุจูุฌุฑุฏ ุงูุนุซูุฑ ุนูู ุญูู ูุงุฑุบ ูุทููุจ
                }

                surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
            }
        }
        
        // ุงูุชุญูู ุงูููุงุฆู ูู ุงูุชุนุจุฆุฉ
        if (!allAnswered) {
            showToast("โ๏ธ ูุฑุฌู ุงูุชุฃูุฏ ูู ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูู ุงูุงุณุชุจูุงู ูุจู ุงูุฅุฑุณุงู.");
            return;
        }

        // 3. ุชูุณูู ุฑุณุงูุฉ ูุงุชุณุงุจ
        const messageHeader = `*๐ ุงุณุชุจูุงู ููู ุฃูุฑ*`;
        const info = `ุจุฎุตูุต ุงูุทุงูุจุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
        const answersText = surveyAnswers.join('\n\n'); // ูุตู ุงูุฅุฌุงุจุงุช ุจูุงุตู ุณุทุฑูู
        
        const fullMessage = messageHeader + "\n\n" + info + "*--- ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ---*\n" + answersText;

        // 4. ุฅุฑุณุงู ุนุจุฑ ูุงุชุณุงุจ
        openWhatsApp(TEACHER_WHATSAPP, fullMessage);
        
        // 5. ุฑุณุงูุฉ ูุฌุงุญ ูุงุนุงุฏุฉ ุงูุชูุฌูู (ุงูุชุฑุงุถูุงู)
        // ููุงุญุธุฉ: ูุฏ ุชุญุชุงุฌ ูุชุทุจูู ุฏุงูุฉ showThankYouMessage ู backToMenu ูู ูููู.
        if (typeof showThankYouMessage === 'function' && typeof backToMenu === 'function') {
            // ูููู ุนุฑุถ ุฑุณุงูุฉ ุดูุฑ ููุง ุจุนุฏ ูุญุงููุฉ ุงูุฅุฑุณุงู
            showThankYouMessage('parent', studentName);
            $("#parentPanel")?.classList.add("hidden");
            backToMenu();
        } else {
             // ุฅุดุนุงุฑ ุจุณูุท ูููู ุงูุฃูุฑ ุจูุฌุงุญ ุงูุนูููุฉ
             showToast("โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ุงูุงุณุชุจูุงูุ ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.");
        }
    };
}*/
/* =======================================================
   SCRIPT: ููุฏ ูุธุงุฆู ุงูุงุชุตุงู ูุงูุชุญูู ุงูููุญุฏุฉ (ูุงุชุณุงุจ)
   ======================================================= 

// 1. ุงูุชุนุฑููุงุช ุงูุฃุณุงุณูุฉ
const $ = s => document.querySelector(s);
// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ: (555320501)
const TEACHER_WHATSAPP = "966555320501"; 

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช/ุชูุจูู
function showToast(message) {
    console.warn(`[ุชูุจูู]: ${message}`); 
    alert(message);
}

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ
function openWhatsApp(p, text) {
    const encoded = encodeURIComponent(text || "");
    const waUrl = `https://wa.me/${p}?text=${encoded}`;
    window.open(waUrl, "_blank", "noopener,noreferrer");
}

/**
 * ุฏุงูุฉ ููุญุฏุฉ ูุชุฌููุน ุจูุงูุงุช ุงูุงุณุชุจูุงู ูุฅุฑุณุงููุง ุนุจุฑ ูุงุชุณุงุจ
 * @param {Array<Object>} questions - ูุตูููุฉ ุงูุฃุณุฆูุฉ (ID + ุงููุต ุงูููุงุจู)
 * @param {string} title - ุนููุงู ุงูุฑุณุงูุฉ ูู ูุงุชุณุงุจ
 
function collectAndSendSurvey(questions, title) {
    // ุฌูุน ุจูุงูุงุช ุงูุทุงูุจุฉ ูู ุงูุนูุงุตุฑ ุฐุงุช IDs #pName ู #pClass (ููุชุฑุถ ูุฌูุฏููุง)
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    
    let surveyAnswers = [];
    let allAnswered = true;
    
    // ุงููุฑูุฑ ุนูู ุงูุฃุณุฆูุฉ ูุชุฌููุน ุงูุฅุฌุงุจุงุช
    for (const q of questions) {
        const element = $(`#${q.id}`);
        let answerValue = "";
        
        if (element) {
            answerValue = element.value.trim();
        }

        // ุงูุชุญูู ูู ุชุนุจุฆุฉ ุงูุญููุ ูุง ูู ููู ุญูู "ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ" ููู ุบูุฑ ูุทููุจ
        if (!answerValue && q.id !== 'parentAdditionalMethod') {
             // ุงูุชุญูู ุงูุฎุงุต: ุญูู parentAdditionalMethod ูุทููุจ ููุท ุฅุฐุง ูุงูุช parentHasAdditionalMethod = 'ูุนู'
             const isAdditionalMethodConditional = q.id === 'parentAdditionalMethod' && $('#parentHasAdditionalMethod')?.value === 'ูุนู';
             
             if (q.id !== 'parentAdditionalMethod' || isAdditionalMethodConditional) {
                 allAnswered = false;
                 break; 
             }
        }

        // ุฅุถุงูุฉ ุงูุฅุฌุงุจุฉ ุฅูู ุงููุงุฆูุฉ (ูุชุฌุงูู ุงูุญููู ุงููุงุฑุบุฉ ุบูุฑ ุงููุทููุจุฉ ูุซู parentAdditionalMethod)
        if (answerValue) {
            surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
        } else if (q.id === 'parentHasAdditionalMethod' && answerValue === 'ูุง') {
             surveyAnswers.push(`*${q.text}:*\n   - ูุงุ ูุง ููุฌุฏ (ุฃูุชูู ุจุทุฑููุฉ ุงููุนููุฉ)`);
        }
    }
    
    // ุงูุชุญูู ูู ุงูุชุนุจุฆุฉ ุงูููุงุฆูุฉ
    if (!allAnswered) {
        showToast("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุญููู ุงูุงุณุชุจูุงู ุงููุทููุจุฉ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

    // ุจูุงุก ุฑุณุงูุฉ ูุงุชุณุงุจ
    const messageHeader = `*๐ ${title}*`;
    const info = `ุงูุทุงูุจ/ุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
    const answersText = surveyAnswers.join('\n\n');
    
    const fullMessage = messageHeader + "\n\n" + info + "*--- ุงูุฅุฌุงุจุงุช ---*\n" + answersText;

    // ุงูุฅุฑุณุงู
    openWhatsApp(TEACHER_WHATSAPP, fullMessage);

    // ุฑุณุงูุฉ ูุฌุงุญ
    showToast(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ${title}. ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.`);
}


// ===================================================================
// 2. ุชุนุฑูู ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู (ุจุงุณุชุฎุฏุงู ูุตูุต ุงูุฃุณุฆูุฉ ูู ุงูููุฏ ุงููุฑูู)
// ===================================================================

// ุฃุณุฆูุฉ ููู ุงูุฃูุฑ (ุจุงุณุชุฎุฏุงู IDs ูู ุงูุงุณุชุจูุงู ุงููุฑูู ุฃู IDs ุงููุนุฏูุฉ)
const parentQuestions = [
    { id: "parentTrait", text: "1. ุตูุฉ ุชุชุญูู ุจูุง ุงูุทุงูุจุฉ" },
    { id: "parentSkill", text: "2. ููุงุฑุฉ ุชููุฑุฏ ูุชุชููุฒ ุจูุง" },
    { id: "parentLearningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "parentHasAdditionalMethod", text: "4. ูู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชุฑุบุจูู ูู ุฅุถุงูุชูุงุ" },
    { id: "parentAdditionalMethod", text: "5. ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุชูุงุตูู)" },
    { id: "parentInformParent", text: "6. ูู ุชููู ุงุจูุชูู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑูู ุจุชุญุตูููุง ุงูุฏุฑุงุณูุ" },
    { id: "parentSatisfactionLevel", text: "7. ูุฏู ุฑุถุงูู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐู" }
];

// ุฃุณุฆูุฉ ุงูุทุงูุจุฉ (ุงูุชุฑุงุถูุง ุจูุงุกู ุนูู ุงูุฃููุงุท ุงูุณุงุจูุฉ)
const studentQuestions = [
    { id: "studentEnthusiasm", text: "1. ูุฏู ุงูุญูุงุณ ููุงุฏุฉ ุงููุบุฉ ุงูุนุฑุจูุฉ" },
    { id: "studentChallenge", text: "2. ุฃูุจุฑ ุชุญุฏู ูุงุฌูู ูุฐุง ุงูุฃุณุจูุน" },
    { id: "studentSuggestion", text: "3. ุงูุงูุชุฑุงุญ ูุชุญููู ุงูุชููุฒ" }
];

// ===================================================================
// 3. ููุทู ุงูุชุญูู ุงูุดุฑุทู ููุญูู ุงูุฅุถุงูู
// ===================================================================

if ($('#parentHasAdditionalMethod')) {
    const additionalMethodSelect = $('#parentHasAdditionalMethod');
    const additionalMethodContainer = $('#parentAdditionalMethodContainer');

    // ุฏุงูุฉ ููุชุญูู ูู ุธููุฑ ุญูู ุงูุฅุฏุฎุงู
    const toggleAdditionalMethod = () => {
        if (additionalMethodSelect.value === 'ูุนู') {
            additionalMethodContainer.style.display = 'block';
        } else {
            additionalMethodContainer.style.display = 'none';
            $('#parentAdditionalMethod').value = ''; // ุชูุฑูุบ ุงูุญูู ุนูุฏ ุงูุฅุฎูุงุก
        }
    };
    
    // ุฑุจุท ุงูุญุฏุซ
    additionalMethodSelect.addEventListener('change', toggleAdditionalMethod);

    // ุชุดุบูู ุงูุฏุงูุฉ ุนูุฏ ุงูุชุญููู ูุฃูู ูุฑุฉ
    document.addEventListener('DOMContentLoaded', toggleAdditionalMethod);
}


// ===================================================================
// 4. ุฑุจุท ุงูุฃุญุฏุงุซ ุจุฃุฒุฑุงุฑ ุงูุฅุฑุณุงู
// ===================================================================

// ๐ ุฒุฑ ุงูุชูุงุตู ุงูุนุงู ูุน ุงููุนููุฉ
if ($("#contactTeacher")) {
    $("#contactTeacher").onclick = () => {
        const studentName = $("#pName") ? $("#pName").textContent.trim() : "ููู ุฃูุฑ ุงูุทุงูุจุฉ";
        const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ููู ุฃูุฑ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุฃุฏุงุก ุงุจูุชู.`;
        openWhatsApp(TEACHER_WHATSAPP, msg);
    };
}

// ๐ ุฒุฑ ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ
if ($("#submitParentFeedback")) {
    $("#submitParentFeedback").onclick = () => {
        collectAndSendSurvey(parentQuestions, 'ุงุณุชุจูุงู ููู ุฃูุฑ');
    };
}

// ๐ ุฒุฑ ุฅุฑุณุงู ุงุณุชุจูุงู ุงูุทุงูุจุฉ

if ($("#submitStudentFeedback")) {
    $("#submitStudentFeedback").onclick = () => {
        collectAndSendSurvey(studentQuestions, 'ุงุณุชุจูุงู ุชูููู ุฐุงุชู ููุทุงูุจุฉ');
    };
}
/* =======================================================
   SCRIPT: ูุธุงุฆู ุงูุฅุฑุณุงู ูุงูุชุญูู ุงููุชูุงููุฉ ููุทุงูุจุฉ
   ======================================================= 

// 1. ุงูุชุนุฑููุงุช ุงูุฃุณุงุณูุฉ
const $ = s => document.querySelector(s);
// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ: (555320501)
const TEACHER_WHATSAPP = "966555320501"; 

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช/ุชูุจูู
function showToast(message) {
    console.warn(`[ุชูุจูู]: ${message}`); 
    alert(message);
}

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ
function openWhatsApp(p, text) {
    const encoded = encodeURIComponent(text || "");
    const waUrl = `https://wa.me/${p}?text=${encoded}`;
    window.open(waUrl, "_blank", "noopener,noreferrer");
}

/**
 * ุฏุงูุฉ ูุชุฌููุน ุจูุงูุงุช ุงุณุชุจูุงู ุงูุทุงูุจุฉ ูุฅุฑุณุงููุง ุนุจุฑ ูุงุชุณุงุจ*
 
function collectAndSendStudentSurvey() {
    // ุฌูุน ุจูุงูุงุช ุงูุทุงูุจุฉ (ููุชุฑุถ ุฃู IDs #pName ู #pClass ููุฌูุฏุฉ)
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const surveyTitle = 'ุงุณุชุจูุงู ุชูููู ุฐุงุชู ููุทุงูุจุฉ';

    // ุชุนุฑูู ุงูุฃุณุฆูุฉ ุจูุงุกู ุนูู IDs ูู ููุฏ ุงูุทุงูุจุฉ ุงููุฑูู
    const studentQuestions = [
        { id: "studentTrait", text: "1. ุตูุฉ ุฃุชุญูู ุจูุง" },
        { id: "studentSkill", text: "2. ููุงุฑุฉ ุฃุชููุฒ ุจูุง" },
        { id: "learningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
        { id: "hasAdditionalMethod", text: "4. ูู ุชุฑุบุจูู ูู ุทุฑููุฉ ุฅุถุงููุฉ ูููุณุงุนุฏุฉุ" },
        { id: "additionalMethod", text: "5. ุงูุชุจู ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุงูุชูุงุตูู)" },
        { id: "informParent", text: "6. ูู ุชููููู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑ ููู ุฃูุฑู ุจุชุญุตูููุ" },
        { id: "satisfactionLevel", text: "7. ูุง ูุฏู ุฑุถุงู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐูุ" }
    ];

    let surveyAnswers = [];
    let allAnswered = true;

    // ุงููุฑูุฑ ุนูู ุงูุฃุณุฆูุฉ ูุชุฌููุน ุงูุฅุฌุงุจุงุช
    for (const q of studentQuestions) {
        const element = $(`#${q.id}`);
        let answerValue = "";
        
        if (element) {
            answerValue = element.value.trim();
        }

        // ุญุงูุฉ ุฎุงุตุฉ: ุญูู "ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ" ูุดุฑูุท
        if (q.id === 'additionalMethod') {
            const isRequired = $('#hasAdditionalMethod')?.value === 'ูุนู';
            
            if (isRequired && !answerValue) {
                allAnswered = false;
                break;
            }
            if (!answerValue) continue; 
        } 
        // ุงูุชุญูู ูู ุงูุญููู ุงูุฃุฎุฑู
        else if (!answerValue) {
            allAnswered = false;
            break; 
        }

        // ุฅุถุงูุฉ ุงูุฅุฌุงุจุฉ ุฅูู ุงููุงุฆูุฉ
        surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
    }
    
    // ุงูุชุญูู ูู ุงูุชุนุจุฆุฉ ุงูููุงุฆูุฉ
    if (!allAnswered) {
        showToast("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุญููู ุงูุงุณุชุจูุงู ุงููุทููุจุฉ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

    // ุจูุงุก ุฑุณุงูุฉ ูุงุชุณุงุจ
    const messageHeader = `*๐ ${surveyTitle}*`;
    const info = `ุงูุทุงูุจุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
    const answersText = surveyAnswers.join('\n\n');
    
    const fullMessage = messageHeader + "\n\n" + info + "*--- ุงูุฅุฌุงุจุงุช ---*\n" + answersText;

    // ุงูุฅุฑุณุงู
    openWhatsApp(TEACHER_WHATSAPP, fullMessage);

    // ุฑุณุงูุฉ ูุฌุงุญ
    showToast(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ุงูุงุณุชุจูุงู. ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.`);
}


// ===================================================================
// 3. ููุทู ุงูุชุญูู ุงูุดุฑุทู ููุญูู ุงูุฅุถุงูู (ูุฅุธูุงุฑ/ุฅุฎูุงุก ุญูู 'additionalMethod')
// ===================================================================

if ($('#hasAdditionalMethod')) {
    const additionalMethodSelect = $('#hasAdditionalMethod');
    const additionalMethodContainer = $('#additionalMethodContainer');

    const toggleAdditionalMethod = () => {
        if (additionalMethodSelect.value === 'ูุนู') {
            additionalMethodContainer.style.display = 'block';
        } else {
            additionalMethodContainer.style.display = 'none';
            $('#additionalMethod').value = ''; 
        }
    };
    
    // ุฑุจุท ุงูุญุฏุซ
    additionalMethodSelect.addEventListener('change', toggleAdditionalMethod);

    // ุชุดุบูู ุงูุฏุงูุฉ ุนูุฏ ุงูุชุญููู ูุฃูู ูุฑุฉ
    document.addEventListener('DOMContentLoaded', toggleAdditionalMethod);
}


// ===================================================================
// 4. ุฑุจุท ุงูุฃุญุฏุงุซ ุจุฃุฒุฑุงุฑ ุงูุฅุฑุณุงู
// ===================================================================

// ๐ ุฒุฑ ุฅุฑุณุงู ุงุณุชุจูุงู ุงูุทุงูุจุฉ - ูุฐุง ูู ุงูุฑุจุท ุงููุจุงุดุฑ ุงูุฐู ูุงู ูุฏ ูููู ููููุฏุงู
if ($("#submitStudentFeedback")) {
    $("#submitStudentFeedback").onclick = () => {
        collectAndSendStudentSurvey();
    };
}

// ๐ ุฒุฑ ุงูุชูุงุตู ุงูุนุงู ูุน ุงููุนููุฉ
if ($("#contactTeacher")) {
    $("#contactTeacher").onclick = () => {
        const studentName = $("#pName") ? $("#pName").textContent.trim() : "ููู ุฃูุฑ ุงูุทุงูุจุฉ";
        const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ููู ุฃูุฑ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุฃุฏุงุก ุงุจูุชู.`;
        openWhatsApp(TEACHER_WHATSAPP, msg);
    };
}

// ๐ฒ ูุธููุฉ ุฒุฑ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ุงููุณุชุฎุฏูุฉ ูู onclick ูู HTML)
function contactTeacherWhatsApp() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจุฉ";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู";
    const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ุงูุทุงูุจุฉ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุงููุงุฏุฉ.`;
    openWhatsApp(TEACHER_WHATSAPP, msg);
}*/
/* =======================================================
   SCRIPT: ุงูููุฏ ุงูููุญุฏ ูุงููุตุญุญ ูููุง ุงูููุญุชูู (ููู ุงูุฃูุฑ ูุงูุทุงูุจุฉ)
   ======================================================= */

// 1. ุงูุชุนุฑููุงุช ุงูุฃุณุงุณูุฉ
const $ = s => document.querySelector(s);
// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ: (555320501)
const TEACHER_WHATSAPP = "966555320501"; 

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช/ุชูุจูู
function showToast(message) {
    console.warn(`[ุชูุจูู]: ${message}`); 
    alert(message);
}

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ
function openWhatsApp(p, text) {
    const encoded = encodeURIComponent(text || "");
    const waUrl = `https://wa.me/${p}?text=${encoded}`;
    window.open(waUrl, "_blank", "noopener,noreferrer");
}

/**
 * ุฏุงูุฉ ููุญุฏุฉ ููุตุญุญุฉ ูุชุฌููุน ุจูุงูุงุช ุงูุงุณุชุจูุงู ูุฅุฑุณุงููุง ุนุจุฑ ูุงุชุณุงุจ
 * @param {Array<Object>} questions - ูุตูููุฉ ุงูุฃุณุฆูุฉ (ID + ุงููุต ุงูููุงุจู)
 * @param {string} title - ุนููุงู ุงูุฑุณุงูุฉ ูู ูุงุชุณุงุจ*/
 
function collectAndSendSurvey(questions, title) {
    // ุฌูุน ุจูุงูุงุช ุงูุทุงูุจุฉ (ููุชุฑุถ ุฃู IDs #pName ู #pClass ููุฌูุฏุฉ)
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    
    let surveyAnswers = [];
    let allAnswered = true;
    
    // ุชุญุฏูุฏ ุญููู ุงูุชุญูู ุงูุดุฑุทู ุจูุงุกู ุนูู ูุงุฆูุฉ ุงูุฃุณุฆูุฉ
    const isParentSurvey = questions.some(q => q.id.startsWith('parent'));
    const conditionalInputId = isParentSurvey ? 'parentAdditionalMethod' : 'additionalMethod';
    const conditionalSelectId = isParentSurvey ? 'parentHasAdditionalMethod' : 'hasAdditionalMethod';
    
    // ุงููุฑูุฑ ุนูู ุงูุฃุณุฆูุฉ ูุชุฌููุน ุงูุฅุฌุงุจุงุช
    for (const q of questions) {
        const element = $(`#${q.id}`);
        let answerValue = "";
        
        if (element) {
            answerValue = element.value.trim();
        }

        // 1. ุงูุชุญูู ูู ุญูู ุงูุฅุฏุฎุงู ุงููุดุฑูุท (ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ)
        if (q.id === conditionalInputId) {
            const isRequired = $(`#${conditionalSelectId}`)?.value === 'ูุนู';
            
            if (isRequired && !answerValue) {
                allAnswered = false;
                break;
            }
            if (!answerValue) continue; // ุชุฌุงูู ุฅุฐุง ูุงู ุงุฎุชูุงุฑูุงู ููุงุฑุบุงู
        } 
        // 2. ุงูุชุญูู ูู ุญูู ุงูุงุฎุชูุงุฑ ุงููุดุฑูุท ููุณู (ููุชุฃูุฏ ูู ุงุฎุชูุงุฑ 'ูุนู' ุฃู 'ูุง')
        else if (q.id === conditionalSelectId && !answerValue) {
            allAnswered = false;
            break;
        }
        // 3. ุงูุชุญูู ูู ุจุงูู ุงูุญููู ุงูุฅูุฒุงููุฉ
        else if (!answerValue) {
            allAnswered = false;
            break; 
        }

        // ุฅุถุงูุฉ ุงูุฅุฌุงุจุฉ ุฅูู ุงููุงุฆูุฉ
        surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
    }
    
    // ุงูุชุญูู ูู ุงูุชุนุจุฆุฉ ุงูููุงุฆูุฉ
    if (!allAnswered) {
        showToast("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุญููู ุงูุงุณุชุจูุงู ุงููุทููุจุฉ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

    // ุจูุงุก ุฑุณุงูุฉ ูุงุชุณุงุจ
    const messageHeader = `*๐ ${title}*`;
    const info = `ุงูุทุงูุจ/ุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
    const answersText = surveyAnswers.join('\n\n');
    
    const fullMessage = messageHeader + "\n\n" + info + "*--- ุงูุฅุฌุงุจุงุช ---*\n" + answersText;

    // ุงูุฅุฑุณุงู
    openWhatsApp(TEACHER_WHATSAPP, fullMessage);

    // ุฑุณุงูุฉ ูุฌุงุญ
    showToast(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ${title}. ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.`);
}


// ===================================================================
// 2. ุชุนุฑูู ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู ูููุง ุงูููุญุชูู
// ===================================================================

// ุฃุณุฆูุฉ ููู ุงูุฃูุฑ (ุจุงุณุชุฎุฏุงู IDs ูู ุงูุงุณุชุจูุงู ุงููุฑูู)
const parentQuestions = [
    { id: "parentTrait", text: "1. ุตูุฉ ุชุชุญูู ุจูุง ุงูุทุงูุจุฉ" },
    { id: "parentSkill", text: "2. ููุงุฑุฉ ุชููุฑุฏ ูุชุชููุฒ ุจูุง" },
    { id: "parentLearningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "parentHasAdditionalMethod", text: "4. ูู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชุฑุบุจูู ูู ุฅุถุงูุชูุงุ" },
    { id: "parentAdditionalMethod", text: "5. ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุชูุงุตูู)" },
    { id: "parentInformParent", text: "6. ูู ุชููู ุงุจูุชูู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑูู ุจุชุญุตูููุง ุงูุฏุฑุงุณูุ" },
    { id: "parentSatisfactionLevel", text: "7. ูุฏู ุฑุถุงูู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐู" }
];

// ุฃุณุฆูุฉ ุงูุทุงูุจุฉ (ุจุงุณุชุฎุฏุงู IDs ูู ุงูุงุณุชุจูุงู ุงููุฑูู)
const studentQuestions = [
    { id: "studentTrait", text: "1. ุตูุฉ ุฃุชุญูู ุจูุง" },
    { id: "studentSkill", text: "2. ููุงุฑุฉ ุฃุชููุฒ ุจูุง" },
    { id: "learningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "hasAdditionalMethod", text: "4. ูู ุชุฑุบุจูู ูู ุทุฑููุฉ ุฅุถุงููุฉ ูููุณุงุนุฏุฉุ" },
    { id: "additionalMethod", text: "5. ุงูุชุจู ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุงูุชูุงุตูู)" },
    { id: "informParent", text: "6. ูู ุชููููู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑ ููู ุฃูุฑู ุจุชุญุตูููุ" },
    { id: "satisfactionLevel", text: "7. ูุง ูุฏู ุฑุถุงู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐูุ" }
];


// ===================================================================
// 3. ููุทู ุงูุชุญูู ุงูุดุฑุทู ููุญููู ุงูุฅุถุงููุฉ (ูููุง ุงูููุญุชูู)
// ===================================================================

// ููุทู ููู ุงูุฃูุฑ
if ($('#parentHasAdditionalMethod')) {
    const additionalMethodSelect = $('#parentHasAdditionalMethod');
    const additionalMethodContainer = $('#parentAdditionalMethodContainer');

    const toggleAdditionalMethod = () => {
        additionalMethodContainer.style.display = (additionalMethodSelect.value === 'ูุนู') ? 'block' : 'none';
        if (additionalMethodSelect.value !== 'ูุนู') $('#parentAdditionalMethod').value = ''; 
    };
    additionalMethodSelect.addEventListener('change', toggleAdditionalMethod);
    document.addEventListener('DOMContentLoaded', toggleAdditionalMethod);
}

// ููุทู ุงูุทุงูุจุฉ
if ($('#hasAdditionalMethod')) {
    const additionalMethodSelect = $('#hasAdditionalMethod');
    const additionalMethodContainer = $('#additionalMethodContainer');

    const toggleAdditionalMethod = () => {
        additionalMethodContainer.style.display = (additionalMethodSelect.value === 'ูุนู') ? 'block' : 'none';
        if (additionalMethodSelect.value !== 'ูุนู') $('#additionalMethod').value = '';
    };
    additionalMethodSelect.addEventListener('change', toggleAdditionalMethod);
    document.addEventListener('DOMContentLoaded', toggleAdditionalMethod);
}

// ===================================================================
// 4. ุฑุจุท ุงูุฃุญุฏุงุซ ุจุฃุฒุฑุงุฑ ุงูุฅุฑุณุงู
// ===================================================================

// ๐ ุฒุฑ ุฅุฑุณุงู ุงุณุชุจูุงู ููู ุงูุฃูุฑ
if ($("#submitParentFeedback")) {
    $("#submitParentFeedback").onclick = () => {
        collectAndSendSurvey(parentQuestions, 'ุงุณุชุจูุงู ููู ุฃูุฑ');
    };
}

// ๐ ุฒุฑ ุฅุฑุณุงู ุงุณุชุจูุงู ุงูุทุงูุจุฉ (ุงููุตุญุญ)
if ($("#submitStudentFeedback")) {
    $("#submitStudentFeedback").onclick = () => {
        collectAndSendSurvey(studentQuestions, 'ุงุณุชุจูุงู ุชูููู ุฐุงุชู ููุทุงูุจุฉ');
    };
}
// ๐ ุฒุฑ ุงูุชูุงุตู ุงูุนุงู ูุน ุงููุนููุฉ
if ($("#contactTeacher")) {
    $("#contactTeacher").onclick = () => {
        const studentName = $("#pName") ? $("#pName").textContent.trim() : "ููู ุฃูุฑ ุงูุทุงูุจุฉ";
        const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
        const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ููู ุฃูุฑ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุฃุฏุงุก ุงุจูุชู.`;
        openWhatsApp(TEACHER_WHATSAPP, msg);
    };
}

// ๐ฒ ูุธููุฉ ุฒุฑ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ุงููุณุชุฎุฏูุฉ ูู onclick ูู HTML)
function contactTeacherWhatsApp() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจุฉ";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู";
    const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ุงูุทุงูุจุฉ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุงููุงุฏุฉ.`;
    openWhatsApp(TEACHER_WHATSAPP, msg);
}
/*
// ๐ฒ ูุธููุฉ ุฒุฑ ุงูุชูุงุตู ูุน ุงููุนููุฉ
function contactTeacherWhatsApp() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจุฉ";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู";
    const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ููู ุฃูุฑ/ุงูุทุงูุจุฉ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุงููุงุฏุฉ.`;
    openWhatsApp(TEACHER_WHATSAPP, msg);
}*/
/*
// ๐ ุฑูู ูุงุชุณุงุจ ุงููุนููุฉ
const TEACHER_WHATSAPP = "966555320501"; 

// ===================================================================
// ๐ฒ ูุธููุฉ ุฒุฑ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ุงููุนุฏูุฉ ูุงููุฎุตุตุฉ)
// ===================================================================

/**
 * ูุธููุฉ ุงูุชูุงุตู ูุน ุงููุนููุฉ ุนุจุฑ ูุงุชุณุงุจ ูุน ุชุญุฏูุฏ ูุฑุณู ุงูุฑุณุงูุฉ.
 * @param {string} callerType - ููุน ุงููุฑุณู: 'parent' ุฃู 'student'
 */
 /*
function contactTeacherWhatsApp(callerType) {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    
    let senderRole;
    let greetingPrefix;

    if (callerType === 'parent') {
        senderRole = `ููู ุฃูุฑ ุงูุทุงูุจุฉ`;
        greetingPrefix = `ุฃูุง ${senderRole}`;
    } else if (callerType === 'student') {
        senderRole = `ุงูุทุงูุจุฉ`;
        greetingPrefix = `ุฃูุง ${senderRole}`;
    } else {
        senderRole = `ูุณุชุฎุฏู`;
        greetingPrefix = `ุฑุณุงูุฉ ูู ${senderRole} ุจุฎุตูุต ุงูุทุงูุจุฉ`;
    }

    // ุจูุงุก ุฑุณุงูุฉ ูุฎุตุตุฉ
    const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
${greetingPrefix} ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุงููุงุฏุฉ.`;
    
    // ุงูุฅุฑุณุงู
    openWhatsApp(TEACHER_WHATSAPP, msg);
}
*/
// ===================================================================
// 2. ุชุนุฑูู ุฃุณุฆูุฉ ุงูุงุณุชุจูุงู ูููุง ุงูููุญุชูู
// ===================================================================*/
/*
// ุฃุณุฆูุฉ ููู ุงูุฃูุฑ (ุจุงุณุชุฎุฏุงู IDs ูู ุงูุงุณุชุจูุงู ุงููุฑูู)
const parentQuestions = [
    { id: "parentTrait", text: "1. ุตูุฉ ุชุชุญูู ุจูุง ุงูุทุงูุจุฉ" },
    { id: "parentSkill", text: "2. ููุงุฑุฉ ุชููุฑุฏ ูุชุชููุฒ ุจูุง" },
    { id: "parentLearningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "parentHasAdditionalMethod", text: "4. ูู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชุฑุบุจูู ูู ุฅุถุงูุชูุงุ" },
    { id: "parentAdditionalMethod", text: "5. ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุชูุงุตูู)" },
    { id: "parentInformParent", text: "6. ูู ุชููู ุงุจูุชูู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑูู ุจุชุญุตูููุง ุงูุฏุฑุงุณูุ" },
    { id: "parentSatisfactionLevel", text: "7. ูุฏู ุฑุถุงูู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐู" }
];

// ุฃุณุฆูุฉ ุงูุทุงูุจุฉ (ุจุงุณุชุฎุฏุงู IDs ูู ุงูุงุณุชุจูุงู ุงููุฑูู)
const studentQuestions = [
    { id: "studentTrait", text: "1. ุตูุฉ ุฃุชุญูู ุจูุง" },
    { id: "studentSkill", text: "2. ููุงุฑุฉ ุฃุชููุฒ ุจูุง" },
    { id: "learningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "hasAdditionalMethod", text: "4. ูู ุชุฑุบุจูู ูู ุทุฑููุฉ ุฅุถุงููุฉ ูููุณุงุนุฏุฉุ" },
    { id: "additionalMethod", text: "5. ุงูุชุจู ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุงูุชูุงุตูู)" },
    { id: "informParent", text: "6. ูู ุชููููู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑ ููู ุฃูุฑู ุจุชุญุตูููุ" },
    { id: "satisfactionLevel", text: "7. ูุง ูุฏู ุฑุถุงู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐูุ" }
];*/
// ===================================================================
// 4. ุฑุจุท ุงูุฃุญุฏุงุซ ุจุฃุฒุฑุงุฑ ุงูุฅุฑุณุงู ูุงูุชูุงุตู (ููุชุฃูุฏ ูู ุนูู ุฒุฑ ููู ุงูุฃูุฑ)
// ===================================================================
/*
// ๐ ุฒุฑ ุงูุชูุงุตู ุงูุนุงู ูุน ุงููุนููุฉ (ูู ููุญุฉ ููู ุงูุฃูุฑ - ID: contactTeacher)
if ($("#contactTeacher")) {
    $("#contactTeacher").onclick = () => {
        // ูุชู ุชูุฑูุฑ ููุน ุงููุฑุณู "parent"
        contactTeacherWhatsApp('parent'); 
    };
}

// ๐ ุฒุฑ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ูู ููุญุฉ ุงูุทุงูุจุฉ - ID: contactStudentTeacher)
if ($("#contactStudentTeacher")) {
    $("#contactStudentTeacher").onclick = () => {
        // ูุชู ุชูุฑูุฑ ููุน ุงููุฑุณู "student"
        contactTeacherWhatsApp('student'); 
    };
}

// ููุงุญุธุฉ: ุฅุฐุง ูุงู ุฒุฑ ุงูุชูุงุตู ูู ููุญุฉ ุงูุทุงูุจุฉ ูุณุชุฎุฏู 'onclick="contactTeacherWhatsApp()"' 
// ูู HTML ูุจุงุดุฑุฉุ ูุฌุจ ุชุญุฏูุซู ููุตุจุญ: 'onclick="contactTeacherWhatsApp(\'student\')"'*/


/* =======================================================
   SCRIPT: ููุฏ ููุญุฉ ููู ุงูุฃูุฑ (ูููุตู)
   ======================================================= */
/*
// 1. ุงูุชุนุฑููุงุช ุงูุฃุณุงุณูุฉ
const $ = s => document.querySelector(s);
const TEACHER_WHATSAPP = "966555320501"; 

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช/ุชูุจูู
function showToast(message) {
    console.warn(`[ุชูุจูู]: ${message}`); 
    alert(message);
}

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ
function openWhatsApp(p, text) {
    const encoded = encodeURIComponent(text || "");
    const waUrl = `https://wa.me/${p}?text=${encoded}`;
    window.open(waUrl, "_blank", "noopener,noreferrer");
}

// 2. ุชุนุฑูู ุฃุณุฆูุฉ ููู ุงูุฃูุฑ
const parentQuestions = [
    { id: "parentTrait", text: "1. ุตูุฉ ุชุชุญูู ุจูุง ุงูุทุงูุจุฉ" },
    { id: "parentSkill", text: "2. ููุงุฑุฉ ุชููุฑุฏ ูุชุชููุฒ ุจูุง" },
    { id: "parentLearningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "parentHasAdditionalMethod", text: "4. ูู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชุฑุบุจูู ูู ุฅุถุงูุชูุงุ" },
    { id: "parentAdditionalMethod", text: "5. ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุชูุงุตูู)" },
    { id: "parentInformParent", text: "6. ูู ุชููู ุงุจูุชูู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑูู ุจุชุญุตูููุง ุงูุฏุฑุงุณูุ" },
    { id: "parentSatisfactionLevel", text: "7. ูุฏู ุฑุถุงูู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐู" }
];

// 3. ูุธููุฉ ุฅุฑุณุงู ุงูุงุณุชุจูุงู (ูุฎุตุตุฉ ูููู ุงูุฃูุฑ)
function collectAndSendParentSurvey() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const surveyTitle = 'ุงุณุชุจูุงู ููู ุฃูุฑ';

    let surveyAnswers = [];
    let allAnswered = true;
    
    for (const q of parentQuestions) {
        const element = $(`#${q.id}`);
        let answerValue = "";
        
        if (element) {
            answerValue = element.value.trim();
        }

        // ููุทู ุงูุชุญูู ุงูุดุฑุทู (ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ)
        if (q.id === 'parentAdditionalMethod') {
            const isRequired = $('#parentHasAdditionalMethod')?.value === 'ูุนู';
            
            if (isRequired && !answerValue) { allAnswered = false; break; }
            if (!answerValue) continue; 
        } 
        else if (!answerValue) {
            allAnswered = false;
            break; 
        }

        surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
    }
    
    if (!allAnswered) {
        showToast("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุญููู ุงูุงุณุชุจูุงู ุงููุทููุจุฉ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

    // ุจูุงุก ุงูุฑุณุงูุฉ ุงูููุงุฆูุฉ
    const messageHeader = `*๐ ${surveyTitle}*`;
    const info = `ุงูุทุงูุจ/ุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
    const answersText = surveyAnswers.join('\n\n');
    
    const fullMessage = messageHeader + "\n\n" + info + "*--- ุงูุฅุฌุงุจุงุช ---*\n" + answersText;

    openWhatsApp(TEACHER_WHATSAPP, fullMessage);
    showToast(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ${surveyTitle}. ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.`);
}

// 4. ูุธููุฉ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ูุฎุตุตุฉ ูููู ุงูุฃูุฑ)
function contactTeacherWhatsAppParent() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    
    const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ููู ุฃูุฑ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุฃุฏุงุก ุงุจูุชู.`;

    openWhatsApp(TEACHER_WHATSAPP, msg);
}

// 5. ููุทู ุงูุชุญูู ุงูุดุฑุทู (ูุฅุธูุงุฑ/ุฅุฎูุงุก ุญูู 'parentAdditionalMethod')
if ($('#parentHasAdditionalMethod')) {
    const additionalMethodSelect = $('#parentHasAdditionalMethod');
    const additionalMethodContainer = $('#parentAdditionalMethodContainer');

    const toggleAdditionalMethod = () => {
        additionalMethodContainer.style.display = (additionalMethodSelect.value === 'ูุนู') ? 'block' : 'none';
        if (additionalMethodSelect.value !== 'ูุนู') $('#parentAdditionalMethod').value = ''; 
    };
    additionalMethodSelect.addEventListener('change', toggleAdditionalMethod);
    document.addEventListener('DOMContentLoaded', toggleAdditionalMethod);
}

// 6. ุฑุจุท ุงูุฃุญุฏุงุซ ุจุงูุฃุฒุฑุงุฑ
if ($("#submitParentFeedback")) {
    $("#submitParentFeedback").onclick = collectAndSendParentSurvey;
}
if ($("#contactTeacher")) {
    $("#contactTeacher").onclick = contactTeacherWhatsAppParent;
}
*/
/* =======================================================
   SCRIPT: ููุฏ ููุญุฉ ุงูุทุงูุจุฉ (ูููุตู)
   ======================================================= */
/*
// 1. ุงูุชุนุฑููุงุช ุงูุฃุณุงุณูุฉ
const $ = s => document.querySelector(s);
const TEACHER_WHATSAPP = "966555320501"; 

// ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ ุชูุณุช/ุชูุจูู
function showToast(message) {
    console.warn(`[ุชูุจูู]: ${message}`); 
    alert(message);
}

// ุฏุงูุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ
function openWhatsApp(p, text) {
    const encoded = encodeURIComponent(text || "");
    const waUrl = `https://wa.me/${p}?text=${encoded}`;
    window.open(waUrl, "_blank", "noopener,noreferrer");
}

// 2. ุชุนุฑูู ุฃุณุฆูุฉ ุงูุทุงูุจุฉ
const studentQuestions = [
    { id: "studentTrait", text: "1. ุตูุฉ ุฃุชุญูู ุจูุง" },
    { id: "studentSkill", text: "2. ููุงุฑุฉ ุฃุชููุฒ ุจูุง" },
    { id: "learningStrategy", text: "3. ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชุนููููุฉ ุงูููุถูุฉ" },
    { id: "hasAdditionalMethod", text: "4. ูู ุชุฑุบุจูู ูู ุทุฑููุฉ ุฅุถุงููุฉ ูููุณุงุนุฏุฉุ" },
    { id: "additionalMethod", text: "5. ุงูุชุจู ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ ุงูุชู ุชุฑุบุจูู ูููุง (ุงูุชูุงุตูู)" },
    { id: "informParent", text: "6. ูู ุชููููู ุฏุงุฆูุงู ุจุฅุฎุจุงุฑ ููู ุฃูุฑู ุจุชุญุตูููุ" },
    { id: "satisfactionLevel", text: "7. ูุง ูุฏู ุฑุถุงู ุนู ุขููุฉ ุงููุชุงุจุนุฉ ูุฐูุ" }
];

// 3. ูุธููุฉ ุฅุฑุณุงู ุงูุงุณุชุจูุงู (ูุฎุตุตุฉ ููุทุงูุจุฉ)
function collectAndSendStudentSurvey() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const surveyTitle = 'ุงุณุชุจูุงู ุชูููู ุฐุงุชู ููุทุงูุจุฉ';

    let surveyAnswers = [];
    let allAnswered = true;

    for (const q of studentQuestions) {
        const element = $(`#${q.id}`);
        let answerValue = "";
        
        if (element) {
            answerValue = element.value.trim();
        }

        // ููุทู ุงูุชุญูู ุงูุดุฑุทู (ุงูุทุฑููุฉ ุงูุฅุถุงููุฉ)
        if (q.id === 'additionalMethod') {
            const isRequired = $('#hasAdditionalMethod')?.value === 'ูุนู';
            
            if (isRequired && !answerValue) { allAnswered = false; break; }
            if (!answerValue) continue; 
        } 
        else if (!answerValue) {
            allAnswered = false;
            break; 
        }

        surveyAnswers.push(`*${q.text}:*\n   - ${answerValue}`);
    }
    
    if (!allAnswered) {
        showToast("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ุฌููุน ุญููู ุงูุงุณุชุจูุงู ุงููุทููุจุฉ ูุจู ุงูุฅุฑุณุงู.");
        return;
    }

    // ุจูุงุก ุงูุฑุณุงูุฉ ุงูููุงุฆูุฉ
    const messageHeader = `*๐ ${surveyTitle}*`;
    const info = `ุงูุทุงูุจุฉ: ${studentName}\nุงููุตู: ${studentClass}\n\n`;
    const answersText = surveyAnswers.join('\n\n');
    
    const fullMessage = messageHeader + "\n\n" + info + "*--- ุงูุฅุฌุงุจุงุช ---*\n" + answersText;

    openWhatsApp(TEACHER_WHATSAPP, fullMessage);
    showToast(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ${surveyTitle}. ุณูุชู ูุชุญ ุชุทุจูู ูุงุชุณุงุจ ุงูุขู ููุฅุฑุณุงู.`);
}

// 4. ูุธููุฉ ุงูุชูุงุตู ูุน ุงููุนููุฉ (ูุฎุตุตุฉ ููุทุงูุจุฉ)
function contactTeacherWhatsAppStudent() {
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุบูุฑ ูุนุฑูู";
    
    // ุงูุฑุณุงูุฉ ูุฎุตุตุฉ ููุทุงูุจุฉ
    const msg = `ูุฑุญุจุงู ูุนููุฉ ุดุฐุงุ
ุฃูุง ุงูุทุงูุจุฉ ${studentName} ูู ูุตู ${studentClass}. ุฃูุฏ ุงูุชูุงุตู ูุนูู ุจุฎุตูุต ุงููุงุฏุฉ.`;
    
    openWhatsApp(TEACHER_WHATSAPP, msg);
}

// 5. ููุทู ุงูุชุญูู ุงูุดุฑุทู (ูุฅุธูุงุฑ/ุฅุฎูุงุก ุญูู 'additionalMethod')
if ($('#hasAdditionalMethod')) {
    const additionalMethodSelect = $('#hasAdditionalMethod');
    const additionalMethodContainer = $('#additionalMethodContainer');

    const toggleAdditionalMethod = () => {
        additionalMethodContainer.style.display = (additionalMethodSelect.value === 'ูุนู') ? 'block' : 'none';
        if (additionalMethodSelect.value !== 'ูุนู') $('#additionalMethod').value = ''; 
    };
    additionalMethodSelect.addEventListener('change', toggleAdditionalMethod);
    document.addEventListener('DOMContentLoaded', toggleAdditionalMethod);
}

// 6. ุฑุจุท ุงูุฃุญุฏุงุซ ุจุงูุฃุฒุฑุงุฑ
if ($("#submitStudentFeedback")) {
    $("#submitStudentFeedback").onclick = collectAndSendStudentSurvey;
}

// ููุงุญุธุฉ: ุฒุฑ ุงูุชูุงุตู ูู ููุญุฉ ุงูุทุงูุจุฉ ูุนุชูุฏ ุนูู onclick="contactTeacherWhatsAppStudent()" ูู HTML*/


/* =======================================================
   SCRIPT: ูุธููุฉ ุงูุชูุงุตู ุงูููุชูุญ ูุน ุฃูููุงุก ุงูุฃููุฑ ูู ููุญุฉ ุงููุนููุฉ
   ======================================================= */

/**
 * ุฏุงูุฉ ูุชุฌููุน ุจูุงูุงุช ุงูุทุงูุจ ูุจูุงุก ุฑุณุงูุฉ ููุฌูุฉ ูููู ุงูุฃูุฑ ูู ุงููุนููุฉ.
 * ูุชู ูุชุญ ูุงุชุณุงุจ ุฏูู ุชุญุฏูุฏ ุฑูู ูุชูููู ุงููุนููุฉ ูู ุงุฎุชูุงุฑ ููู ุงูุฃูุฑ ูุฏููุงู.
 */
/*

function contactParentsFromTeacherBoardGeneral() {
    // ุงูุชุฑุงุถ ูุตูู ููุญุฉ ุงููุนููุฉ ูุจูุงูุงุช ุงูุทุงูุจ ุนุจุฑ #pName ู #pClass
    const $ = s => document.querySelector(s);
    
    // ูุชู ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงูุทุงูุจ ุงูุญุงูู
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจ/ุฉ";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู";

    // ุจูุงุก ุงูุฑุณุงูุฉ ุงูููุฌูุฉ ูู ุงููุนููุฉ ูููู ุงูุฃูุฑ
    const msg = `ูุฑุญุจุงู ููู ุฃูุฑ ุงูุทุงูุจ/ุฉ ${studentName} ูู ูุตู ${studentClass}.

ุฃูุง ุงููุนููุฉุ ูุฃูุฏ ุงูุชูุงุตู ูุนูู ููุชุงุจุนุฉ ุงูุฃููุฑ ุงูุฃูุงุฏูููุฉ ูุงูุณููููุฉ ุงูุฎุงุตุฉ ุจู ${studentName}.
ูุฑุฌู ุงูุฑุฏ ุนูู ูุฐู ุงูุฑุณุงูุฉ ูู ุฃูุฑุจ ููุช.

ุดูุฑุงู ููู.
ุงููุนููุฉ ุดุฐุง`; // ูููู ุชุฎุตูุต ุงุณู ุงููุนููุฉ ููุง

    // ุจูุงุก ุฑุงุจุท ูุงุชุณุงุจ ุงูุนุงู (ุจุฏูู ุฑูู ูุณุชูู)
    // ูุฐุง ูุณูุญ ูููุนููุฉ ุจุงุฎุชูุงุฑ ุฌูุฉ ุงูุงุชุตุงู ูุฏููุงู.
    const whatsappLink = `https://wa.me/?text=${encodeURIComponent(msg)}`;
    
    // ูุชุญ ุงูุฑุงุจุท
    window.open(whatsappLink, "_blank", "noopener,noreferrer");

    // ุชูุจูู ุงููุนููุฉ ูุทุฑููุฉ ุงูุฅุฑุณุงู
    alert(`โ ุชู ุชุฌููุฒ ุงูุฑุณุงูุฉ. ุณูุชู ูุชุญ ูุงูุฐุฉ ูุงุชุณุงุจ ุงูุขูุ ูุฑุฌู ุงุฎุชูุงุฑ ุฌูุฉ ุงุชุตุงู ููู ุงูุฃูุฑ ูุฅุฑุณุงู ุงูุฑุณุงูุฉ.`);
}

// ุฑุจุท ุงูุญุฏุซ ุจุงูุฒุฑ (ุฅุฐุง ูู ููู ูุฑุชุจุทุงู ุจู onclick ูู HTML)
if ($("#contactParentFromTeacher")) {
    $("#contactParentFromTeacher").onclick = contactParentsFromTeacherBoardGeneral;
}*/

/* =======================================================
   SCRIPT: ูุธููุฉ ุงูุชูุงุตู ูุชุนุฏุฏุฉ ุงูุฎูุงุฑุงุช (ููุญุฉ ุงููุนููุฉ)
   ======================================================= 

// ุชุนุฑูู ุซุงุจุช ูุงุณู ุงููุนููุฉ ูู ุงูุฑุณุงุฆู
const TEACHER_NAME = "ุงููุนููุฉ"; 

/**
 * ุฏุงูุฉ ุฑุฆูุณูุฉ ููุชุญ ูุงุฆูุฉ ุงูุฎูุงุฑุงุช ูููุนููุฉ
 *//*
function openTeacherCommunicationMenu() {
    const options = [
        "1: ุชููุฆุฉ", 
        "2: ุชูุจูู ุณูููู", 
        "3: ุชูุจูู ุฃูุงุฏููู", 
        "4: ุดูุฑ ูุชูุฏูุฑ", 
        "5: ูุชุงุจุนุฉ", 
        "6: ุงุณุชูุณุงุฑ", 
        "7: ุฏุนูุฉ ุงุฌุชูุงุน"
    ];
    
    const menuPrompt = `ุงุฎุชุฑ ููุน ุงูุฑุณุงูุฉ:\n${options.join('\n')}\n\n(ุงูุชุจ ุงูุฑูู ุฃู ุฌุฒุก ูู ุงุณู ุงูุฎูุงุฑ)`;
    
    // ุงุณุชุฎุฏุงู prompt ูุนุฑุถ ูุงุฆูุฉ ุงูุฎูุงุฑุงุช
    const selected = prompt(menuPrompt);
    
    if (selected === null || selected.trim() === "") {
        // ุฅูุบุงุก ุงูุนูููุฉ
        return;
    }
    
    // ุชุญุฏูุฏ ููุน ุงูุฎูุงุฑ ุจูุงุกู ุนูู ุงููุฏุฎู (ุฑูู ุฃู ูุต)
    let choice;
    if (selected.trim() === '1' || selected.toLowerCase().includes('ุชููุฆุฉ')) {
        choice = 'ุชููุฆุฉ';
    } else if (selected.trim() === '2' || selected.toLowerCase().includes('ุณูููู')) {
        choice = 'ุชูุจูู ุณูููู';
    } else if (selected.trim() === '3' || selected.toLowerCase().includes('ุฃูุงุฏููู')) {
        choice = 'ุชูุจูู ุฃูุงุฏููู';
    } else if (selected.trim() === '4' || selected.toLowerCase().includes('ุดูุฑ')) {
        choice = 'ุดูุฑ ูุชูุฏูุฑ';
    } else if (selected.trim() === '5' || selected.toLowerCase().includes('ูุชุงุจุนุฉ')) {
        choice = 'ูุชุงุจุนุฉ';
    } else if (selected.trim() === '6' || selected.toLowerCase().includes('ุงุณุชูุณุงุฑ')) {
        choice = 'ุงุณุชูุณุงุฑ';
    } else if (selected.trim() === '7' || selected.toLowerCase().includes('ุงุฌุชูุงุน') || selected.toLowerCase().includes('ุฏุนูุฉ')) {
        choice = 'ุฏุนูุฉ ุงุฌุชูุงุน';
    } else {
        alert("โ๏ธ ุงุฎุชูุงุฑ ุบูุฑ ุตุญูุญ ุฃู ุบูุฑ ูุงุถุญ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.");
        return;
    }
    
    // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงููููุฏุฉ ููุฑุณุงูุฉ
    generateWhatsAppMessage(choice);
}

*/
/**
 * ุฏุงูุฉ ูุจูุงุก ุงูุฑุณุงูุฉ ููุชุญ ูุงุชุณุงุจ ุจูุงุกู ุนูู ููุน ุงูุฎูุงุฑ
 * @param {string} type - ููุน ุงูุฑุณุงูุฉ ุงููุทููุจุฉ
 *//*
function generateWhatsAppMessage(type) {
    const $ = s => document.querySelector(s);
    // ุจูุงูุงุช ุงูุทุงูุจ (ูุชู ุงูุชุฑุงุถ ูุฌูุฏูุง ูู ููุญุฉ ุงููุนููุฉ)
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจ/ุฉ";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู";
    
    let messageBody;
    const greeting = "ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู";
    const closing = `\n\nูุน ุฎุงูุต ุงูุชุญูุงุช\n${TEACHER_NAME}`;
    const closingGeneral = `\n\nูุน ุงูุชุญูุฉ\n${TEACHER_NAME}`;
    
    // *ููุงุญุธุฉ: ูุชูููู ุงูุชูุงุตู ุฏูู ุฑูู ูุญุฏุฏุ ูุชู ุงุณุชุฎุฏุงู ุฑุงุจุท ูุงุชุณุงุจ ุนุงู (ุจุฏูู ุฑูู)
    const whatsappBaseUrl = "https://wa.me/?text=";
    
    switch (type) {
        case 'ุชููุฆุฉ':
            const testName = prompt(`ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุงูุงุฎุชุจุงุฑ/ุงููููุฉ:`) || "[ุงุณู ุงูุงุฎุชุจุงุฑ/ุงููููุฉ]";
            const degree = prompt(`ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงูุฏุฑุฌุฉ ุงูุชู ุญุตู ุนูููุง/ุช ุนูููุง:`) || "[ุงูุฏุฑุฌุฉ]";
            messageBody = `${greeting}\n\nูุณุนุฏูู ุฃู ุฃููุฆูู ุจุชููู ุงุจููู/ุงุจูุชูู ${studentName} ูู ${testName}. ููุฏ ุฃุธูุฑ/ุช ูุณุชูู ูุชููุฒุงู ูุญุตู/ุช ุนูู ุฏุฑุฌุฉ ${degree}.\n\nููุฎุฑ ุจูุฐุง ุงูุฅูุฌุงุฒ ููุชููู ูู/ูุง ุฏูุงู ุงูุชูููู.`;
            messageBody += closing;
            break;

        case 'ุชูุจูู ุณูููู':
            const behaviorDesc = prompt(`ุงูุฑุฌุงุก ูุตู ุงููููู/ุงูุณููู ุงูุณูููู ุงูุฐู ูุชุทูุจ ุงูุชูุจูู:`) || "[ูุตู ุงููููู/ุงูุณููู]";
            messageBody = `${greeting}\nุฃูุฏ ููุช ุงูุชุจุงููู ุฅูู ูููู ูุฎุต ${studentName}:\n**${behaviorDesc}**.\n\nูุฑุฌู ุงูุชูุงุตู ูุนูุง ูููุงูุดุฉ ุงูุฃูุฑ ููุถุน ุฎุทุฉ ููุงุณุจุฉ.\nููุฏุฑ ุชุนุงูููู ุงููุณุชูุฑ.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุชูุจูู ุฃูุงุฏููู':
            const academicDesc = prompt(`ุงูุฑุฌุงุก ูุตู ุงููููู/ุงููุดููุฉ ุงูุฃูุงุฏูููุฉ (ูุซู: ุงูุฎูุงุถ ูู ูุงุฏุฉ ุงูุฑูุงุถูุงุชุ ุนุฏู ุฅุญุถุงุฑ ุงููุงุฌุจุงุช):`) || "[ูุตู ุงููููู/ุงููุดููุฉ ุงูุฃูุงุฏูููุฉ]";
            messageBody = `${greeting}\nุฃูุฏ ููุช ุงูุชุจุงููู ุฅูู ุงูุฃุฏุงุก ุงูุฃูุงุฏููู ูู ${studentName}:\n**${academicDesc}**.\n\nูุฑุฌู ุงูุชูุงุตู ูุนูุง ูููุงูุดุฉ ุงูุฃูุฑ ููุถุน ุฎุทุฉ ููุงุณุจุฉ.\nููุฏุฑ ุชุนุงูููู ุงููุณุชูุฑ.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุดูุฑ ูุชูุฏูุฑ':
            messageBody = `${greeting}\nุฃุชูุฏู ุจุฎุงูุต ุงูุดูุฑ ูุงูุชูุฏูุฑ ูุชุนุงูููู ุงููุณุชูุฑ ููุชุงุจุนุชูู ุงูุฏูููุฉ ูุงุจููู/ุงุจูุชูู ${studentName}. ูุฐุง ุงูุงูุชูุงู ูู ุฃุซุฑ ุฅูุฌุงุจู ูุงุถุญ ุนูู ุฃุฏุงุฆู/ูุง.\n\nุจุงุฑู ุงููู ูููู ููู ุฌููุฏูู.`;
            messageBody += closing;
            break;
            
        case 'ูุชุงุจุนุฉ':
            const subject = prompt(`ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุงููุงุฏุฉ ุงูุชู ูุชู ูุชุงุจุนุชูุง:`) || "[ุงุณู ุงููุงุฏุฉ]";
            const progress = prompt(`ุงูุฑุฌุงุก ูุตู ุงูุชูุฏู ุงูููุญูุธ (ูุซูุงู: ุฃุตุจุญ ูุฌูุจ ุนูู ุงูุฃุณุฆูุฉ ุงููุตูุฑุฉ):`) || "[ูุตู ุงูุชูุฏู]";
            const neededImprovement = prompt(`ุงูุฑุฌุงุก ูุตู ุงูููุงุท ุงูุชู ุชุญุชุงุฌ ุชุญุณูู (ูุซูุงู: ูุง ุฒุงู ูุญุชุงุฌ ูุณุงุนุฏุฉ ูู ุญู ุงููุณุงุฆู ุงูุทูููุฉ):`) || "[ุงูููุงุท]";
            const nextSteps = prompt(`ุงูุฑุฌุงุก ูุตู ุงูุฎุทูุงุช ุงููุงุฏูุฉ (ูุซูุงู: ุชูุซูู ุงูุชูุงุฑูู ุงูููุฒููุฉ):`) || "[ุงูุฎุทูุงุช]";
            
            messageBody = `${greeting}\nูุชุงุจุนุฉ ููุฎุทุฉ ุงูุนูุงุฌูุฉ ูุงุจููู/ุงุจูุชูู ${studentName} ูู ูุงุฏุฉ ${subject}:\n\n- *ุงูุชูุฏู ุงูููุญูุธ:*\n  ${progress}\n- *ุงูููุงุท ุงูุชู ุชุญุชุงุฌ ุชุญุณูู:*\n  ${neededImprovement}\n- *ุงูุฎุทูุงุช ุงููุงุฏูุฉ:*\n  ${nextSteps}\n\nูุดูุฑ ุชุนุงูููู ููุชุงุจุนุชูู ุงููุณุชูุฑุฉ.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุงุณุชูุณุงุฑ':
            const inquiryTopic = prompt(`ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุถูุน ุงูุงุณุชูุณุงุฑ (ูุซูุงู: ุณุจุจ ุบูุงุจ ุงูุทุงูุจุ ุฃู ูุนูููุฉ ุนู ุดูุงุฏุฉ ูููุงุฏ):`) || "[ููุถูุน ุงูุงุณุชูุณุงุฑ]";
            messageBody = `${greeting}\nุฃูุฏ ุงูุงุณุชูุณุงุฑ ุนู ${inquiryTopic} ุงูุฎุงุต ุจู ${studentName}. ูุฑุฌู ุงูุชูุฑู ุจุชุฒููุฏูุง ุจุงููุนูููุงุช ุงููุงุฒูุฉ.\n\nุดุงูุฑูู ุชุนุงูููู.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุฏุนูุฉ ุงุฌุชูุงุน':
            const meetingDate = prompt(`ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงูุชุงุฑูุฎ ูุงูููุช ุงูููุชุฑุญ ููุงุฌุชูุงุน (ูุซูุงู: ุงูุฃุฑุจุนุงุก 15/1/2026 ุงูุณุงุนุฉ 10:00 ุตุจุงุญุงู):`) || "[ุงูุชุงุฑูุฎ ูุงูููุช]";
            const meetingPlace = prompt(`ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุงู ุงูุงุฌุชูุงุน (ูุซูุงู: ูุงุนุฉ ุงูุงุฌุชูุงุนุงุชุ ุฃู ุนุจุฑ Zoom):`) || "[ุงูููุงู]";
            messageBody = `${greeting}\nูุฏุนููู ูุญุถูุฑ ููุงุก ุฎุงุต ูููุงูุดุฉ ุฃุฏุงุก ุงุจููู/ุงุจูุชูู ${studentName} ุงูุฃูุงุฏููู ูุงูุณูููู.\n\n*ุงูููุนุฏ ุงูููุชุฑุญ:*\n${meetingDate}\n*ุงูููุงู:*\n${meetingPlace}\n\nูุฑุฌู ุชุฃููุฏ ุงูุญุถูุฑ.`;
            messageBody += closingGeneral;
            break;

        default:
            // ูู ุญุงู ูุฌูุฏ ุฎุทุฃ ูู ุชุญุฏูุฏ ุงูุฎูุงุฑ
            alert("โ๏ธ ุญุฏุซ ุฎุทุฃ ุฏุงุฎูู ูู ุชุฌููุฒ ุงูุฑุณุงูุฉ.");
            return;
    }

    // ูุชุญ ูุงุชุณุงุจ ุจุงูุฑุณุงูุฉ ุงูููุณูุฉ (ุฏูู ุฑูู)
    const finalMessage = encodeURIComponent(messageBody);
    window.open(whatsappBaseUrl + finalMessage, "_blank", "noopener,noreferrer");

    alert(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ููุน: ${type}. ุณูุชู ูุชุญ ูุงูุฐุฉ ูุงุชุณุงุจ ุงูุขูุ ูุฑุฌู ุงุฎุชูุงุฑ ุฌูุฉ ุงุชุตุงู ููู ุงูุฃูุฑ ูุฅุฑุณุงู ุงูุฑุณุงูุฉ.`);
}*/
/* =======================================================
   SCRIPT: ูุธููุฉ ุงูุชูุงุตู ุงููุจุงุดุฑ ูุน ุฃูููุงุก ุงูุฃููุฑ (ููุญุฉ ุงููุนููุฉ)
   ======================================================= */

// ุชุนุฑูู ุซุงุจุช ูุงุณู ุงููุนููุฉ ูู ุงูุฑุณุงุฆู
const TEACHER_NAME = "ุงููุนููุฉ"; 

/**
 * ุฏุงูุฉ ูุชุฌููุน ุจูุงูุงุช ุงูุทุงูุจ ูุจูุงุก ุงูุฑุณุงูุฉ ููุชุญ ูุงุชุณุงุจ ูุจุงุดุฑุฉ.
 * @param {string} type - ููุน ุงูุฑุณุงูุฉ ุงููุทููุจุฉ
 */
function generateAndSendDirect(type) {
    const $ = s => document.querySelector(s);
    // ุจูุงูุงุช ุงูุทุงูุจ (ูุชู ุงูุชุฑุงุถ ูุฌูุฏูุง ูู ููุญุฉ ุงููุนููุฉ)
    const studentName = $("#pName") ? $("#pName").textContent.trim() : "ุงูุทุงูุจ/ุฉ";
    const studentClass = $("#pClass") ? $("#pClass").textContent.trim() : "ุงููุตู";
    
    let messageBody;
    const greeting = "ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู";
    const closing = `\n\nูุน ุฎุงูุต ุงูุชุญูุงุช\n${TEACHER_NAME}`;
    const closingGeneral = `\n\nูุน ุงูุชุญูุฉ\n${TEACHER_NAME}`;
    
    // ุฑุงุจุท ูุงุชุณุงุจ ุงูุนุงู (ุจุฏูู ุฑูู) - ูุณูุญ ุจุงุฎุชูุงุฑ ููู ุงูุฃูุฑ ูุฏููุงู
    const whatsappBaseUrl = "https://wa.me/?text=";
    
    // --- ููุงูุจ ุงูุฑุณุงุฆู ุงูุซุงุจุชุฉ ---
    switch (type) {
        case 'ุชููุฆุฉ':
            messageBody = `${greeting}\n\nูุณุนุฏูู ุฃู ุฃููุฆูู ุจุชููู ุงุจููู/ุงุจูุชูู ${studentName} ูู [ุงุณู ุงูุงุฎุชุจุงุฑ/ุงููููุฉ]. ููุฏ ุฃุธูุฑ/ุช ูุณุชูู ูุชููุฒุงู ูุญุตู/ุช ุนูู ุฏุฑุฌุฉ [ุงูุฏุฑุฌุฉ].\n\nููุฎุฑ ุจูุฐุง ุงูุฅูุฌุงุฒ ููุชููู ูู/ูุง ุฏูุงู ุงูุชูููู.`;
            messageBody += closing;
            break;

        case 'ุชูุจูู ุณูููู':
            messageBody = `${greeting}\nุฃูุฏ ููุช ุงูุชุจุงููู ุฅูู [ูุตู ุงููููู/ุงูุณููู] ุงูุฎุงุต ุจุงูุทุงูุจุฉ ${studentName}. ูุฑุฌู ุงูุชูุงุตู ูุนูุง ูููุงูุดุฉ ุงูุฃูุฑ ููุถุน ุฎุทุฉ ููุงุณุจุฉ.\nููุฏุฑ ุชุนุงูููู ุงููุณุชูุฑ.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุชูุจูู ุฃูุงุฏููู':
            // ุชู ูุตู ุงูุฑุณุงูุฉ ุนู ุงูุณูููู ูุน ุงุณุชุฎุฏุงู ูุงูุจ ูุทุงุจู ูุทูุจู
            messageBody = `${greeting}\nุฃูุฏ ููุช ุงูุชุจุงููู ุฅูู [ุงูููุงุญุธุฉ ุงูุฃูุงุฏูููุฉ] ุงูุฎุงุตุฉ ุจุงูุทุงูุจุฉ ${studentName}. ูุฑุฌู ุงูุชูุงุตู ูุนูุง ูููุงูุดุฉ ุงูุฃูุฑ ููุถุน ุฎุทุฉ ููุงุณุจุฉ.\nููุฏุฑ ุชุนุงูููู ุงููุณุชูุฑ.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุดูุฑ ูุชูุฏูุฑ':
            messageBody = `${greeting}\nุฃุชูุฏู ุจุฎุงูุต ุงูุดูุฑ ูุงูุชูุฏูุฑ ูุชุนุงูููู ุงููุณุชูุฑ ููุชุงุจุนุชูู ุงูุฏูููุฉ ูุงุจููู/ุงุจูุชูู ${studentName}. ูุฐุง ุงูุงูุชูุงู ูู ุฃุซุฑ ุฅูุฌุงุจู ูุงุถุญ ุนูู ุฃุฏุงุฆู/ูุง.\n\nุจุงุฑู ุงููู ูููู ููู ุฌููุฏูู.`;
            messageBody += closing;
            break;
            
        case 'ูุชุงุจุนุฉ':
            messageBody = `${greeting}\nูุชุงุจุนุฉ ููุฎุทุฉ ุงูุนูุงุฌูุฉ ูุงุจููู/ุงุจูุชูู ${studentName} ูู ูุงุฏุฉ [ุงุณู ุงููุงุฏุฉ]:\n\n- *ุงูุชูุฏู ุงูููุญูุธ:*\n  [ูุตู ุงูุชูุฏู]\n- *ุงูููุงุท ุงูุชู ุชุญุชุงุฌ ุชุญุณูู:*\n  [ุงูููุงุท]\n- *ุงูุฎุทูุงุช ุงููุงุฏูุฉ:*\n  [ุงูุฎุทูุงุช]\n\nูุดูุฑ ุชุนุงูููู ููุชุงุจุนุชูู ุงููุณุชูุฑุฉ.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุงุณุชูุณุงุฑ':
            messageBody = `${greeting}\nุฃูุฏ ุงูุงุณุชูุณุงุฑ ุนู [ููุถูุน ุงูุงุณุชูุณุงุฑ] ุงูุฎุงุต ุจุงูุทุงูุจุฉ ${studentName}. ูุฑุฌู ุงูุชูุฑู ุจุชุฒููุฏูุง ุจุงููุนูููุงุช ุงููุงุฒูุฉ.\n\nุดุงูุฑูู ุชุนุงูููู.`;
            messageBody += closingGeneral;
            break;
            
        case 'ุฏุนูุฉ ุงุฌุชูุงุน':
            messageBody = `${greeting}\nูุฏุนููู ูุญุถูุฑ ููุงุก ุฎุงุต ูููุงูุดุฉ ุฃุฏุงุก ุงุจููู/ุงุจูุชูู ${studentName} ุงูุฃูุงุฏููู ูุงูุณูููู.\n\n*ุงูููุนุฏ ุงูููุชุฑุญ:*\n[ุงูุชุงุฑูุฎ ูุงูููุช]\n*ุงูููุงู:*\n[ุงูููุงู]\n\nูุฑุฌู ุชุฃููุฏ ุงูุญุถูุฑ.`;
            messageBody += closingGeneral;
            break;

        default:
            alert("โ๏ธ ุญุฏุซ ุฎุทุฃ: ูู ูุชู ุชุญุฏูุฏ ููุน ุงูุฑุณุงูุฉ ุจุดูู ุตุญูุญ.");
            return;
    }

    // ูุชุญ ูุงุชุณุงุจ ุจุงูุฑุณุงูุฉ ุงูููุณูุฉ (ุฏูู ุฑูู)
    const finalMessage = encodeURIComponent(messageBody);
    window.open(whatsappBaseUrl + finalMessage, "_blank", "noopener,noreferrer");

    // ุฅุธูุงุฑ ุชูุจูู ุจุณูุท ูููุณุชุฎุฏู ุจุนุฏ ุฅุฑุณุงู ุงูุฃูุฑ
    alert(`โ ุชู ุชุฌููุฒ ุฑุณุงูุฉ ููุน: ${type}. ุณูุชู ูุชุญ ูุงูุฐุฉ ูุงุชุณุงุจ ุงูุขูุ ูุฑุฌู ุงุฎุชูุงุฑ ุฌูุฉ ุงุชุตุงู ููู ุงูุฃูุฑ ูุฅุฑุณุงู ุงูุฑุณุงูุฉ.`);
}
</script>
  
 </body>
</html>